<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Zend_Service_LiveDocx</title>
<link rel="stylesheet" type="text/css" href="dbstyle.css">
<meta name="generator" content="DocBook XSL Stylesheets V1.79.2">
<link rel="home" href="index.html" title="Programmer's Guía de Referencia">
<link rel="up" href="zend.service.html" title="Zend_Service">
<link rel="prev" href="zend.service.flickr.html" title="Zend_Service_Flickr">
<link rel="next" href="zend.service.rackspace.html" title="Zend_Service_Rackspace">
</head>
<body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF">
<div class="navheader"><table width="100%" summary="Navigation header">
<tr><th colspan="3" align="center">Zend_Service_LiveDocx</th></tr>
<tr>
<td width="20%" align="left">
<a accesskey="p" href="zend.service.flickr.html">Anterior</a> </td>
<th width="60%" align="center">Zend_Service</th>
<td width="20%" align="right"> <a accesskey="n" href="zend.service.rackspace.html">Siguiente</a>
</td>
</tr>
</table></div>
<div class="sect1">
<div class="titlepage"><div><div><h2 class="title" style="clear: both">
<a name="zend.service.livedocx"></a>Zend_Service_LiveDocx</h2></div></div></div>
    

    <div class="sect2">
<div class="titlepage"><div><div><h3 class="title">
<a name="zend.service.livedocx.introduction"></a>Introduction to LiveDocx</h3></div></div></div>
        

        <p>
            LiveDocx is a <acronym class="acronym">SOAP</acronym> service that allows developers to generate word
            processing documents by combining structured data from <acronym class="acronym">PHP</acronym> with a
            template, created in a word processor. The resulting document can be saved as a
            <acronym class="acronym">PDF</acronym>, <acronym class="acronym">DOCX</acronym>, <acronym class="acronym">DOC</acronym>,
            <acronym class="acronym">HTML</acronym> or <acronym class="acronym">RTF</acronym> file. LiveDocx implements <a class="ulink" href="http://en.wikipedia.org/wiki/Mail_merge" target="_top">mail-merge</a> in
            <acronym class="acronym">PHP</acronym>.
        </p>

        <p>
            The family of <code class="classname">Zend_Service_LiveDocx</code> components provides a clean
            and simple interface to the <a class="ulink" href="http://www.livedocx.com" target="_top">LiveDocx API</a>
            and additionally offers functionality to improve network performance.
        </p>

        <p>
            In addition to this section of the manual, if you are interested in learning more about
            <code class="classname">Zend_Service_LiveDocx</code> and the backend <acronym class="acronym">SOAP</acronym>
            service LiveDocx, please take a look at the following resources:
        </p>

        <div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; ">
<li class="listitem">
                <p>
                    <span class="emphasis"><em>Shipped demonstration applications</em></span>. There are a large
                    number of demonstration applications in the directory
                    <span class="emphasis"><em>/demos/Zend/Service/LiveDocx</em></span> of the Zend Framework
                    distribution file or trunk version, checked out of the standard SVN repository.
                    These are designed to get you up to speed with
                    <code class="classname">Zend_Service_LiveDocx</code> within a matter of minutes.
                </p>
            </li>
<li class="listitem">
                <p>
                    <a class="ulink" href="http://www.phplivedocx.org/" target="_top">
                    <code class="classname">Zend_Service_LiveDocx</code> blog and web site</a>.
                </p>
            </li>
<li class="listitem">
                <p>
                    <a class="ulink" href="http://www.livedocx.com/pub/documentation/api.aspx" target="_top">
                    LiveDocx SOAP API documentation</a>.
                </p>
            </li>
<li class="listitem">
                <p>
                    <a class="ulink" href="https://api.livedocx.com/1.2/mailmerge.asmx?wsdl" target="_top">
                    LiveDocx WSDL</a>.
                </p>
            </li>
<li class="listitem">
                <p>
                    <a class="ulink" href="https://www.livedocx.com/" target="_top">LiveDocx blog and web site</a>.
                </p>
            </li>
</ul></div>

        <div class="sect3">
<div class="titlepage"><div><div><h4 class="title">
<a name="zend.service.livedocx.account"></a>Sign Up for an Account</h4></div></div></div>
            

            <p>
                Before you can start using LiveDocx, you must first <a class="ulink" href="https://www.livedocx.com/user/account_registration.aspx" target="_top">sign up</a>
                for an account. The account is completely free of charge and you only need to
                specify a <span class="emphasis"><em>username</em></span>, <span class="emphasis"><em>password</em></span> and
                <span class="emphasis"><em>e-mail address</em></span>. Your login credentials will be dispatched to
                the e-mail address you supply, so please type carefully.
            </p>
        </div>

        <div class="sect3">
<div class="titlepage"><div><div><h4 class="title">
<a name="zend.service.livedocx.templates-documents"></a>Templates and Documents</h4></div></div></div>
            

            <p>
                LiveDocx differentiates between the following terms: 1)
                <span class="emphasis"><em>template</em></span> and 2) <span class="emphasis"><em>document</em></span>. In order to
                fully understand the documentation and indeed the actual <acronym class="acronym">API</acronym>, it
                is important that any programmer deploying LiveDocx understands the difference.
            </p>

            <p>
                The term <span class="emphasis"><em>template</em></span> is used to refer to the input file, created
                in a word processor, containing formatting and text fields. You can download an
                <a class="ulink" href="http://www.phplivedocx.org/wp-content/uploads/2009/01/license-agreement-template.docx" target="_top">example
                    template</a>, stored as a <acronym class="acronym">DOCX</acronym> file. The term
                <span class="emphasis"><em>document</em></span> is used to refer to the output file that contains the
                template file, populated with data - i.e. the finished document. You can download an
                <a class="ulink" href="http://www.phplivedocx.org/wp-content/uploads/2009/01/license-agreement-document.pdf" target="_top">example
                    document</a>, stored as a <acronym class="acronym">PDF</acronym> file.
            </p>
        </div>

        <div class="sect3">
<div class="titlepage"><div><div><h4 class="title">
<a name="zend.service.livedocx.formats"></a>Supported File Formats</h4></div></div></div>
            

            <p>
                LiveDocx supports the following file formats:
            </p>

            <div class="sect4">
<div class="titlepage"><div><div><h5 class="title">
<a name="zend.service.livedocx.formats.template"></a>Template File Formats (input)</h5></div></div></div>
                

                <p>
                    Templates can be saved in any of the following file formats:
                </p>

                <div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; ">
<li class="listitem">
                        <p>
                            <a class="ulink" href="http://en.wikipedia.org/wiki/Office_Open_XML" target="_top">DOCX</a> -
                            Office Open <acronym class="acronym">XML</acronym> format
                        </p>
                    </li>
<li class="listitem">
                        <p>
                            <a class="ulink" href="http://en.wikipedia.org/wiki/DOC_(computing)" target="_top">DOC</a> -
                            Microsoft Word <acronym class="acronym">DOC</acronym> format
                        </p>
                    </li>
<li class="listitem">
                        <p>
                            <a class="ulink" href="http://en.wikipedia.org/wiki/Rich_Text_Format" target="_top">RTF</a> -
                            Rich text file format
                        </p>
                    </li>
<li class="listitem">
                        <p>
                            <a class="ulink" href="http://www.textcontrol.com/" target="_top">TXD</a> - TX Text Control
                            format
                        </p>
                    </li>
</ul></div>
            </div>

            <div class="sect4">
<div class="titlepage"><div><div><h5 class="title">
<a name="zend.service.livedocx.formats.document"></a>Document File Formats (output):</h5></div></div></div>
                

                <p>
                    The resulting document can be saved in any of the following file formats:
                </p>

                <div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; ">
<li class="listitem">
                        <p>
                            <a class="ulink" href="http://en.wikipedia.org/wiki/Office_Open_XML" target="_top">DOCX</a> -
                            Office Open <acronym class="acronym">XML</acronym> format
                        </p>
                    </li>
<li class="listitem">
                        <p>
                            <a class="ulink" href="http://en.wikipedia.org/wiki/DOC_(computing)" target="_top">DOC</a> -
                            Microsoft Word <acronym class="acronym">DOC</acronym> format
                        </p>
                    </li>
<li class="listitem">
                        <p>
                            <a class="ulink" href="http://en.wikipedia.org/wiki/Xhtml" target="_top">HTML</a> -
                            <acronym class="acronym">XHTML</acronym> 1.0 transitional format
                        </p>
                    </li>
<li class="listitem">
                        <p>
                            <a class="ulink" href="http://en.wikipedia.org/wiki/Rich_Text_Format" target="_top">RTF</a> -
                            Rich text file format
                        </p>
                    </li>
<li class="listitem">
                        <p>
                            <a class="ulink" href="http://en.wikipedia.org/wiki/Portable_Document_Format" target="_top">PDF</a>
                            - Acrobat Portable Document Format
                        </p>
                    </li>
<li class="listitem">
                        <p>
                            <a class="ulink" href="http://www.textcontrol.com/" target="_top">TXD</a> - TX Text Control
                            format
                        </p>
                    </li>
<li class="listitem">
                        <p>
                            <a class="ulink" href="http://en.wikipedia.org/wiki/Text_file" target="_top">TXT</a> -
                            <acronym class="acronym">ANSI</acronym> plain text
                        </p>
                    </li>
</ul></div>
            </div>

            <div class="sect4">
<div class="titlepage"><div><div><h5 class="title">
<a name="zend.service.livedocx.formats.imageimport"></a>Image File Formats (import):</h5></div></div></div>
                

                <p>
                    Images can be merged into templates in any of following file formats:
                </p>

                <div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; ">
<li class="listitem">
                        <p>
                            <a class="ulink" href="http://en.wikipedia.org/wiki/BMP_file_format" target="_top">BMP</a> -
                            Bitmap image format
                        </p>
                    </li>
<li class="listitem">
                        <p>
                            <a class="ulink" href="http://en.wikipedia.org/wiki/GIF" target="_top">GIF</a> - Graphics
                            Interchange Format
                        </p>
                    </li>
<li class="listitem">
                        <p>
                            <a class="ulink" href="http://en.wikipedia.org/wiki/Jpg" target="_top">JPG</a> - Joint
                            Photographic Experts Group format
                        </p>
                    </li>
<li class="listitem">
                        <p>
                            <a class="ulink" href="http://en.wikipedia.org/wiki/Portable_Network_Graphics" target="_top">PNG</a>
                            - Portable Network Graphics format
                        </p>
                    </li>
<li class="listitem">
                        <p>
                            <a class="ulink" href="http://en.wikipedia.org/wiki/Tagged_Image_File_Format" target="_top">TIFF</a>
                            - Tagged Image File Format
                        </p>
                    </li>
</ul></div>
            </div>

            <div class="sect4">
<div class="titlepage"><div><div><h5 class="title">
<a name="zend.service.livedocx.formats.imageexport"></a>Image File Formats (output):</h5></div></div></div>
                

                <p>
                    The resulting document can be exported to any of the following graphical file
                    formats:
                </p>

                <div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; ">
<li class="listitem">
                        <p>
                            <a class="ulink" href="http://en.wikipedia.org/wiki/BMP_file_format" target="_top">BMP</a> -
                            Bitmap image format
                        </p>
                    </li>
<li class="listitem">
                        <p>
                            <a class="ulink" href="http://en.wikipedia.org/wiki/GIF" target="_top">GIF</a> - Graphics
                            Interchange Format
                        </p>
                    </li>
<li class="listitem">
                        <p>
                            <a class="ulink" href="http://en.wikipedia.org/wiki/Jpg" target="_top">JPG</a> - Joint
                            Photographic Experts Group format
                        </p>
                    </li>
<li class="listitem">
                        <p>
                            <a class="ulink" href="http://en.wikipedia.org/wiki/Portable_Network_Graphics" target="_top">PNG</a>
                            - Portable Network Graphics format
                        </p>
                    </li>
<li class="listitem">
                        <p>
                            <a class="ulink" href="http://en.wikipedia.org/wiki/Tagged_Image_File_Format" target="_top">TIFF</a>
                            - Tagged Image File Format
                        </p>
                    </li>
<li class="listitem">
                        <p>
                            <a class="ulink" href="http://en.wikipedia.org/wiki/Windows_Metafile" target="_top">WMF</a> -
                            Windows Meta File format
                        </p>
                    </li>
</ul></div>
            </div>
        </div>
    </div>

    <div class="sect2">
<div class="titlepage"><div><div><h3 class="title">
<a name="zend.service.livedocx.mailmerge"></a>Zend_Service_LiveDocx_MailMerge</h3></div></div></div>
        

        <p>
             <code class="classname">Zend_Service_LiveDocx_MailMerge</code> is the mail-merge object in the
             <code class="classname">Zend_Service_LiveDocx</code> family.
        </p>

        <div class="sect3">
<div class="titlepage"><div><div><h4 class="title">
<a name="zend.service.livedocx.mailmerge.generation"></a>Document Generation Process</h4></div></div></div>
            

            <p>
                The document generation process can be simplified with the following equation:
            </p>

            <p>
                <span class="emphasis"><em>Template + Data = Document</em></span>
            </p>

            <p>
                Or expressed by the following diagram:
            </p>

            <p>
                <img src="figures/zend.service.livedocx.mailmerge.generation-diabasic_zoom.png">
            </p>

            <p>
                Data is inserted into template to create a document.
            </p>

            <p>
                A template, created in a word processing application, such as Microsoft Word, is
                loaded into LiveDocx. Data is then inserted into the template and the resulting
                document is saved to any supported format.
            </p>
        </div>

        <div class="sect3">
<div class="titlepage"><div><div><h4 class="title">
<a name="zend.service.livedocx.mailmerge.templates"></a>Creating Templates in Microsoft Word 2007</h4></div></div></div>
            

            <p>
                Start off by launching Microsoft Word and creating a new document. Next, open up the
                <span class="emphasis"><em>Field</em></span> dialog box. This looks as follows:
            </p>

            <p>
                <img src="figures/zend.service.livedocx.mailmerge.templates-msworddialog_zoom.png">
            </p>

            <p>
                Microsoft Word 2007 Field dialog box.
            </p>

            <p>
                Using this dialog, you can insert the required merge fields into your document.
                Below is a screenshot of a license agreement in Microsoft Word 2007. The merge
                fields are marked as <span class="command"><strong>{ MERGEFIELD FieldName }</strong></span>:
            </p>

            <p>
                <img src="figures/zend.service.livedocx.mailmerge.templates-mswordtemplatefull_zoom.png">
            </p>

            <p>
                Template in Microsoft Word 2007.
            </p>

            <p>
                Now, save the template as <span class="emphasis"><em>template.docx</em></span>.
            </p>

            <p>
                 In the next step, we are going to populate the merge fields with textual data from
                 <acronym class="acronym">PHP</acronym>.
            </p>

            <p>
                <img src="figures/zend.service.livedocx.mailmerge.templates-mswordtemplatecropped_zoom.png">
            </p>

            <p>
                Cropped template in Microsoft Word 2007.
            </p>

            <p>
                To populate the merge fields in the above cropped screenshot of the <a class="ulink" href="http://www.phplivedocx.org/wp-content/uploads/2009/01/license-agreement-template.docx" target="_top">template</a>
                in Microsoft Word, all we have to code is as follows:
            </p>

            <pre class="programlisting">
$phpLiveDocx = new Zend_Service_LiveDocx_MailMerge();

$phpLiveDocx-&gt;setUsername('myUsername')
            -&gt;setPassword('myPassword');

$phpLiveDocx-&gt;setLocalTemplate('template.docx');

$phpLiveDocx-&gt;assign('software', 'Magic Graphical Compression Suite v1.9')
            -&gt;assign('licensee', 'Henry Döner-Meyer')
            -&gt;assign('company',  'Co-Operation');

$phpLiveDocx-&gt;createDocument();

$document = $phpLiveDocx-&gt;retrieveDocument('pdf');

file_put_contents('document.pdf', $document);
</pre>

            <p>
                The resulting document is written to disk in the file
                <span class="emphasis"><em>document.pdf</em></span>. This file can now be post-processed, sent via
                e-mail or simply displayed, as is illustrated below in <span class="emphasis"><em>Document Viewer
                    2.26.1</em></span> on <span class="emphasis"><em>Ubuntu 9.04</em></span>:
            </p>

            <p>
                <img src="figures/zend.service.livedocx.mailmerge.templates-msworddocument_zoom.png">
            </p>

            <p>
                Resulting document as <acronym class="acronym">PDF</acronym> in Document Viewer 2.26.1.
            </p>
        </div>

        <div class="sect3">
<div class="titlepage"><div><div><h4 class="title">
<a name="zend.service.livedocx.mailmerge.imagemerge"></a>Merging image data</h4></div></div></div>

            

            <p>
                Using <code class="classname">Zend_Service_LiveDocx_MailMerge</code> it is also possible to merge images into
                a template. This feature is useful, for example, in the case of a badge application
                for a conference. In addition to the name and company name that should appear on
                the badge, it is possible to insert a photo of the delegate, using the API.
            </p>

            <p>
                Even it is sounds a little counter-intuitive, image-merging also work with
                text fields, as described in the section above. In fact, inserting a text field
                for an image is identical to inserting a text field for textual information.
                The only difference is the naming convention of the text field. Whereas, a text
                field for textual information can have (almost) any identifier, a text field for
                an image must start with <span class="emphasis"><em>image:</em></span>. For example, in the case of our badge
                application, we would have the following 3 fields:
            </p>

            <p>
                <img src="figures/zend.service.livedocx.mailmerge.templates-imagemerge_zoom.png">
            </p>

            <p>
                The text field, into which image data will be inserted is called <span class="emphasis"><em>image:photo</em></span>
                and can be populated just like any other text field, using the assign method. The
                text fields <span class="emphasis"><em>name</em></span> and <span class="emphasis"><em>company</em></span> are regular
                text fields for textual information.
            </p>

            <p>
                Before we insert graphic data, we first have to upload the image to the backend
                LiveDocx server. This can be achieved using the <span class="emphasis"><em>uploadImage($filename)</em></span> method.
            </p>

            <p>The following code snippet illustrates the flow:</p>

            <pre class="programlisting">
$phpLiveDocx = new Zend_Service_LiveDocx_MailMerge();

$phpLiveDocx-&gt;setUsername('username')
            -&gt;setPassword('password');

$photoFilename = 'dailemaitre.jpg';

if (!$phpLiveDocx-&gt;imageExists($photoFilename)) {
    $phpLiveDocx-&gt;uploadImage($photoFilename);
}

$phpLiveDocx-&gt;setLocalTemplate('template.docx');

$phpLiveDocx-&gt;assign('name',        'Daï Lemaitre')
            -&gt;assign('company',     'Megasoft Co-operation')
            -&gt;assign('date',        Zend_Date::now()-&gt;toString(Zend_Date::DATE_LONG))
            -&gt;assign('image:photo', $photoFilename);

$phpLiveDocx-&gt;createDocument();

$document = $phpLiveDocx-&gt;retrieveDocument('pdf');

file_put_contents('document.pdf', $document);

$phpLiveDocx-&gt;deleteImage($photoFilename);
</pre>

            <p>
                Note that all images uploaded to your LiveDocx account must have a unique
                filename. In the case that you only intend to use the image once (such
                as is probable for our badge application), it makes sense to immediately
                delete it from the backend, using the <span class="emphasis"><em>deleteImage($filename)</em></span> method.
            </p>

        </div>

        <div class="sect3">
<div class="titlepage"><div><div><h4 class="title">
<a name="zend.service.livedocx.mailmerge.advanced"></a>Advanced Mail-Merge</h4></div></div></div>
            

            <p>
                <code class="classname">Zend_Service_LiveDocx_MailMerge</code> allows designers to insert
                any number of text fields into a template. These text fields are populated with data
                when <span class="emphasis"><em>createDocument()</em></span> is called.
            </p>

            <p>
                In addition to text fields, it is also possible specify regions of a document, which
                should be repeated.
            </p>

            <p>
                For example, in a telephone bill it is necessary to print out a list of all
                connections, including the destination number, duration and cost of each call. This
                repeating row functionality can be achieved with so called blocks.
            </p>

            <p>
                <span class="emphasis"><em>Blocks</em></span> are simply regions of a document, which are repeated
                when <code class="methodname">createDocument()</code> is called. In a block any number of
                <span class="emphasis"><em>block fields</em></span> can be specified.
            </p>

            <p>
                Blocks consist of two consecutive document targets with a unique name. The following
                screenshot illustrates these targets and their names in red:
            </p>

            <p>
                <img src="figures/zend.service.livedocx.mailmerge.advanced-mergefieldblockformat_zoom.png">
            </p>

            <p>
                The format of a block is as follows:
            </p>

            <pre class="programlisting">
blockStart_ + unique name
blockEnd_ + unique name
</pre>

            <p>For example:</p>

            <pre class="programlisting">
blockStart_block1
blockEnd_block1
</pre>

            <p>
                The content of a block is repeated, until all data assigned in the block fields has
                been injected into the template. The data for block fields is specified in
                <acronym class="acronym">PHP</acronym> as a multi-assoc array.
            </p>

            <p>
                The following screenshot of a template in Microsoft Word 2007 shows how block fields
                are used:
            </p>

            <p>
                <img src="figures/zend.service.livedocx.mailmerge.advanced-mswordblockstemplate_zoom.png">
            </p>

            <p>
                Template, illustrating blocks in Microsoft Word 2007.
            </p>

            <p>
                The following code populates the above template with data.
            </p>

            <pre class="programlisting">
$phpLiveDocx = new Zend_Service_LiveDocx_MailMerge();

$phpLiveDocx-&gt;setUsername('myUsername')
            -&gt;setPassword('myPassword');

$phpLiveDocx-&gt;setLocalTemplate('template.doc');

$billConnections = array(
    array(
        'connection_number'   =&gt; '+49 421 335 912',
        'connection_duration' =&gt; '00:00:07',
        'fee'                 =&gt; '€ 0.03',
    ),
    array(
        'connection_number'   =&gt; '+49 421 335 913',
        'connection_duration' =&gt; '00:00:07',
        'fee'                 =&gt; '€ 0.03',
    ),
    array(
        'connection_number'   =&gt; '+49 421 335 914',
        'connection_duration' =&gt; '00:00:07',
        'fee'                 =&gt; '€ 0.03',
    ),
    array(
        'connection_number'   =&gt; '+49 421 335 916',
        'connection_duration' =&gt; '00:00:07',
        'fee'                 =&gt; '€ 0.03',
    ),
);

$phpLiveDocx-&gt;assign('connection', $billConnections);

// ... assign other data here ...

$phpLiveDocx-&gt;createDocument();
$document = $phpLiveDocx-&gt;retrieveDocument('pdf');
file_put_contents('document.pdf', $document);
</pre>

            <p>
                The data, which is specified in the array <code class="varname">$billConnections</code> is
                repeated in the template in the block connection. The keys of the array
                (<code class="varname">connection_number</code>, <code class="varname">connection_duration</code> and
                <code class="varname">fee</code>) are the block field names - their data is inserted, one row
                per iteration.
            </p>

            <p>
                The resulting document is written to disk in the file
                <span class="emphasis"><em>document.pdf</em></span>. This file can now be post-processed, sent via
                e-mail or simply displayed, as is illustrated below in <span class="emphasis"><em>Document Viewer
                    2.26.1</em></span> on <span class="emphasis"><em>Ubuntu 9.04</em></span>:
            </p>

            <p>
                <img src="figures/zend.service.livedocx.mailmerge.advanced-mswordblocksdocument_zoom.png">
            </p>

            <p>
                Resulting document as <acronym class="acronym">PDF</acronym> in Document Viewer 2.26.1.
            </p>

            <p>
                You can download the <acronym class="acronym">DOC</acronym> <a class="ulink" href="http://www.phplivedocx.org/wp-content/uploads/2009/01/telephone-bill-template.doc" target="_top">template
                    file</a> and the resulting <a class="ulink" href="http://www.phplivedocx.org/wp-content/uploads/2009/01/telephone-bill-document.pdf" target="_top">PDF
                    document</a>.
            </p>

            <p>
                <span class="emphasis"><em>NOTE:</em></span> blocks may not be nested.
            </p>
        </div>

        <div class="sect3">
<div class="titlepage"><div><div><h4 class="title">
<a name="zend.service.livedocx.mailmerge.bitmaps"></a>Generating bitmaps image files</h4></div></div></div>
            

            <p>
                In addition to document file formats,
                <code class="classname">Zend_Service_LiveDocx_MailMerge</code> also allows documents to be
                exported to a number of image file formats (<acronym class="acronym">BMP</acronym>,
                <acronym class="acronym">GIF</acronym>, <acronym class="acronym">JPG</acronym>, <acronym class="acronym">PNG</acronym> and
                <acronym class="acronym">TIFF</acronym>). Each page of the document is saved to one file.
            </p>

            <p>
                The following sample illustrates the use of <code class="methodname">getBitmaps($fromPage,
                    $toPage, $zoomFactor, $format)</code> and
                <code class="methodname">getAllBitmaps($zoomFactor, $format)</code>.
            </p>

            <p>
                <code class="varname">$fromPage</code> is the lower-bound page number of the page range that
                should be returned as an image and <code class="varname">$toPage</code> the upper-bound page
                number. <code class="varname">$zoomFactor</code> is the size of the images, as a percent,
                relative to the original page size. The range of this parameter is 10 to 400.
                <code class="varname">$format</code> is the format of the images returned by this method. The
                supported formats can be obtained by calling
                <code class="methodname">getImageExportFormats()</code>.
            </p>

            <pre class="programlisting">
$date = new Zend_Date();
$date-&gt;setLocale('en_US');

$phpLiveDocx = new Zend_Service_LiveDocx_MailMerge();

$phpLiveDocx-&gt;setUsername('myUsername')
            -&gt;setPassword('myPassword');

$phpLiveDocx-&gt;setLocalTemplate('template.docx');

$phpLiveDocx-&gt;assign('software', 'Magic Graphical Compression Suite v1.9')
            -&gt;assign('licensee', 'Daï Lemaitre')
            -&gt;assign('company',  'Megasoft Co-operation')
            -&gt;assign('date',     $date-&gt;get(Zend_Date::DATE_LONG))
            -&gt;assign('time',     $date-&gt;get(Zend_Date::TIME_LONG))
            -&gt;assign('city',     'Lyon')
            -&gt;assign('country',  'France');

$phpLiveDocx-&gt;createDocument();

// Get all bitmaps
// (zoomFactor, format)
$bitmaps = $phpLiveDocx-&gt;getAllBitmaps(100, 'png');

// Get just bitmaps in specified range
// (fromPage, toPage, zoomFactor, format)
// $bitmaps = $phpLiveDocx-&gt;getBitmaps(2, 2, 100, 'png');

foreach ($bitmaps as $pageNumber =&gt; $bitmapData) {
    $filename = sprintf('documentPage%d.png', $pageNumber);
    file_put_contents($filename, $bitmapData);
}
</pre>

            <p>
                This produces two files (<code class="filename">documentPage1.png</code> and
                <code class="filename">documentPage2.png</code>) and writes them to disk in the same
                directory as the executable <acronym class="acronym">PHP</acronym> file.
            </p>

            <p>
                <img src="figures/zend.service.livedocx.mailmerge.bitmaps-documentpage1_zoom.png">
            </p>

            <p>
                documentPage1.png.
            </p>

            <p>
                <img src="figures/zend.service.livedocx.mailmerge.bitmaps-documentpage2_zoom.png">
            </p>

            <p>
                documentPage2.png.
            </p>
        </div>

        <div class="sect3">
<div class="titlepage"><div><div><h4 class="title">
<a name="zend.service.livedocx.mailmerge.templates-types"></a>Local vs. Remote Templates</h4></div></div></div>
            

            <p>
                Templates can be stored <span class="emphasis"><em>locally</em></span>, on the client machine, or
                <span class="emphasis"><em>remotely</em></span>, on the server. There are advantages and disadvantages
                to each approach.
            </p>

            <p>
                In the case that a template is stored locally, it must be transfered from the client
                to the server on every request. If the content of the template rarely changes, this
                approach is inefficient. Similarly, if the template is several megabytes in size, it
                may take considerable time to transfer it to the server. Local template are useful
                in situations in which the content of the template is constantly changing.
            </p>

            <p>
                The following code illustrates how to use a local template.
            </p>

            <pre class="programlisting">
$phpLiveDocx = new Zend_Service_LiveDocx_MailMerge();

$phpLiveDocx-&gt;setUsername('myUsername')
            -&gt;setPassword('myPassword');

$phpLiveDocx-&gt;setLocalTemplate('./template.docx');

// assign data and create document
</pre>

            <p>
                In the case that a template is stored remotely, it is uploaded once to the server
                and then simply referenced on all subsequent requests. Obviously, this is much
                quicker than using a local template, as the template does not have to be transfered
                on every request. For speed critical applications, it is recommended to use the
                remote template method.
            </p>

            <p>
                The following code illustrates how to upload a template to the server:
            </p>

            <pre class="programlisting">
$phpLiveDocx = new Zend_Service_LiveDocx_MailMerge();

$phpLiveDocx-&gt;setUsername('myUsername')
            -&gt;setPassword('myPassword');

$phpLiveDocx-&gt;uploadTemplate('template.docx');
</pre>

            <p>
                The following code illustrates how to reference the remotely stored template on all
                subsequent requests:
            </p>

            <pre class="programlisting">
$phpLiveDocx = new Zend_Service_LiveDocx_MailMerge();

$phpLiveDocx-&gt;setUsername('myUsername')
            -&gt;setPassword('myPassword');

$phpLiveDocx-&gt;setRemoteTemplate('template.docx');

// assign data and create document
</pre>
        </div>

        <div class="sect3">
<div class="titlepage"><div><div><h4 class="title">
<a name="zend.service.livedocx.mailmerge.information"></a>Getting Information</h4></div></div></div>
            

            <p>
                <code class="classname">Zend_Service_LiveDocx_MailMerge</code> provides a number of methods
                to get information on field names, available fonts and supported formats.
            </p>

            <div class="example">
<a name="zend.service.livedocx.mailmerge.information.getfieldname"></a><p class="title"><b>Ejemplo 781. Get Array of Field Names in Template</b></p>
<div class="example-contents">
                

                <p>
                    The following code returns and displays an array of all field names in the
                    specified template. This functionality is useful, in the case that you create an
                    application, in which an end-user can update a template.
                </p>

                <pre class="programlisting">
$phpLiveDocx = new Zend_Service_LiveDocx_MailMerge();

$phpLiveDocx-&gt;setUsername('myUsername')
            -&gt;setPassword('myPassword');

$templateName = 'template-1-text-field.docx';
$phpLiveDocx-&gt;setLocalTemplate($templateName);

$fieldNames = $phpLiveDocx-&gt;getFieldNames();
foreach ($fieldNames as $fieldName) {
    printf('- %s%s', $fieldName, PHP_EOL);
}
</pre>
            </div>
</div>
<br class="example-break">

            <div class="example">
<a name="zend.service.livedocx.mailmerge.information.getblockfieldname"></a><p class="title"><b>Ejemplo 782. Get Array of Block Field Names in Template</b></p>
<div class="example-contents">
                

                <p>
                    The following code returns and displays an array of all block field names in the
                    specified template. This functionality is useful, in the case that you create an
                    application, in which an end-user can update a template. Before such templates
                    can be populated, it is necessary to find out the names of the contained block
                    fields.
                </p>

                <pre class="programlisting">
$phpLiveDocx = new Zend_Service_LiveDocx_MailMerge();

$phpLiveDocx-&gt;setUsername('myUsername')
            -&gt;setPassword('myPassword');

$templateName = 'template-block-fields.doc';
$phpLiveDocx-&gt;setLocalTemplate($templateName);

$blockNames = $phpLiveDocx-&gt;getBlockNames();
foreach ($blockNames as $blockName) {
    $blockFieldNames = $phpLiveDocx-&gt;getBlockFieldNames($blockName);
    foreach ($blockFieldNames as $blockFieldName) {
        printf('- %s::%s%s', $blockName, $blockFieldName, PHP_EOL);
    }
}
</pre>
            </div>
</div>
<br class="example-break">

            <div class="example">
<a name="zend.service.livedocx.mailmerge.information.getfontnames"></a><p class="title"><b>Ejemplo 783. Get Array of Fonts Installed on Server</b></p>
<div class="example-contents">
                

                <p>
                    The following code returns and displays an array of all fonts installed on the
                    server. You can use this method to present a list of fonts which may be used in
                    a template. It is important to inform the end-user about the fonts installed on
                    the server, as only these fonts may be used in a template. In the case that a
                    template contains fonts, which are not available on the server,
                    font-substitution will take place. This may lead to undesirable results.
                </p>

                <pre class="programlisting">
$phpLiveDocx = new Zend_Service_LiveDocx_MailMerge();

$phpLiveDocx-&gt;setUsername('myUsername')
            -&gt;setPassword('myPassword');

Zend_Debug::dump($phpLiveDocx-&gt;getFontNames());
</pre>

                <p>
                    <span class="emphasis"><em>NOTE:</em></span> As the return value of this method changes very
                    infrequently, it is highly recommended to use a cache, such as
                    <code class="classname">Zend_Cache</code> - this will considerably speed up your
                    application.
                </p>
            </div>
</div>
<br class="example-break">

            <div class="example">
<a name="zend.service.livedocx.mailmerge.information.gettemplateformats"></a><p class="title"><b>Ejemplo 784. Get Array of Supported Template File Formats</b></p>
<div class="example-contents">
                

                <p>
                    The following code returns and displays an array of all supported template file
                    formats. This method is particularly useful in the case that a combo list should
                    be displayed that allows the end-user to select the input format of the
                    documentation generation process.
                </p>

                <pre class="programlisting">
$phpLiveDocx = new Zend_Service_LiveDocx_MailMerge()

$phpLiveDocx-&gt;setUsername('myUsername')
            -&gt;setPassword('myPassword');

Zend_Debug::dump($phpLiveDocx-&gt;getTemplateFormats());
</pre>

                <p>
                    <span class="emphasis"><em>NOTE:</em></span> As the return value of this method changes very
                    infrequently, it is highly recommended to use a cache, such as
                    <code class="classname">Zend_Cache</code> - this will considerably speed up your
                    application.
                </p>
            </div>
</div>
<br class="example-break">

            <div class="example">
<a name="zend.service.livedocx.mailmerge.information.getdocumentformats"></a><p class="title"><b>Ejemplo 785. Get Array of Supported Document File Formats</b></p>
<div class="example-contents">
                

                <p>
                    The following code returns and displays an array of all supported document file
                    formats. This method is particularly useful in the case that a combo list should
                    be displayed that allows the end-user to select the output format of the
                    documentation generation process.
                </p>

                <pre class="programlisting">
$phpLiveDocx = new Zend_Service_LiveDocx_MailMerge();

$phpLiveDocx-&gt;setUsername('myUsername')
            -&gt;setPassword('myPassword');

Zend_Debug::dump($phpLiveDocx-&gt;getDocumentFormats());
</pre>
            </div>
</div>
<br class="example-break">

            <div class="example">
<a name="zend.service.livedocx.mailmerge.information.getimageimportformats"></a><p class="title"><b>Ejemplo 786. Get Array of Supported Image Import File Formats</b></p>
<div class="example-contents">
                

                <p>
                    The following code returns and displays an array of all supported imput image file
                    formats.
                </p>

                <pre class="programlisting">
$phpLiveDocx = new Zend_Service_LiveDocx_MailMerge();

$phpLiveDocx-&gt;setUsername('myUsername')
            -&gt;setPassword('myPassword');

Zend_Debug::dump($phpLiveDocx-&gt;getImageImportFormats());
</pre>

                <p>
                    <span class="emphasis"><em>NOTE:</em></span> As the return value of this method changes very
                    infrequently, it is highly recommended to use a cache, such as
                    <code class="classname">Zend_Cache</code> - this will considerably speed up your
                    application.
                </p>
            </div>
</div>
<br class="example-break">

            <div class="example">
<a name="zend.service.livedocx.mailmerge.information.getimageexportformats"></a><p class="title"><b>Ejemplo 787. Get Array of Supported Image Export File Formats</b></p>
<div class="example-contents">
                

                <p>
                    The following code returns and displays an array of all supported export image file
                    formats. This method is particularly useful in the case that a combo list should
                    be displayed that allows the end-user to select the output format of the
                    documentation generation process.
                </p>

                <pre class="programlisting">
$phpLiveDocx = new Zend_Service_LiveDocx_MailMerge();

$phpLiveDocx-&gt;setUsername('myUsername')
            -&gt;setPassword('myPassword');

Zend_Debug::dump($phpLiveDocx-&gt;getImageExportFormats());
</pre>

                <p>
                    <span class="emphasis"><em>NOTE:</em></span> As the return value of this method changes very
                    infrequently, it is highly recommended to use a cache, such as
                    <code class="classname">Zend_Cache</code> - this will considerably speed up your
                    application.
                </p>
            </div>
</div>
<br class="example-break">
        </div>
    </div>
</div>
<div class="navfooter"><table width="100%" summary="Navigation footer">
<tr>
<td width="40%" align="left">
<a accesskey="p" href="zend.service.flickr.html">Anterior</a> </td>
<td width="20%" align="center"><a accesskey="u" href="zend.service.html">Subir</a></td>
<td width="40%" align="right"> <a accesskey="n" href="zend.service.rackspace.html">Siguiente</a>
</td>
</tr>
<tr>
<td width="40%" align="left" valign="top">Zend_Service_Flickr </td>
<td width="20%" align="center"><a accesskey="h" href="index.html">Inicio</a></td>
<td width="40%" align="right" valign="top"> Zend_Service_Rackspace</td>
</tr>
</table></div>
<div class="revinfo"></div>
</body>
</html>
