<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Créer votre projet</title>
<link rel="stylesheet" type="text/css" href="dbstyle.css">
<meta name="generator" content="DocBook XSL Stylesheets V1.79.2">
<link rel="home" href="index.html" title="Guide de référence du programmeur">
<link rel="up" href="learning.quickstart.html" title="Démarrez rapidement avec Zend Framework">
<link rel="prev" href="learning.quickstart.intro.html" title="Zend Framework &amp; Introduction MVC">
<link rel="next" href="learning.quickstart.create-layout.html" title="Créer une layout">
</head>
<body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF">
<div class="navheader"><table width="100%" summary="Navigation header">
<tr><th colspan="3" align="center">Créer votre projet</th></tr>
<tr>
<td width="20%" align="left">
<a accesskey="p" href="learning.quickstart.intro.html">Précédent</a> </td>
<th width="60%" align="center">Démarrez rapidement avec Zend Framework</th>
<td width="20%" align="right"> <a accesskey="n" href="learning.quickstart.create-layout.html">Suivant</a>
</td>
</tr>
</table></div>
<div class="sect1">
<div class="titlepage"><div><div><h2 class="title" style="clear: both">
<a name="learning.quickstart.create-project"></a>Créer votre projet</h2></div></div></div>
    

    <p>
        Afin de créer un projet, vous devez d'abord télécharger et extraire Zend Framework.
    </p>

    <div class="sect2">
<div class="titlepage"><div><div><h3 class="title">
<a name="learning.quickstart.create-project.install-zf"></a>Installer Zend Framework</h3></div></div></div>
        

        <p>
            La manière la plus simple d'obtenir Zend Framework avec une pile <acronym class="acronym">PHP</acronym>
            complète est d'installer <a class="ulink" href="http://www.zend.com/en/products/server-ce/downloads" target="_top">
            Zend Server</a>. Zend Server possède des installeurs natifs pour Mac OSX, Windows, Fedora Core,
            et Ubuntu, ainsi qu'un installeur universel pour la plupart des distributions Linux.
        </p>

        <p>
            Après avoir installé Zend Server, les fichiers du Framework devraient se trouver sous
            <code class="filename">/usr/local/zend/share/ZendFramework</code> sur Mac OSX et Linux,
            et <code class="filename">C:\Program Files\Zend\ZendServer\share\ZendFramework</code> sur
            Windows. L'<code class="constant">include_path</code> aura déja été configuré pour inclure
            Zend Framework.
        </p>

        <p>
            Il reste bien sûr possible <a class="ulink" href="http://framework.zend.com/download/latest" target="_top"> de télécharger
            la dernière version de Zend Framework</a> et l'extraire; notez simplement où vous choisissez
            de l'extraire.
        </p>

        <p>
            Optionellement, vous pouvez ajouter le chemin vers le sous-dossier <code class="filename">library/</code>
            de l'archive à l'<code class="constant">include_path</code> de votre <code class="filename">php.ini</code>.
        </p>

        <p>
            Ca y est! Zend Framework est maintenant installé et prêt à l'emploi.
        </p>
    </div>

    <div class="sect2">
<div class="titlepage"><div><div><h3 class="title">
<a name="learning.quickstart.create-project.create-project"></a>Créer votre projet</h3></div></div></div>
        

        <div class="note"><table border="0" summary="Note: Outil en ligne de commandes zf">
<tr>
<td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></td>
<th align="left">Outil en ligne de commandes zf</th>
</tr>
<tr><td align="left" valign="top">
            

            <p>
                Dans la dossier <code class="filename">bin/</code> de votre installation de Zend Framework
                se trouvent les scripts <code class="filename">zf.sh</code> et <code class="filename">zf.bat</code>
                pour Unix et Windows respectivement. Notez le chemin absolu vers ces fichiers.
            </p>

            <p>
                Partout ou vous voyez uyne référence à la commande <span class="command"><strong>zf</strong></span>, utilisez le chemin
                absolu du script. Sur les système Unix, vous pouvez utiliser la fonctionnalité d'alias dans le
                shell: <span class="command"><strong>alias zf.sh=path/to/ZendFramework/bin/zf.sh</strong></span>.
            </p>

            <p>
                Si vous avez des problèmes pour configurer la commande <span class="command"><strong>zf</strong></span>, veuillez vous
                référer <a class="link" href="zend.tool.framework.clitool.html" title="Using the CLI Tool">au manuel</a>.
            </p>
        </td></tr>
</table></div>

        <p>
            Ouvrez un terminal (sous Windows, <span class="command"><strong>Démarrer -&gt; Exécuter</strong></span>, puis
            <span class="command"><strong>cmd</strong></span>). Naviguez vers un dossier dans lequel vous souhaitez démarrer un projet.
            Puis, utilisez le chemin vers le script approprié et lancez:
        </p>

        <pre class="programlisting">
% zf create project quickstart
</pre>

        <p>
            Cette commande crée un projet avec une structure basique incluant des contrôleurs et vues.
            L'arbre va ressembler à ceci:
        </p>

        <pre class="programlisting">
quickstart
|-- application
|   |-- Bootstrap.php
|   |-- configs
|   |   `-- application.ini
|   |-- controllers
|   |   |-- ErrorController.php
|   |   `-- IndexController.php
|   |-- models
|   `-- views
|       |-- helpers
|       `-- scripts
|           |-- error
|           |   `-- error.phtml
|           `-- index
|               `-- index.phtml
|-- library
|-- public
|   |-- .htaccess
|   `-- index.php
`-- tests
    |-- application
    |   `-- bootstrap.php
    |-- library
    |   `-- bootstrap.php
    `-- phpunit.xml
</pre>

        <p>
            Dès lors si vous n'avez pas ajouté Zend Framework à votre
            <code class="constant">include_path</code>, nous vous recommandons de copier ou lier celui-ci dans
            le dossier <code class="filename">library/</code> de votre projet. Dans ce cas vous devriez copier
            récursivement (ou lier) <code class="filename">library/Zend/</code> de l'installation de
            Zend Framework vers le dossier <code class="filename">library/</code> de votre projet. Sur les
            systèmes Unix cela peut être effectué de la manière suivante:
        </p>

        <pre class="programlisting">
# Symlink:
% cd library; ln -s path/to/ZendFramework/library/Zend .

# Copy:
% cd library; cp -r path/to/ZendFramework/library/Zend .
</pre>

        <p>
            Sur Windows le plus simple sera d'utiliser l'explorateur.
        </p>

        <p>
            Maintenant que le projet est crée, les principaux points à comprendre sont le
            bootstrap, la configuration, les contrôleurs d'action et les vues.
        </p>
    </div>

    <div class="sect2">
<div class="titlepage"><div><div><h3 class="title">
<a name="learning.quickstart.create-project.bootstrap"></a>Le Bootstrap</h3></div></div></div>
        

        <p>
            Votre classe <code class="classname">Bootstrap</code> définit les ressources (composants) à
            initialiser. Par défaut, le <a class="link" href="zend.controller.front.html" title="Le contrôleur frontal (Front Controller)">contrôleur frontal
            </a> est initialisé et il utilise <code class="filename">application/controllers/</code>
            comme dossier de contrôleurs par défaut (nous reverrons cela). La classe ressemble à:
        </p>

        <pre class="programlisting">
// application/Bootstrap.php

class Bootstrap extends Zend_Application_Bootstrap_Bootstrap
{
}
</pre>

        <p>
            Comme vous le voyez, rien de plus n'est nécessaire pour commencer.
        </p>
    </div>

    <div class="sect2">
<div class="titlepage"><div><div><h3 class="title">
<a name="learning.quickstart.create-project.configuration"></a>Configuration</h3></div></div></div>
        

        <p>
            Le Zend Framework lui-même n'a pas besoin de configuration, mais l'application oui. La
            configuration par défaut est placée sous
            <code class="filename">application/configs/application.ini</code> et contient des directives de base
            pour régler l'environnement <acronym class="acronym">PHP</acronym> (par exemple, activer ou désactiver le
            rapport d'erreurs), indiquer le chemin vers votre classe de bootstrap (ainsi que son nom)
            , et le chemin vers les contrôleurs d'action. Cela ressemble à:
        </p>

        <pre class="programlisting">
; application/configs/application.ini

[production]
phpSettings.display_startup_errors = 0
phpSettings.display_errors = 0
includePaths.library = APPLICATION_PATH "/../library"
bootstrap.path = APPLICATION_PATH "/Bootstrap.php"
bootstrap.class = "Bootstrap"
appnamespace = "Application"
resources.frontController.controllerDirectory = APPLICATION_PATH "/controllers"
resources.frontController.params.displayExceptions = 0

[staging : production]

[testing : production]
phpSettings.display_startup_errors = 1
phpSettings.display_errors = 1

[development : production]
phpSettings.display_startup_errors = 1
phpSettings.display_errors = 1
</pre>

        <p>
            Plusieurs choses sont à connaitre concernant ce fichier. D'abord, si vous utilisez une
            configuration basée sur des fichiers <acronym class="acronym">INI</acronym>, vous pouvez faire usage des
            constantes directement; <code class="constant">APPLICATION_PATH</code> est ici une constante. Aussi,
            notez que plusieurs sections ont été définies: production, staging, testing, et
            development. Les trois dernières héritent de la section "production". C'est une manière utile
            d'organiser sa configuration et de s'assurer que les paramètres appropriés sont utilisés
            pour chaque étape du développement de l'application.
        </p>
    </div>

    <div class="sect2">
<div class="titlepage"><div><div><h3 class="title">
<a name="learning.quickstart.create-project.action-controllers"></a>Contrôleurs d'action</h3></div></div></div>
        

        <p>
            Les <span class="emphasis"><em>contrôleurs d'action</em></span> de votre application contiennent la logique 'utile'
            de celle-ci et font correspondre les requêtes aux bons modèles et aux bonnes vues.
        </p>

        <p>
            Un contrôleur d'action devrait posséder une ou plusieurs méthodes se terminant par
            "Action"; ces méthodes sont interrogées via le web. Par défaut, les URLs de Zend
            Framework suivent le schéma <code class="constant">/controller/action</code>, où
            "controller" correspond à la classe de contrôleur (sans le suffixe "Controller")
            et "action" correspond à la méthode d'action (sans le suffixe "Action").
        </p>

        <p>
            Typiquement, vous aurez toujours besoin d'un <code class="classname">IndexController</code>,
            qui est utilisé par défaut et servira aussi la page d'accueil, et un
            <code class="classname">ErrorController</code>, utilisé pour indiquer les erreurs
            <acronym class="acronym">HTTP</acronym> 404 (contrôleur ou action introuvable) et les erreurs
            <acronym class="acronym">HTTP</acronym> 500 (erreurs de l'application).
        </p>

        <p>
            <code class="classname">IndexController</code> par défaut est défini comme suit:
        </p>

        <pre class="programlisting">
// application/controllers/IndexController.php

class IndexController extends Zend_Controller_Action
{

    public function init()
    {
        /* Initialisez le contrôleur et l'action ici */
    }

    public function indexAction()
    {
        // corps de l'action
    }
}
</pre>

        <p>
            <code class="classname">ErrorController</code> par défaut est défini comme suit:
        </p>

        <pre class="programlisting">
// application/controllers/ErrorController.php

class ErrorController extends Zend_Controller_Action
{

    public function errorAction()
    {
        $errors = $this-&gt;_getParam('error_handler');

        switch ($errors-&gt;type) {
            case Zend_Controller_Plugin_ErrorHandler::EXCEPTION_NO_ROUTE:
            case Zend_Controller_Plugin_ErrorHandler::EXCEPTION_NO_CONTROLLER:
            case Zend_Controller_Plugin_ErrorHandler::EXCEPTION_NO_ACTION:

                // 404 error -- controller or action not found
                $this-&gt;getResponse()-&gt;setHttpResponseCode(404);
                $this-&gt;view-&gt;message = 'Page not found';
                break;
            default:
                // application error
                $this-&gt;getResponse()-&gt;setHttpResponseCode(500);
                $this-&gt;view-&gt;message = 'Application error';
                break;
        }

        $this-&gt;view-&gt;exception = $errors-&gt;exception;
        $this-&gt;view-&gt;request   = $errors-&gt;request;
    }
}
</pre>

        <p>
            Notez que (1) <code class="classname">IndexController</code> ne contient pas de code réel,
            et (2) <code class="classname">ErrorController</code> référence un attribut "view".
            Ceci nous mène vers la section suivante.
        </p>
    </div>

    <div class="sect2">
<div class="titlepage"><div><div><h3 class="title">
<a name="learning.quickstart.create-project.views"></a>Vues</h3></div></div></div>
        

        <p>
            Les vues dans Zend Framework sont écrites en <acronym class="acronym">PHP</acronym> classique. Les scripts
            de vues sont placés sous <code class="filename">application/views/scripts/</code>, ils sont
            référencés plus tard dans les contrôleurs. Dans notre cas, nous avons un
            <code class="classname">IndexController</code> et un <code class="classname">ErrorController</code>,
            et nous avons ainsi des dossiers <code class="filename">index/</code> et
            <code class="filename">error/</code> correspondants dans le dossier scripts des vues. Dans ces
            dossiers, vous trouverez ou créerez des scripts de vue correspondants aux actions
            exposées par les contrôleurs; dans le cas par défaut nous avons ainsi des scripts de
            vue <code class="filename">index/index.phtml</code> et <code class="filename">error/error.phtml</code>.
        </p>

        <p>
            Les scripts de vue peuvent contenir le code de présentation que vous voulez et utiliser
            les tags <span class="emphasis"><em>&lt;?php</em></span> ou <span class="emphasis"><em>?&gt;</em></span> pour insérer du
            <acronym class="acronym">PHP</acronym>.
        </p>

        <p>
            Ce qui suit présente le code par défaut de <code class="filename">index/index.phtml</code>:
        </p>

        <pre class="programlisting">
&lt;!-- application/views/scripts/index/index.phtml --&gt;
&lt;style&gt;

    a:link,
    a:visited
    {
        color: #0398CA;
    }

    span#zf-name
    {
        color: #91BE3F;
    }

    div#welcome
    {
        color: #FFFFFF;
        background-image: url(http://framework.zend.com/images/bkg_header.jpg);
        width:  600px;
        height: 400px;
        border: 2px solid #444444;
        overflow: hidden;
        text-align: center;
    }

    div#more-information
    {
        background-image: url(http://framework.zend.com/images/bkg_body-bottom.gif);
        height: 100%;
    }

&lt;/style&gt;
&lt;div id="welcome"&gt;
    &lt;h1&gt;Welcome to the &lt;span id="zf-name"&gt;Zend Framework!&lt;/span&gt;&lt;h1 /&gt;
    &lt;h3&gt;This is your project's main page&lt;h3 /&gt;
    &lt;div id="more-information"&gt;
        &lt;p&gt;
            &lt;img src="http://framework.zend.com/images/PoweredBy_ZF_4LightBG.png" /&gt;
        &lt;/p&gt;

        &lt;p&gt;
            Helpful Links: &lt;br /&gt;
            &lt;a href="http://framework.zend.com/"&gt;Zend Framework Website&lt;/a&gt; |
            &lt;a href="http://framework.zend.com/manual/en/"&gt;Zend Framework
                Manual&lt;/a&gt;
        &lt;/p&gt;
    &lt;/div&gt;
&lt;/div&gt;
</pre>

        <p>
            Le script de vue <code class="filename">error/error.phtml</code> est plus intéréssant car il
            inclut des conditions écrites en <acronym class="acronym">PHP</acronym>:
        </p>

        <pre class="programlisting">
&lt;!-- application/views/scripts/error/error.phtml --&gt;
&lt;!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN";
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd&gt;
&lt;html xmlns="http://www.w3.org/1999/xhtml"&gt;
&lt;head&gt;
  &lt;meta http-equiv="Content-Type" content="text/html; charset=utf-8" /&gt;
  &lt;title&gt;Zend Framework Default Application&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
  &lt;h1&gt;An error occurred&lt;/h1&gt;
  &lt;h2&gt;&lt;?php echo $this-&gt;message ?&gt;&lt;/h2&gt;

  &lt;?php if ('development' == $this-&gt;env): ?&gt;

  &lt;h3&gt;Exception information:&lt;/h3&gt;
  &lt;p&gt;
      &lt;b&gt;Message:&lt;/b&gt; &lt;?php echo $this-&gt;exception-&gt;getMessage() ?&gt;
  &lt;/p&gt;

  &lt;h3&gt;Stack trace:&lt;/h3&gt;
  &lt;pre&gt;&lt;?php echo $this-&gt;exception-&gt;getTraceAsString() ?&gt;
  &lt;/pre&gt;

  &lt;h3&gt;Request Parameters:&lt;/h3&gt;
  &lt;pre&gt;&lt;?php echo var_export($this-&gt;request-&gt;getParams(), 1) ?&gt;
  &lt;/pre&gt;
  &lt;?php endif ?&gt;

&lt;/body&gt;
&lt;/html&gt;
</pre>
    </div>

    <div class="sect2">
<div class="titlepage"><div><div><h3 class="title">
<a name="learning.quickstart.create-project.vhost"></a>Creation d'un hôte virtuel</h3></div></div></div>
        

        <p>
            Pour le quickstart nous supposerons que vous utilisez le <a class="ulink" href="http://httpd.apache.org/" target="_top">serveur web Apacher</a>. Zend Framework fonctionne
                très bien avec d'autres serveurs -- y compris Microsoft Internet Information
            Server, lighttpd, nginx, et plus -- mais la plupart des développeurs devraient être familiers
            à Apache, et cela permet d'introduire la structure de dossiers de Zend Framework et les
            capacités de réécriture.
        </p>

        <p>
            Pour créer un vhost, vous devez connaitre l'emplacement du fichier
            <code class="filename">httpd.conf</code>, et les emplacements des autres fichiers de configuration
            protenciels. Voici quelques emplacements classiques:
        </p>

        <div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; ">
<li class="listitem">
                <p>
                    <code class="filename">/etc/httpd/httpd.conf</code> (Fedora, RHEL, et autres)
                </p>
            </li>
<li class="listitem">
                <p>
                    <code class="filename">/etc/apache2/httpd.conf</code> (Debian, Ubuntu, et autres)
                </p>
            </li>
<li class="listitem">
                <p>
                    <code class="filename">/usr/local/zend/etc/httpd.conf</code> (Zend Server sur *nix)
                </p>
            </li>
<li class="listitem">
                <p>
                    <code class="filename">C:\Program Files\Zend\Apache2\conf</code> (Zend Server sur Windows)
                </p>
            </li>
</ul></div>

        <p>
            Au sein de <code class="filename">httpd.conf</code> (ou <code class="filename">httpd-vhosts.conf</code>
            sur certains systèmes), vous aurez besoin de deux choses. D'abord s'assurer que
            <code class="varname">NameVirtualHost</code> est défini; typiquement à une valeur de "*:80".
            Ensuite, définir les hôtes virtuels:
        </p>

        <pre class="programlisting">
&lt;VirtualHost *:80&gt;
    ServerName quickstart.local
    DocumentRoot /path/to/quickstart/public

    SetEnv APPLICATION_ENV "development"

    &lt;Directory /path/to/quickstart/public&gt;
        DirectoryIndex index.php
        AllowOverride All
        Order allow,deny
        Allow from all
    &lt;/Directory&gt;
&lt;/VirtualHost&gt;
</pre>

        <p>
            Notons plusieurs points. D'abord le <code class="varname">DocumentRoot</code> pointe vers le dossier
            <code class="filename">public</code> du projet; ceci signifie que seuls les fichiers sous cette
            arborescence peuvent être servis directement par le serveur. Ensuite,
            <code class="varname">AllowOverride</code>, <code class="varname">Order</code>, et
            <code class="varname">Allow</code>; ces directives servent à autoriser l'utilisation de fichiers
            <code class="filename">htacess</code> dans le projet. Pendant le développement, c'est une bonne
            pratique car ça évite de redémarrer sans arrêt le serveur dès qu'un changement y est opéré;
            cependant en production le contenu de <code class="filename">htaccess</code> devrait être reproduit
            dans la configuration puis désactivé. Enfin notez <code class="varname">SetEnv</code>. Ici nous
            renseignons une variable d'environnement pour l'hôte virtuel, celle-ci sera récupérée
            dans <code class="filename">index.php</code> et utilisée pour affecter la constante
            <code class="constant">APPLICATION_ENV</code> de l'application Zend Framework. En
            production, vous pouvez oublier cette directive (dans un tel cas la valeur par défaut sera
            "production") ou la préciser explicitement à la valeur "production".
        </p>

        <p>
            Finalement, vous devrez ajouter une entrée au DNS ou au fichier d'hôtes
            (<code class="filename">hosts</code>) pour la valeur de <code class="varname">ServerName</code>. Sur les
            systèmes *nix, il s'agit de <code class="filename">/etc/hosts</code>; sur Windows, vous trouverez
            normalement ce fichier sous <code class="filename">C:\WINDOWS\system32\drivers\etc</code>. Quel que
            soit le système, l'entrée sera de la forme:
        </p>

        <pre class="programlisting">
127.0.0.1 quickstart.local
</pre>

        <p>
            Démarrez votre serveur web (ou redémarrez le), et tout devrait être prêt.
        </p>
    </div>

    <div class="sect2">
<div class="titlepage"><div><div><h3 class="title">
<a name="learning.quickstart.create-project.checkpoint"></a>Checkpoint</h3></div></div></div>
        

        <p>
            Dès lors, vous devriez pouvoir démarrer votre application Zend Framework. Faites pointer votre
            navigateur vers l'hôte configuré dans la section précédente et une page d'accueil devrait
            s'afficher.
        </p>
    </div>
</div>
<div class="navfooter"><table width="100%" summary="Navigation footer">
<tr>
<td width="40%" align="left">
<a accesskey="p" href="learning.quickstart.intro.html">Précédent</a> </td>
<td width="20%" align="center"><a accesskey="u" href="learning.quickstart.html">Niveau supérieur</a></td>
<td width="40%" align="right"> <a accesskey="n" href="learning.quickstart.create-layout.html">Suivant</a>
</td>
</tr>
<tr>
<td width="40%" align="left" valign="top">Zend Framework &amp; Introduction MVC </td>
<td width="20%" align="center"><a accesskey="h" href="index.html">Sommaire</a></td>
<td width="40%" align="right" valign="top"> Créer une layout</td>
</tr>
</table></div>
<div class="revinfo"></div>
</body>
</html>
