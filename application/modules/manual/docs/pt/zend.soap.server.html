<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Zend_Soap_Server</title>
<link rel="stylesheet" type="text/css" href="dbstyle.css">
<meta name="generator" content="DocBook XSL Stylesheets V1.79.2">
<link rel="home" href="index.html" title="Guia de Referência do Programador">
<link rel="up" href="zend.soap.html" title="Zend_Soap">
<link rel="prev" href="zend.soap.html" title="Zend_Soap">
<link rel="next" href="zend.soap.client.html" title="Zend_Soap_Client">
</head>
<body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF">
<div class="navheader"><table width="100%" summary="Navigation header">
<tr><th colspan="3" align="center">Zend_Soap_Server</th></tr>
<tr>
<td width="20%" align="left">
<a accesskey="p" href="zend.soap.html">Anterior</a> </td>
<th width="60%" align="center">Zend_Soap</th>
<td width="20%" align="right"> <a accesskey="n" href="zend.soap.client.html">Próxima</a>
</td>
</tr>
</table></div>
<div class="sect1">
<div class="titlepage"><div><div><h2 class="title" style="clear: both">
<a name="zend.soap.server"></a>Zend_Soap_Server</h2></div></div></div>
    

    <p>
        <code class="classname">Zend_Soap_Server</code> class is intended to simplify Web Services server
        part development for <acronym class="acronym">PHP</acronym> programmers.
    </p>

    <p>
        It may be used in WSDL or non-WSDL mode, and using classes or functions to define Web
        Service <acronym class="acronym">API</acronym>.
    </p>

    <p>
        When <code class="classname">Zend_Soap_Server</code> component works in the WSDL mode, it uses
        already prepared WSDL document to define server object behavior and transport layer options.
    </p>

    <p>
        WSDL document may be auto-generated with functionality provided by <a class="link" href="zend.soap.autodiscovery.html#zend.soap.autodiscovery.introduction" title="AutoDiscovery Introduction">Zend_Soap_AutoDiscovery component</a>
        or should be constructed manually using <a class="link" href="zend.soap.wsdl.html" title="WSDL Accessor"><code class="classname">Zend_Soap_Wsdl</code> class</a> or any other
        <acronym class="acronym">XML</acronym> generating tool.
    </p>

    <p>
        If the non-WSDL mode is used, then all protocol options have to be set using options
        mechanism.
    </p>

    <div class="sect2">
<div class="titlepage"><div><div><h3 class="title">
<a name="zend.soap.server.constructor"></a>Zend_Soap_Server constructor</h3></div></div></div>
        

        <p>
            <code class="classname">Zend_Soap_Server</code> constructor should be used a bit differently for
            WSDL and non-WSDL modes.
        </p>

        <div class="sect3">
<div class="titlepage"><div><div><h4 class="title">
<a name="zend.soap.server.constructor.wsdl_mode"></a>Zend_Soap_Server constructor for the WSDL mode</h4></div></div></div>
            

            <p>
                <code class="classname">Zend_Soap_Server</code> constructor takes two optional parameters
                when it works in WSDL mode:

                </p>
<div class="orderedlist"><ol class="orderedlist" type="1">
<li class="listitem">
                        <p>
                            <code class="varname">$wsdl</code>, which is an <acronym class="acronym">URI</acronym> of a WSDL
                            file

                            <a href="#ftn.idm205655630000" class="footnote" name="idm205655630000"><sup class="footnote">[22]</sup></a>.
                        </p>
                    </li>
<li class="listitem">
                        <p>
                            <code class="varname">$options</code> - options to create <acronym class="acronym">SOAP</acronym>
                            server object

                            <a href="#ftn.idm205655626752" class="footnote" name="idm205655626752"><sup class="footnote">[23]</sup></a>.
                        </p>

                        <p>
                            The following options are recognized in the WSDL mode:

                            </p>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; ">
<li class="listitem">
                                    <p>
                                        'soap_version' ('soapVersion') - soap version to use
                                        (SOAP_1_1 or <acronym class="acronym">SOAP</acronym>_1_2).
                                    </p>
                                </li>
<li class="listitem">
                                    <p>
                                        'actor' - the actor <acronym class="acronym">URI</acronym> for the server.
                                    </p>
                                </li>
<li class="listitem">
                                    <p>
                                        'classmap' ('classMap') which can be used to map some WSDL
                                        types to <acronym class="acronym">PHP</acronym> classes.
                                    </p>

                                    <p>
                                        The option must be an array with WSDL types as keys and
                                        names of <acronym class="acronym">PHP</acronym> classes as values.
                                    </p>
                                </li>
<li class="listitem">
                                    <p>
                                        'encoding' - internal character encoding (UTF-8 is always
                                        used as an external encoding).
                                    </p>
                                </li>
<li class="listitem">
                                    <p>
                                        'wsdl' which is equivalent to
                                        <code class="methodname">setWsdl($wsdlValue)</code> call.
                                    </p>
                                </li>
</ul></div>
<p>
                        </p>
                    </li>
</ol></div>
<p>
            </p>
        </div>

        <div class="sect3">
<div class="titlepage"><div><div><h4 class="title">
<a name="zend.soap.server.wsdl_mode"></a>Zend_Soap_Server constructor for the non-WSDL mode</h4></div></div></div>
            

            <p>
                The first constructor parameter <span class="emphasis"><em>must</em></span> be set to
                <code class="constant">NULL</code> if you plan to use <code class="classname">Zend_Soap_Server</code>
                functionality in non-WSDL mode.
            </p>

            <p>
                You also have to set 'uri' option in this case (see below).
            </p>

            <p>
                The second constructor parameter (<code class="varname">$options</code>) is an array with
                options to create <acronym class="acronym">SOAP</acronym> server object

                <a href="#ftn.idm205655611216" class="footnote" name="idm205655611216"><sup class="footnote">[24]</sup></a>.
            </p>

            <p>
                The following options are recognized in the non-WSDL mode:

                </p>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; ">
<li class="listitem">
                        <p>
                            'soap_version' ('soapVersion') - soap version to use (SOAP_1_1 or
                            <acronym class="acronym">SOAP</acronym>_1_2).
                        </p>
                    </li>
<li class="listitem">
                        <p>
                            'actor' - the actor <acronym class="acronym">URI</acronym> for the server.
                        </p>
                    </li>
<li class="listitem">
                        <p>
                            'classmap' ('classMap') which can be used to map some WSDL types to
                            <acronym class="acronym">PHP</acronym> classes.
                        </p>

                        <p>
                            The option must be an array with WSDL types as keys and names of
                            <acronym class="acronym">PHP</acronym> classes as values.
                        </p>
                    </li>
<li class="listitem">
                        <p>
                            'encoding' - internal character encoding (UTF-8 is always used as an
                            external encoding).
                        </p>
                    </li>
<li class="listitem">
                        <p>
                            'uri' (required) - <acronym class="acronym">URI</acronym> namespace for
                            <acronym class="acronym">SOAP</acronym> server.
                        </p>
                    </li>
</ul></div>
<p>
            </p>
        </div>
    </div>

    <div class="sect2">
<div class="titlepage"><div><div><h3 class="title">
<a name="zend.soap.server.api_define_methods"></a>Methods to define Web Service API</h3></div></div></div>
        

        <p>
            There are two ways to define Web Service <acronym class="acronym">API</acronym> when your want to give
            access to your <acronym class="acronym">PHP</acronym> code through <acronym class="acronym">SOAP</acronym>.
        </p>

        <p>
            The first one is to attach some class to the <code class="classname">Zend_Soap_Server</code>
            object which has to completely describe Web Service <acronym class="acronym">API</acronym>:
        </p>

        <pre class="programlisting">
...
class MyClass {
    /**
     * This method takes ...
     *
     * @param integer $inputParam
     * @return string
     */
    public function method1($inputParam) {
        ...
    }

    /**
     * This method takes ...
     *
     * @param integer $inputParam1
     * @param string  $inputParam2
     * @return float
     */
    public function method2($inputParam1, $inputParam2) {
        ...
    }

    ...
}
...
$server = new Zend_Soap_Server(null, $options);
// Bind Class to Soap Server
$server-&gt;setClass('MyClass');
// Bind already initialized object to Soap Server
$server-&gt;setObject(new MyClass());
...
$server-&gt;handle();
</pre>

        <div class="note"><table border="0" summary="Note: Important!">
<tr>
<td rowspan="2" align="center" valign="top" width="25"><img alt="[Nota]" src="images/note.png"></td>
<th align="left">Important!</th>
</tr>
<tr><td align="left" valign="top">
            

            <p>
                You should completely describe each method using method docblock if you plan to
                use autodiscover functionality to prepare corresponding Web Service WSDL.
            </p>
        </td></tr>
</table></div>

        <p>
            The second method of defining Web Service <acronym class="acronym">API</acronym> is using set of
            functions and <code class="methodname">addFunction()</code> or
            <code class="methodname">loadFunctions()</code> methods:
        </p>

        <pre class="programlisting">
...
/**
 * This function ...
 *
 * @param integer $inputParam
 * @return string
 */
function function1($inputParam) {
    ...
}

/**
 * This function ...
 *
 * @param integer $inputParam1
 * @param string  $inputParam2
 * @return float
 */
function function2($inputParam1, $inputParam2) {
    ...
}
...
$server = new Zend_Soap_Server(null, $options);
$server-&gt;addFunction('function1');
$server-&gt;addFunction('function2');
...
$server-&gt;handle();
</pre>
    </div>

    <div class="sect2">
<div class="titlepage"><div><div><h3 class="title">
<a name="zend.soap.server.request_response"></a>Request and response objects handling</h3></div></div></div>
        

        <div class="note"><table border="0" summary="Note: Advanced">
<tr>
<td rowspan="2" align="center" valign="top" width="25"><img alt="[Nota]" src="images/note.png"></td>
<th align="left">Advanced</th>
</tr>
<tr><td align="left" valign="top">
            

            <p>
                This section describes advanced request/response processing options and may be
                skipped.
            </p>
        </td></tr>
</table></div>

        <p>
            <code class="classname">Zend_Soap_Server</code> component performs request/response processing
            automatically, but allows to catch it and do some pre- and post-processing.
        </p>

        <div class="sect3">
<div class="titlepage"><div><div><h4 class="title">
<a name="zend.soap.server.request_response.request"></a>Request processing</h4></div></div></div>
            

            <p>
                <code class="methodname">Zend_Soap_Server::handle()</code> method takes request from the
                standard input stream ('php://input'). It may be overridden either by supplying
                optional parameter to the <code class="methodname">handle()</code> method or by setting
                request using <code class="methodname">setRequest()</code> method:
            </p>

            <pre class="programlisting">
...
$server = new Zend_Soap_Server(...);
...
// Set request using optional $request parameter
$server-&gt;handle($request);
...
// Set request using setRequest() method
$server-&gt;setRequest();
$server-&gt;handle();
</pre>

            <p>
                Request object may be represented using any of the following:

                </p>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; ">
<li class="listitem">
                        <p>
                            DOMDocument (casted to <acronym class="acronym">XML</acronym>)
                        </p>
                    </li>
<li class="listitem">
                        <p>
                            DOMNode (owner document is grabbed and casted to <acronym class="acronym">XML</acronym>)
                        </p>
                    </li>
<li class="listitem">
                        <p>
                            SimpleXMLElement (casted to <acronym class="acronym">XML</acronym>)
                        </p>
                    </li>
<li class="listitem">
                        <p>
                            stdClass (__toString() is called and verified to be valid
                            <acronym class="acronym">XML</acronym>)
                        </p>
                    </li>
<li class="listitem">
                        <p>
                            string (verified to be valid <acronym class="acronym">XML</acronym>)
                        </p>
                    </li>
</ul></div>
<p>
            </p>

            <p>
                Last processed request may be retrieved using
                <code class="methodname">getLastRequest()</code> method as an <acronym class="acronym">XML</acronym>
                string:
            </p>

            <pre class="programlisting">
...
$server = new Zend_Soap_Server(...);
...
$server-&gt;handle();
$request = $server-&gt;getLastRequest();
</pre>
        </div>

        <div class="sect3">
<div class="titlepage"><div><div><h4 class="title">
<a name="zend.soap.server.request_response.response"></a>Response pre-processing</h4></div></div></div>
            

            <p>
                <code class="methodname">Zend_Soap_Server::handle()</code> method automatically emits
                generated response to the output stream. It may be blocked using
                <code class="methodname">setReturnResponse()</code> with <code class="constant">TRUE</code> or
                <code class="constant">FALSE</code> as a parameter

                <a href="#ftn.idm205655568864" class="footnote" name="idm205655568864"><sup class="footnote">[25]</sup></a>.

                Generated response is returned by <code class="methodname">handle()</code> method in this
                case.
            </p>

            <pre class="programlisting">
...
$server = new Zend_Soap_Server(...);
...
// Get a response as a return value of handle() method
// instead of emitting it to the standard output
$server-&gt;setReturnResponse(true);
...
$response = $server-&gt;handle();
...
</pre>

            <p>
                Last response may be also retrieved by <code class="methodname">getLastResponse()</code>
                method for some post-processing:
            </p>

            <pre class="programlisting">
...
$server = new Zend_Soap_Server(...);
...
$server-&gt;handle();
$response = $server-&gt;getLastResponse();
...
</pre>
        </div>
    </div>
<div class="footnotes">
<br><hr style="width:100; text-align:left;margin-left: 0">
<div id="ftn.idm205655630000" class="footnote">
                                <p><a href="#idm205655630000" class="para"><sup class="para">[22] </sup></a>
                                    May be set later using <code class="methodname">setWsdl($wsdl)</code>
                                    method.
                                </p>
                            </div>
<div id="ftn.idm205655626752" class="footnote">
                                <p><a href="#idm205655626752" class="para"><sup class="para">[23] </sup></a>
                                    Options may be set later using
                                    <code class="methodname">setOptions($options)</code> method.
                                </p>
                            </div>
<div id="ftn.idm205655611216" class="footnote">
                    <p><a href="#idm205655611216" class="para"><sup class="para">[24] </sup></a>
                        Options may be set later using <code class="methodname">setOptions($options)</code>
                        method.
                    </p>
                </div>
<div id="ftn.idm205655568864" class="footnote">
                    <p><a href="#idm205655568864" class="para"><sup class="para">[25] </sup></a>
                        Current state of the Return Response flag may be requested with
                        <code class="methodname">setReturnResponse()</code> method.
                    </p>
                </div>
</div>
</div>
<div class="navfooter"><table width="100%" summary="Navigation footer">
<tr>
<td width="40%" align="left">
<a accesskey="p" href="zend.soap.html">Anterior</a> </td>
<td width="20%" align="center"><a accesskey="u" href="zend.soap.html">Acima</a></td>
<td width="40%" align="right"> <a accesskey="n" href="zend.soap.client.html">Próxima</a>
</td>
</tr>
<tr>
<td width="40%" align="left" valign="top">Zend_Soap </td>
<td width="20%" align="center"><a accesskey="h" href="index.html">Principal</a></td>
<td width="40%" align="right" valign="top"> Zend_Soap_Client</td>
</tr>
</table></div>
<div class="revinfo"></div>
</body>
</html>
