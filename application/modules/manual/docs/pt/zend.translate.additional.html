<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Additional features for translation</title>
<link rel="stylesheet" type="text/css" href="dbstyle.css">
<meta name="generator" content="DocBook XSL Stylesheets V1.79.2">
<link rel="home" href="index.html" title="Guia de Referência do Programador">
<link rel="up" href="zend.translate.html" title="Zend_Translate">
<link rel="prev" href="zend.translate.sourcecreation.html" title="Creating source files">
<link rel="next" href="zend.translate.plurals.html" title="Plural notations for Translation">
</head>
<body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF">
<div class="navheader"><table width="100%" summary="Navigation header">
<tr><th colspan="3" align="center">Additional features for translation</th></tr>
<tr>
<td width="20%" align="left">
<a accesskey="p" href="zend.translate.sourcecreation.html">Anterior</a> </td>
<th width="60%" align="center">Zend_Translate</th>
<td width="20%" align="right"> <a accesskey="n" href="zend.translate.plurals.html">Próxima</a>
</td>
</tr>
</table></div>
<div class="sect1">
<div class="titlepage"><div><div><h2 class="title" style="clear: both">
<a name="zend.translate.additional"></a>Additional features for translation</h2></div></div></div>
    

    <p>
        There are several additional features which are supported by
        <code class="classname">Zend_Translate</code>. Read here for these additional informations.
    </p>

    <div class="sect2">
<div class="titlepage"><div><div><h3 class="title">
<a name="zend.translate.additional.options"></a>Options for adapters</h3></div></div></div>
        

        <p>
            Options can be used with all adapters. Of course the options are different for all
            adapters. You can set options when you create the adapter. Actually there is one option
            which is available to all adapters: '<span class="emphasis"><em>clear</em></span>' sets if translation
            data should be added to existing one or not. Standard behaviour is to add new
            translation data to existing one. But the translation data is only cleared for the
            selected language. So other languages remain untouched.
        </p>

        <p>
            You can set options temporarily by giving them to
            <code class="methodname">addTranslation()</code>. And you can use the method
            <code class="methodname">setOptions()</code> to set options permanent.
        </p>

        <div class="example">
<a name="zend.translate..additional.options.example"></a><p class="title"><b>Exemplo 919. Using translation options</b></p>
<div class="example-contents">
            

            <pre class="programlisting">
// define ':' as separator for the translation source files
$translate = new Zend_Translate(
    array(
        'adapter' =&gt; 'csv',
        'content' =&gt; '/path/to/mytranslation.csv',
        'locale'  =&gt; 'de',
        'delimiter' =&gt; ':'
    )
);

...

// clear the defined language and use new translation data
$translate-&gt;addTranslation(
    array(
        'content' =&gt; '/path/to/new.csv',
        'locale'  =&gt; 'fr',
        'clear'   =&gt; true
    )
);
</pre>
        </div>
</div>
<br class="example-break">

        <p>
            Here you can find all available options for the different adapters with a description
            of their usage:
        </p>

        <div class="table">
<a name="zend.translate.additional.options.alloptions"></a><p class="title"><b>Tabela 168. Options for translation adapters</b></p>
<div class="table-contents">
            

            <table class="table" summary="Options for translation adapters" border="1">
<colgroup>
<col>
<col>
<col>
<col>
</colgroup>
<thead><tr>
<th>Option</th>
<th>Adapter</th>
<th>Description</th>
<th>Default value</th>
</tr></thead>
<tbody>
<tr>
<td>adapter</td>
<td>
<code class="classname">Zend_Translate</code> only</td>
<td>
                            Defines the adapter which will be used for the translation. This option
                            can only be given when a new instance of
                            <code class="classname">Zend_Translate</code> is created. When it is set
                            afterwards, then it will be ignored
                        </td>
<td><span class="emphasis"><em>Must be set as it has no default value</em></span></td>
</tr>
<tr>
<td>clear</td>
<td>all</td>
<td>
                            If set to <code class="constant">TRUE</code>, the already read translations will
                            be cleared. This can be used instead of creating a new instance when
                            reading new translation data
                        </td>
<td><span class="emphasis"><em><code class="constant">FALSE</code></em></span></td>
</tr>
<tr>
<td>cache</td>
<td>all</td>
<td>
                            Sets a cache for the translation adapter. This must be a instance of
                            <code class="classname">Zend_Cache_Core</code>
                        </td>
<td>
                            <span class="emphasis"><em>Per default no cache is set</em></span>
                        </td>
</tr>
<tr>
<td>content</td>
<td>all</td>
<td>
                            Sets the content for the translation adapter. This could be an array,
                            a filename or a directory. Which type of content is supported depends
                            on the used adapter
                        </td>
<td>
                            <span class="emphasis"><em>The default value depends on the used adapter</em></span>
                        </td>
</tr>
<tr>
<td>disableNotices</td>
<td>all</td>
<td>
                            If set to <code class="constant">TRUE</code>, all notices regarding not available
                            translations will be disabled. You should set this option to
                            <code class="constant">TRUE</code> in production environment
                        </td>
<td><span class="emphasis"><em><code class="constant">FALSE</code></em></span></td>
</tr>
<tr>
<td>ignore</td>
<td>all</td>
<td>
                            All directories and files beginning with this prefix will be ignored
                            when searching for files. This value defaults to
                            <span class="emphasis"><em>'.'</em></span> which leads to the behavior that all hidden
                            files will be ignored. Setting this value to <span class="emphasis"><em>'tmp'</em></span>
                            would mean that directories and files like 'tmpImages' and
                            'tmpFiles' would be ignored as well as all subsequent
                            directories. This option also accepts an array which can be used when
                            you want to ignore more than one prefix.
                        </td>
<td><span class="emphasis"><em>.</em></span></td>
</tr>
<tr>
<td>log</td>
<td>all</td>
<td>
                            An instance of <code class="classname">Zend_Log</code> where untranslated
                            messages and notices will be written to
                        </td>
<td><span class="emphasis"><em><code class="constant">NULL</code></em></span></td>
</tr>
<tr>
<td>logMessage</td>
<td>all</td>
<td>The message which will be written into the log</td>
<td>
                            <span class="emphasis"><em>Untranslated message within '%locale%': %message%</em></span>
                        </td>
</tr>
<tr>
<td>logPriority</td>
<td>all</td>
<td>The priority which is used to write the message into the log</td>
<td>
                            <span class="emphasis"><em>5</em></span>
                        </td>
</tr>
<tr>
<td>logUntranslated</td>
<td>all</td>
<td>
                            When this option is set to <code class="constant">TRUE</code>, all message IDs
                            which can not be translated will be written into the attached log
                        </td>
<td><span class="emphasis"><em><code class="constant">FALSE</code></em></span></td>
</tr>
<tr>
<td>reload</td>
<td>all</td>
<td>
                            When this option is set to <code class="constant">TRUE</code>, then files are
                            reloaded into the cache. This option can be used to recreate the cache,
                            or to add translations to already cached data after the cache has
                            already been created.
                        </td>
<td><span class="emphasis"><em><code class="constant">FALSE</code></em></span></td>
</tr>
<tr>
<td>route</td>
<td>all</td>
<td>
                            This option allows to use reroute from non existing translations to
                            other languages. See the <a class="link" href="zend.translate.additional.html#zend.translate.additional.rerouting" title="Routing for translations">Rerouting
                                Section</a> for details about this option.
                        </td>
<td><span class="emphasis"><em><code class="constant">NULL</code></em></span></td>
</tr>
<tr>
<td>scan</td>
<td>all</td>
<td>
                            If set to <code class="constant">NULL</code>, no scanning of the directory
                            structure will be done. If set to
                            <code class="constant">Zend_Translate::LOCALE_DIRECTORY</code> the
                            locale will be detected within the directory. If set to
                            <code class="constant">Zend_Translate::LOCALE_FILENAME</code> the locale will
                            be detected within the filename. See <a class="link" href="zend.translate.additional.html#zend.translate.additional.detection" title="Automatic source detection">this chapter</a>
                            for details
                        </td>
<td><span class="emphasis"><em><code class="constant">NULL</code></em></span></td>
</tr>
<tr>
<td>tag</td>
<td>all</td>
<td>
                            Sets an individual tag which is used for the attached cache. Using this
                            option allows to use and clear the cache for single instances. When this
                            option is not set, the attached cache is used for all instances combined
                        </td>
<td><span class="emphasis"><em><code class="classname">Zend_Translate</code></em></span></td>
</tr>
<tr>
<td>delimiter</td>
<td>Csv</td>
<td>
                            Defines which sign is used as delimiter for separating source and
                            translation
                        </td>
<td><span class="emphasis"><em>;</em></span></td>
</tr>
<tr>
<td>enclosure</td>
<td>Csv</td>
<td>
                            Defines the enclosure character to be used. Defaults to a doublequote
                        </td>
<td><span class="emphasis"><em>"</em></span></td>
</tr>
<tr>
<td>length</td>
<td>Csv</td>
<td>
                            Defines the maximum length of a csv line. When set to 0 it will be
                            detected automatically
                        </td>
<td><span class="emphasis"><em>0</em></span></td>
</tr>
<tr>
<td>useId</td>
<td>Xliff and Tmx</td>
<td>
                            If you set this option to <code class="constant">FALSE</code>, then the source
                            string will be used as message Id. The default for this option is
                            <code class="constant">TRUE</code>, which means that the Id from the trans-unit
                            element will be used as message Id
                        </td>
<td><span class="emphasis"><em><code class="constant">TRUE</code></em></span></td>
</tr>
</tbody>
</table>
        </div>
</div>
<br class="table-break">

        <p>
            When you want to have self defined options, you are also able to use them within all
            adapters. The <code class="methodname">setOptions()</code> method can be used to define your
            option. <code class="methodname">setOptions()</code> needs an array with the options you want
            to set. If an given option exists it will be signed over. You can define as much options
            as needed as they will not be checked by the adapter. Just make sure not to overwrite
            any existing option which is used by an adapter.
        </p>

        <p>
            To return the option you can use the <code class="methodname">getOptions()</code> method. When
            <code class="methodname">getOptions()</code> is called without a parameter it will return all
            options set. When the optional parameter is given you will only get the specified
            option.
        </p>
    </div>

    <div class="sect2">
<div class="titlepage"><div><div><h3 class="title">
<a name="zend.translate.additional.languages"></a>Handling languages</h3></div></div></div>
        

        <p>
            When working with different languages there are a few methods which will be useful.
        </p>

        <p>
            The <code class="methodname">getLocale()</code> method can be used to get the currently set
            language. It can either hold an instance of <code class="classname">Zend_Locale</code> or the
            identifier of a locale.
        </p>

        <p>
            The <code class="methodname">setLocale()</code> method sets a new standard language for
            translation. This prevents the need of setting the optional language parameter more than
            once to the <code class="methodname">translate()</code> method. If the given language does not
            exist, or no translation data is available for the language,
            <code class="methodname">setLocale()</code> tries to downgrade to the language without the
            region if any was given. A language of <span class="emphasis"><em>en_US</em></span> would be downgraded to
            <span class="emphasis"><em>en</em></span>. When even the downgraded language can not be found an exception
            will be thrown.
        </p>

        <p>
            The <code class="methodname">isAvailable()</code> method checks if a given language is already
            available. It returns <code class="constant">TRUE</code> if data for the given language exist.
        </p>

        <p>
            And finally the <code class="methodname">getList()</code> method can be used to get all
            currently set languages for an adapter returned as array.
        </p>

        <div class="example">
<a name="zend.translate.additional.languages.example"></a><p class="title"><b>Exemplo 920. Handling languages with adapters</b></p>
<div class="example-contents">
            

            <pre class="programlisting">
// returns the currently set language
$actual = $translate-&gt;getLocale();

// you can use the optional parameter while translating
echo $translate-&gt;_("my_text", "fr");
// or set a new language
$translate-&gt;setLocale("fr");
echo $translate-&gt;_("my_text");
// refer to the base language
// fr_CH will be downgraded to fr
$translate-&gt;setLocale("fr_CH");
echo $translate-&gt;_("my_text");

// check if this language exist
if ($translate-&gt;isAvailable("fr")) {
    // language exists
}
</pre>
        </div>
</div>
<br class="example-break">

        <div class="sect3">
<div class="titlepage"><div><div><h4 class="title">
<a name="zend.translate.additional.languages.automatic"></a>Automatical handling of languages</h4></div></div></div>
            

            <p>
                Note that as long as you only add new translation sources with the
                <code class="methodname">addTranslation()</code> method
                <code class="classname">Zend_Translate</code> will automatically set the best fitting
                language for your environment when you use one of the automatic locales which are
                '<span class="emphasis"><em>auto</em></span>' or '<span class="emphasis"><em>browser</em></span>'. So normally you will
                not need to call <code class="methodname">setLocale()</code>. This should only be used in
                conjunction with automatic source detection.
            </p>

            <p>
                The algorithm will search for the best fitting locale depending on the user's
                browser and your environment. See the following example for details:
            </p>

            <div class="example">
<a name="zend.translate.additional.languages.automatic.example"></a><p class="title"><b>Exemplo 921. Automatically language detection</b></p>
<div class="example-contents">
                

                <pre class="programlisting">
// Let's expect the browser returns these language settings:
// HTTP_ACCEPT_LANGUAGE = "de_AT=1;fr=1;en_US=0.8";

// Example 1:
// When no fitting language is found, the message ID is returned
$translate = new Zend_Translate(
    array(
        'adapter' =&gt; 'gettext',
        'content' =&gt; 'my_it.mo',
        'locale'  =&gt; 'auto',
        'scan' =&gt; Zend_Translate::LOCALE_FILENAME
    )
);

// Example 2:
// Best found fitting language is 'fr'
$translate = new Zend_Translate(
    array(
        'adapter' =&gt; 'gettext',
        'content' =&gt; 'my_fr.mo',
        'locale'  =&gt; 'auto',
        'scan' =&gt; Zend_Translate::LOCALE_FILENAME
    )
);

// Example 3:
// Best found fitting language is 'de' ('de_AT' will be degraded)
$translate = new Zend_Translate(
    array(
        'adapter' =&gt; 'gettext',
        'content' =&gt; 'my_de.mo',
        'locale'  =&gt; 'auto',
        'scan' =&gt; Zend_Translate::LOCALE_FILENAME
    )
);

// Example 4:
// Returns 'it' as translation source and overrides the automatic settings
$translate = new Zend_Translate(
    array(
        'adapter' =&gt; 'gettext',
        'content' =&gt; 'my_it.mo',
        'locale'  =&gt; 'auto',
        'scan' =&gt; Zend_Translate::LOCALE_FILENAME
    )
);

$translate-&gt;addTranslation(array('content' =&gt; 'my_ru.mo', 'locale' =&gt; 'ru'));
$translate-&gt;setLocale('it_IT');
</pre>
            </div>
</div>
<br class="example-break">

            <p>
                After setting a language manually with the <code class="methodname">setLocale()</code>
                method the automatic detection will be switched off and overridden.
            </p>

            <p>
                If you want to use it again, you can set the language
                <span class="emphasis"><em>auto</em></span> with <code class="methodname">setLocale()</code> which will
                reactivate the automatic detection for <code class="classname">Zend_Translate</code>.
            </p>

            <p>
                Since Zend Framework 1.7.0 <code class="classname">Zend_Translate</code> also recognises an
                application wide locale. You can simply set a <code class="classname">Zend_Locale</code>
                instance to the registry like shown below. With this notation you can forget about
                setting the locale manually with each instance when you want to use the same locale
                multiple times.
            </p>

            <pre class="programlisting">
// in your bootstrap file
$locale = new Zend_Locale();
Zend_Registry::set('Zend_Locale', $locale);

// default language when requested language is not available
$defaultlanguage = 'en';

// somewhere in your application
$translate = new Zend_Translate(
    array('adapter' =&gt; 'gettext', 'content' =&gt; 'my_de.mo')
);

if (!$translate-&gt;isAvailable($locale-&gt;getLanguage())) {
    // not available languages are rerouted to another language
    $translate-&gt;setLocale($defaultlanguage);
}

$translate-&gt;getLocale();
</pre>
        </div>

        <div class="sect3">
<div class="titlepage"><div><div><h4 class="title">
<a name="zend.translate.additional.languages.territory"></a>Using a country as language</h4></div></div></div>
            

            <p>
                You can also use a country as locale parameter. This could be useful when you
                provide your user with flags, which represent the country in which he lives, and
                when he selects his flag, he would automatically get the default language for this
                country.
            </p>

            <p>
                For example, when the user selected <span class="emphasis"><em>US</em></span> then you would get
                <span class="emphasis"><em>en_US</em></span> in return as locale which is being used. This leads
                automatically to the language <span class="emphasis"><em>en</em></span> which is the default language
                for the country <span class="emphasis"><em>US</em></span>.
            </p>

            <pre class="programlisting">
$translate = new Zend_Translate(
    array(
        'adapter' =&gt; 'gettext',
        'content' =&gt; 'my_de.mo',
        'locale'  =&gt; 'US'
    )
);
</pre>

            <div class="note"><table border="0" summary="Note: Always uppercase countries">
<tr>
<td rowspan="2" align="center" valign="top" width="25"><img alt="[Nota]" src="images/note.png"></td>
<th align="left">Always uppercase countries</th>
</tr>
<tr><td align="left" valign="top">
                

                <p>
                    Using this syntax you should always uppercase the input when you know that it's
                    a country. The reason is that there are also languages which have the same
                    letters as a country. Take for example <span class="emphasis"><em>om</em></span>. You could expect
                    to get <span class="emphasis"><em>ar_OM</em></span> when you mean the country "Oman", or you could
                    expect the language "Oromo" which is spoken in Kenia for example.
                </p>

                <p>
                    As <code class="classname">Zend_Translate</code> is related to languages it will always
                    use the language in this case. Therefor always uppercase the locale when you
                    want it to be recognised as country.
                </p>
            </td></tr>
</table></div>
        </div>
    </div>

    <div class="sect2">
<div class="titlepage"><div><div><h3 class="title">
<a name="zend.translate.additional.detection"></a>Automatic source detection</h3></div></div></div>
        

        <p>
            <code class="classname">Zend_Translate</code> can detect translation sources automatically. So
            you don't have to declare each source file manually. You can let
            <code class="classname">Zend_Translate</code> do this job and scan the complete directory
            structure for source files.
        </p>

        <div class="note"><table border="0" summary="Note">
<tr>
<td rowspan="2" align="center" valign="top" width="25"><img alt="[Nota]" src="images/note.png"></td>
<th align="left">Nota</th>
</tr>
<tr><td align="left" valign="top">
            <p>
                Automatic source detection is available since Zend Framework version 1.5 .
            </p>
        </td></tr>
</table></div>

        <p>
            The usage is quite the same as initiating a single translation source with one
            difference. You must give a directory which has to be scanned instead a file.
        </p>

        <div class="example">
<a name="zend.translate.additional.languages.directory.example"></a><p class="title"><b>Exemplo 922. Scanning a directory structure for sources</b></p>
<div class="example-contents">
            

            <pre class="programlisting">
// assuming we have the following structure
//  /language/
//  /language/login/login.tmx
//  /language/logout/logout.tmx
//  /language/error/loginerror.tmx
//  /language/error/logouterror.tmx

$translate = new Zend_Translate(
    array('adapter' =&gt; 'tmx', 'content' =&gt; '/language')
);
</pre>
        </div>
</div>
<br class="example-break">

        <p>
            So <code class="classname">Zend_Translate</code> does not only search the given directory, but
            also all subdirectories for translation source files. This makes the usage quite
            simple. But <code class="classname">Zend_Translate</code> will ignore all files which are not
            sources or which produce failures while reading the translation data. So you have to
            make sure that all of your translation sources are correct and readable because you
            will not get any failure if a file is bogus or can not be read.
        </p>

        <div class="note"><table border="0" summary="Note">
<tr>
<td rowspan="2" align="center" valign="top" width="25"><img alt="[Nota]" src="images/note.png"></td>
<th align="left">Nota</th>
</tr>
<tr><td align="left" valign="top">
            <p>
                Depending on how deep your directory structure is and how much files are within
                this structure it can take a long time for <code class="classname">Zend_Translate</code>
                to complete.
            </p>
        </td></tr>
</table></div>

        <p>
            In our example we have used the <acronym class="acronym">TMX</acronym> format which includes the
            language to be used within the source. But many of the other source formats are not
            able to include the language within the file. Even this sources can be used with
            automatic scanning if you do some pre-requisits as described below:
        </p>

        <div class="sect3">
<div class="titlepage"><div><div><h4 class="title">
<a name="zend.translate.additional.detection.directory"></a>Language through naming directories</h4></div></div></div>
            

            <p>
                One way to include automatic language detection is to name the directories related
                to the language which is used for the sources within this directory. This is the
                easiest way and is used for example within standard gettext implementations.
            </p>

            <p>
                <code class="classname">Zend_Translate</code> needs the '<span class="property">scan</span>' option
                to know that it should search the names of all directories for languages. See the
                following example for details:
            </p>

            <div class="example">
<a name="zend.translate.additional.detection.directory.example"></a><p class="title"><b>Exemplo 923. Directory scanning for languages</b></p>
<div class="example-contents">
                

                <pre class="programlisting">
// assuming we have the following structure
//  /language/
//  /language/de/login/login.mo
//  /language/de/error/loginerror.mo
//  /language/en/login/login.mo
//  /language/en/error/loginerror.mo

$translate = new Zend_Translate(
    array(
        'adapter' =&gt; 'gettext',
        'content' =&gt; '/language',
        'scan' =&gt; Zend_Translate::LOCALE_DIRECTORY
    )
);
</pre>
            </div>
</div>
<br class="example-break">

            <div class="note"><table border="0" summary="Note">
<tr>
<td rowspan="2" align="center" valign="top" width="25"><img alt="[Nota]" src="images/note.png"></td>
<th align="left">Nota</th>
</tr>
<tr><td align="left" valign="top">
                <p>
                    This works only for adapters which do not include the language within the
                    source file. Using this option for example with <acronym class="acronym">TMX</acronym> will be
                    ignored. Also language definitions within the filename will be ignored when
                    using this option.
                </p>
            </td></tr>
</table></div>

            <div class="note"><table border="0" summary="Note">
<tr>
<td rowspan="2" align="center" valign="top" width="25"><img alt="[Nota]" src="images/note.png"></td>
<th align="left">Nota</th>
</tr>
<tr><td align="left" valign="top">
                <p>
                    You should be aware if you have several subdirectories under the same
                    structure. Assuming we have a structure like
                    <code class="filename">/language/module/de/en/file.mo</code>. In this case the path
                    contains multiple strings which would be detected as locale. It could be either
                    <span class="emphasis"><em>de</em></span> or <span class="emphasis"><em>en</em></span>. In such a case the behaviour
                    is undefined and it is recommended to use file detection in such situations.
                </p>
            </td></tr>
</table></div>
        </div>

        <div class="sect3">
<div class="titlepage"><div><div><h4 class="title">
<a name="zend.translate.additional.detection.filename"></a>Language through filenames</h4></div></div></div>
            

            <p>
                Another way to detect the language automatically is to use special filenames. You
                can either name the complete file or parts of a file after the used language. To
                use this way of detection you will have to set the '<span class="property">scan</span>'
                option at initiation. There are several ways of naming the sourcefiles which are
                described below:
            </p>

            <div class="example">
<a name="zend.translate.additional.detection.filename.example"></a><p class="title"><b>Exemplo 924. Filename scanning for languages</b></p>
<div class="example-contents">
                

                <pre class="programlisting">
// assuming we have the following structure
//  /language/
//  /language/login/login_en.mo
//  /language/login/login_de.mo
//  /language/error/loginerror_en.mo
//  /language/error/loginerror_de.mo

$translate = new Zend_Translate(
    array(
        'adapter' =&gt; 'gettext',
        'content' =&gt; '/language',
        'scan' =&gt; Zend_Translate::LOCALE_FILENAME
    )
);
</pre>
            </div>
</div>
<br class="example-break">

            <div class="sect4">
<div class="titlepage"><div><div><h5 class="title">
<a name="zend.translate.additional.detection.filename.complete"></a>Complete filename</h5></div></div></div>
                

                <p>
                    Having the whole file named after the language is the simplest way but only
                    viable if you have only one file per language.
                </p>

                <pre class="programlisting">
/languages/
/languages/en.mo
/languages/de.mo
/languages/es.mo
</pre>
            </div>

            <div class="sect4">
<div class="titlepage"><div><div><h5 class="title">
<a name="zend.translate.additional.detection.filename.extension"></a>Extension of the file</h5></div></div></div>
                

                <p>
                    Another simple way to use the extension of the file for language detection.
                    But this may be confusing since you will no longer have an idea which extension
                    the file originally had.
                </p>

                <pre class="programlisting">
/languages/
/languages/view.en
/languages/view.de
/languages/view.es
</pre>
            </div>

            <div class="sect4">
<div class="titlepage"><div><div><h5 class="title">
<a name="zend.translate.additional.detection.filename.token"></a>Filename tokens</h5></div></div></div>
                

                <p>
                    <code class="classname">Zend_Translate</code> is also capable of detecting the language
                    if it is included within the filename. But if you go this way you will have to
                    separate the language with a token. There are three supported tokens which can
                    be used: a dot '.', an underscore '_', or a hyphen '-'.
                </p>

                <pre class="programlisting">
/languages/
/languages/view_en.mo -&gt; detects english
/languages/view_de.mo -&gt; detects german
/languages/view_it.mo -&gt; detects italian
</pre>

                <p>
                    The first found string delimited by a token which can be interpreted as a
                    locale will be used. See the following example for details.
                </p>

                <pre class="programlisting">
/languages/
/languages/view_en_de.mo -&gt; detects english
/languages/view_en_es.mo -&gt; detects english and overwrites the first file
/languages/view_it_it.mo -&gt; detects italian
</pre>

                <p>
                    All three tokens are used to detect the locale. When the filename contains
                    multiple tokens, the first found token depends on the order of the tokens
                    which are used. See the following example for details.
                </p>

                <pre class="programlisting">
/languages/
/languages/view_en-it.mo -&gt; detects english because '_' will be used before '-'
/languages/view-en_it.mo -&gt; detects italian because '_' will be used before '-'
/languages/view_en.it.mo -&gt; detects italian because '.' will be used before '_'
</pre>
            </div>
        </div>

        <div class="sect3">
<div class="titlepage"><div><div><h4 class="title">
<a name="zend.translate.additional.detection.ignore"></a>Ignoring special files and directories</h4></div></div></div>
            

            <p>
                Sometimes it is useful to exclude files or even directories from being added
                automatically. Therefor you can use the <span class="property">ignore</span> option which
                accepts 3 possible usages.
            </p>

            <div class="sect4">
<div class="titlepage"><div><div><h5 class="title">
<a name="zend.translate.additional.detection.ignore.string"></a>Ignore a special directory or file</h5></div></div></div>
                

                <p>
                    Per default <code class="classname">Zend_Translate</code> is set to ignore all
                    files and directories beginning with
                    <span class="emphasis"><em>'<code class="filename">/.</code>'</em></span>. This means that
                    all <acronym class="acronym">SVN</acronym> files will be ignored.
                </p>

                <p>
                    You can set your own syntax by giving a string for the
                    <span class="property">ignore</span> option. The directory separator will be attached
                    automatically and has to be omitted.
                </p>

                <pre class="programlisting">
$options   = array('ignore' =&gt; 'test');
$translate = new Zend_Translate(
    array(
        'adapter' =&gt; $adapter,
        'content' =&gt; $content,
        'locale'  =&gt; $locale,
        'ignore'  =&gt; 'test'
    )
);
</pre>

                <p>
                    The above example will ignore all files and directories beginning with
                    <span class="emphasis"><em>test</em></span>. This means for example
                    <code class="filename">/test/en.mo</code>, <code class="filename">/testing/en.mo</code> and
                    <code class="filename">/dir/test_en.mo</code>. But it would still add
                    <code class="filename">/mytest/en.mo</code> or <code class="filename">/dir/atest.mo</code>.
                </p>

                <div class="note"><table border="0" summary="Note: Prevent SVN files from being searched">
<tr>
<td rowspan="2" align="center" valign="top" width="25"><img alt="[Nota]" src="images/note.png"></td>
<th align="left">Prevent SVN files from being searched</th>
</tr>
<tr><td align="left" valign="top">
                    

                    <p>
                        When you set this option, then the default
                        <span class="emphasis"><em>'<code class="filename">/.</code>'</em></span> will
                        be erased. This means that <code class="classname">Zend_Translate</code> will then
                        add all files from the hidden <acronym class="acronym">SVN</acronym> directories. When you
                        are working with <acronym class="acronym">SVN</acronym>, then you should use the array
                        syntax described in the next section.
                    </p>
                </td></tr>
</table></div>
            </div>

            <div class="sect4">
<div class="titlepage"><div><div><h5 class="title">
<a name="zend.translate.additional.detection.ignore.array.files"></a>Ignore several directories or files</h5></div></div></div>
                

                <p>
                    You can also ignore several files and directories. Instead of a string,
                    you can simply give an array with all wished names which will be ignored.
                </p>

                <pre class="programlisting">
$options = array('ignore' =&gt; array('.', 'test', 'old'));
$translate = new Zend_Translate(
    array(
        'adapter' =&gt; $adapter,
        'content' =&gt; $content,
        'locale'  =&gt; $locale,
        'ignore'  =&gt; array('.', 'test', 'old')
    )
);
</pre>

                <p>
                    In the above case all 3 syntax will be ignored. But still they have to
                    begin with the syntax to be detected and ignored.
                </p>
            </div>

            <div class="sect4">
<div class="titlepage"><div><div><h5 class="title">
<a name="zend.translate.additional.detection.ignore.array.names"></a>Ignore specific names</h5></div></div></div>
                

                <p>
                    To ignore files and directories which are not beginning with a defined syntax
                    but have a special syntax anywhere within their name you can use a regular
                    expression.
                </p>

                <p>
                    To use a regular expression the array key of the <span class="property">ignore</span>
                    option has to begin with <span class="emphasis"><em>regex</em></span>.
                </p>

                <pre class="programlisting">
$options = array(
    'ignore' =&gt; array(
        'regex' =&gt; '/test/u',
        'regex_2' =&gt; '/deleted$/u'
    )
);
$translate = new Zend_Translate(
    array(
        'adapter' =&gt; $adapter,
        'content' =&gt; $content,
        'locale'  =&gt; $locale,
        'ignore'  =&gt; array('regex' =&gt; '/test/u', 'regex_2' =&gt; '/deleted$/u')
    )
);
</pre>

                <p>
                    In the above case we defined 2 regular expressions. The files and directories
                    will always being searched with all given regular expressions. In our example
                    this means that any files which contains <span class="emphasis"><em>test</em></span> anywhere in
                    their name will be ignored. Additionally all files and directories which end
                    with <span class="emphasis"><em>deleted</em></span> will not be added as translation.
                </p>
            </div>
        </div>
    </div>

    <div class="sect2">
<div class="titlepage"><div><div><h3 class="title">
<a name="zend.translate.additional.rerouting"></a>Routing for translations</h3></div></div></div>
        

        <p>
            Not every message ID can be translated. But sometimes is can be useful to output the
            translation from another language instead of returning the message ID itself. You can
            archive this by using the <span class="property">route</span> option.
        </p>

        <p>
            You can add one route for every language. See the following example:
        </p>

        <pre class="programlisting">
$translate = new Zend_Translate(
    array(
        'adapter' =&gt; $adapter,
        'content' =&gt; $content,
        'locale'  =&gt; $locale,
        'route'   =&gt; array('fr' =&gt; 'en', 'de' =&gt; 'fr')
    )
);
</pre>

        <p>
            The above returns a english translation for all messages which can not be translated to
            french. And it returns a french translation for all messages which can not be translated
            to german. It will even return an english translation for all messages which can wether
            be translated to german nor to french. So you can even define a complete translation
            chain.
        </p>

        <p>
            This feature seems ot be interesting for anyone. But be aware that returning
            translations for wrong or other languages can be problematic when the user does not
            understand this language. So you should always use this feature sparingly.
        </p>
    </div>

    <div class="sect2">
<div class="titlepage"><div><div><h3 class="title">
<a name="zend.translate.additional.combination"></a>Combining multiple translation sources</h3></div></div></div>
        

        <p>
            When you are working with multiple translations you may come into a situation where you
            want to use different source types. For example the resource files which are provided
            by the framework and your own translations which are available by using the gettext
            adapter.
        </p>

        <p>
            By combining multiple translation adapters you can use them within one instance. See
            the following example:
        </p>

        <pre class="programlisting">
$translate = new Zend_Translate(
    array(
        'adapter' =&gt; 'gettext',
        'content' =&gt; '\path\to\translation.mo',
        'locale'  =&gt; 'en'
    )
);

$translate_second = new Zend_Translate(
    array(
        'adapter' =&gt; 'array',
        'content' =&gt; '\resources\languages\en\Zend_Validate.php',
        'locale'  =&gt; 'en'
    )
);

$translate-&gt;addTranslation(array('content' =&gt; $translate_second));
</pre>

        <p>
            Now the first instance holds all translations from the second instance and you can use
            it within the application even if you used different source types.
        </p>

        <div class="note"><table border="0" summary="Note: Memory savings">
<tr>
<td rowspan="2" align="center" valign="top" width="25"><img alt="[Nota]" src="images/note.png"></td>
<th align="left">Memory savings</th>
</tr>
<tr><td align="left" valign="top">
            

            <p>
                As you may have noted the second instance is no longer used as soon as it has been
                added to the first instance. To save some memory you may want to unset it.
            </p>
        </td></tr>
</table></div>

        <p>
            When you are scanning for directories you may additionally want to use only one defined
            language. The predefined resources for example are available in more than 10 languages.
            But your application is not available in all of those language. Therefor you can also
            add only one language from the second adapter.
        </p>

        <pre class="programlisting">
$translate-&gt;addTranslation(
    array(
        'content' =&gt; $translate_second,
        'locale'  =&gt; 'en'
    )
);
</pre>

        <p>
            This allows you still to scan through the directories and still add only those languages
            which are relevant for your application.
        </p>
    </div>

    <div class="sect2">
<div class="titlepage"><div><div><h3 class="title">
<a name="zend.translate.additional.istranslated"></a>Checking for translations</h3></div></div></div>
        

        <p>
            Normally text will be translated without any computation. But sometimes it is necessary
            to know if a text is translated or not, therefor the
            <code class="methodname">isTranslated()</code> method can be used.
        </p>

        <p>
            <code class="methodname">isTranslated($messageId, $original = false, $locale = null)</code>
            takes the text you want to check as its first parameter, and as optional third parameter
            the locale for which you want to do the check. The optional second parameter declares
            whether translation is fixed to the declared language or a lower set of translations
            can be used. If you have a text which can be returned for 'en' but not for 'en_US' you
            will normally get the translation returned, but by setting <code class="varname">$original</code>
            to <code class="constant">TRUE</code>, <code class="methodname">isTranslated()</code> will return
            <code class="constant">FALSE</code>.
        </p>

        <div class="example">
<a name="zend.translate.additional.istranslated.example"></a><p class="title"><b>Exemplo 925. Checking if a text is translatable</b></p>
<div class="example-contents">
            

            <pre class="programlisting">
$english = array(
    'message1' =&gt; 'Nachricht 1',
    'message2' =&gt; 'Nachricht 2',
    'message3' =&gt; 'Nachricht 3');

$translate = new Zend_Translate(
    array(
        'adapter' =&gt; 'array',
        'content' =&gt; $english,
        'locale' =&gt; 'de_AT'
    )
);

if ($translate-&gt;isTranslated('message1')) {
    print "'message1' can be translated";
}

if (!($translate-&gt;isTranslated('message1', true, 'de'))) {
    print "'message1' can not be translated to 'de'"
        . " as it's available only in 'de_AT'";
}

if ($translate-&gt;isTranslated('message1', false, 'de')) {
    print "'message1' can be translated in 'de_AT' as it falls back to 'de'";
}
</pre>
        </div>
</div>
<br class="example-break">
    </div>

    <div class="sect2">
<div class="titlepage"><div><div><h3 class="title">
<a name="zend.translate.additional.logging"></a>How to log not found translations</h3></div></div></div>
        

        <p>
            When you have a bigger site or you are creating the translation files manually, you
            often have the problem that some messages are not translated. But there is an easy
            solution for you when you are using <code class="classname">Zend_Translate</code>.
        </p>

        <p>
            You have to follow two or three simple steps. First, you have to create an instance of
            <code class="classname">Zend_Log</code>. Then you have to attach this instance to
            <code class="classname">Zend_Translate</code>. See the following example:
        </p>

        <div class="example">
<a name="zend.translate.additional.logging.example"></a><p class="title"><b>Exemplo 926. Log translations</b></p>
<div class="example-contents">
            

            <pre class="programlisting">
$translate = new Zend_Translate(
    array(
        'adapter' =&gt; 'gettext',
        'content' =&gt; $path,
        'locale' =&gt; 'de'
    )
);

// Create a log instance
$writer = new Zend_Log_Writer_Stream('/path/to/file.log');
$log    = new Zend_Log($writer);

// Attach it to the translation instance
$translate-&gt;setOptions(
    array(
        'log'             =&gt; $log,
        'logUntranslated' =&gt; true
    )
);

$translate-&gt;translate('unknown string');
</pre>
        </div>
</div>
<br class="example-break">

        <p>
            Now you will have a new notice in the log:
            <span class="emphasis"><em>Untranslated message within 'de': unknown string</em></span>.
        </p>

        <div class="note"><table border="0" summary="Note">
<tr>
<td rowspan="2" align="center" valign="top" width="25"><img alt="[Nota]" src="images/note.png"></td>
<th align="left">Nota</th>
</tr>
<tr><td align="left" valign="top">
            <p>
                You should note that any translation which can not be found will be logged. This
                means all translations when a user requests a language which is not supported. Also
                every request for a message which can not be translated will be logged. Be aware,
                that 100 people requesting the same translation, will result 100 logged notices.
            </p>
        </td></tr>
</table></div>

        <p>
            This feature can not only be used to log messages but also to attach this untranslated
            messages into an empty translation file. To do so you will have to write your own log
            writer which writes the format you want to have and strips the prepending "Untranslated
            message".
        </p>

        <p>
            You can also set the '<span class="property">logMessage</span>' option when you want to have your
            own log message. Use the '<span class="emphasis"><em>%message%</em></span>' token for placing the
            messageId within your log message, and the '<span class="emphasis"><em>%locale%</em></span>' token for the
            requested locale. See the following example for a self defined log message:
        </p>

        <div class="example">
<a name="zend.translate.additional.logging.example2"></a><p class="title"><b>Exemplo 927. Self defined log messages</b></p>
<div class="example-contents">
            

            <pre class="programlisting">
$translate = new Zend_Translate(
    array(
        'adapter' =&gt; 'gettext',
        'content' =&gt; $path,
        'locale'  =&gt; 'de'
    )
);

// Create a log instance
$writer = new Zend_Log_Writer_Stream('/path/to/file.log');
$log    = new Zend_Log($writer);

// Attach it to the translation instance
$translate-&gt;setOptions(
    array(
        'log'             =&gt; $log,
        'logMessage'      =&gt; "Missing '%message%' within locale '%locale%'",
        'logUntranslated' =&gt; true
    )
);

$translate-&gt;translate('unknown string');
</pre>
        </div>
</div>
<br class="example-break">

        <p>
            Additionally you are also able to change the priority which is used to write the message
            into the log. Per default the priority <span class="emphasis"><em>Zend_Log::NOTICE</em></span> is used.
            It equals with <span class="emphasis"><em>5</em></span>. When you want to change the priority you can use
            any of <code class="classname">Zend_Log</code>'s priorities. See the following example:
        </p>

        <div class="example">
<a name="zend.translate.additional.logging.example3"></a><p class="title"><b>Exemplo 928. Self defined log priority</b></p>
<div class="example-contents">
            

            <pre class="programlisting">
// Create a log instance
$writer = new Zend_Log_Writer_Stream('/path/to/file.log');
$log    = new Zend_Log($writer);

$translate = new Zend_Translate(
    array(
        'adapter' =&gt; 'gettext',
        'content' =&gt; $path,
        'locale'  =&gt; 'de',
        'log'             =&gt; $log,
        'logMessage'      =&gt; "Missing '%message%' within locale '%locale%'",
        'logPriority'     =&gt; Zend_Log::ALERT,
        'logUntranslated' =&gt; true
    )
);

$translate-&gt;translate('unknown string');
</pre>
        </div>
</div>
<br class="example-break">
    </div>

    <div class="sect2">
<div class="titlepage"><div><div><h3 class="title">
<a name="zend.translate.additional.sourcedata"></a>Accessing source data</h3></div></div></div>
        

        <p>
            Sometimes it is useful to have access to the translation source data. Therefor
            the following two functions are provided.
        </p>

        <p>
            The <code class="methodname">getMessageIds($locale = null)</code> method returns all known
            message IDs as array.
        </p>

        <p>
            When you want to know the message ID for a given translation then you can use the
            <code class="methodname">getMessageId()</code> method.
        </p>

        <p>
            The <code class="methodname">getMessages($locale = null)</code> method returns the complete
            translation source as an array. The message ID is used as key and the translation data
            as value.
        </p>

        <p>
            Both methods accept an optional parameter <code class="varname">$locale</code> which, if set,
            returns the translation data for the specified language. If this parameter is not given,
            the actual set language will be used. Keep in mind that normally all translations should
            be available in all languages. Which means that in a normal situation you will not have
            to set this parameter.
        </p>

        <p>
            Additionally the <code class="methodname">getMessages()</code> method can be used to return the
            complete translation dictionary using the pseudo-locale 'all'. This will return all
            available translation data for each added locale.
        </p>

        <div class="note"><table border="0" summary="Note">
<tr>
<td rowspan="2" align="center" valign="top" width="25"><img alt="[Nota]" src="images/note.png"></td>
<th align="left">Nota</th>
</tr>
<tr><td align="left" valign="top">
            <p>
                Attention: the returned array can be <span class="emphasis"><em>very big</em></span>,
                depending on the number of added locales and the amount of translation data.
            </p>
        </td></tr>
</table></div>

        <div class="example">
<a name="zend.translate.additional.sourcedata.example"></a><p class="title"><b>Exemplo 929. Handling languages with adapters</b></p>
<div class="example-contents">
            

            <pre class="programlisting">
// returns all known message IDs
$messageIds = $translate-&gt;getMessageIds();
print_r($messageIds);

// or just for the specified language
$messageIds = $translate-&gt;getMessageIds('en_US');
print_r($messageIds);

// returns all the complete translation data
$source = $translate-&gt;getMessages();
print_r($source);
</pre>
        </div>
</div>
<br class="example-break">
    </div>
</div>
<div class="navfooter"><table width="100%" summary="Navigation footer">
<tr>
<td width="40%" align="left">
<a accesskey="p" href="zend.translate.sourcecreation.html">Anterior</a> </td>
<td width="20%" align="center"><a accesskey="u" href="zend.translate.html">Acima</a></td>
<td width="40%" align="right"> <a accesskey="n" href="zend.translate.plurals.html">Próxima</a>
</td>
</tr>
<tr>
<td width="40%" align="left" valign="top">Creating source files </td>
<td width="20%" align="center"><a accesskey="h" href="index.html">Principal</a></td>
<td width="40%" align="right" valign="top"> Plural notations for Translation</td>
</tr>
</table></div>
<div class="revinfo"></div>
</body>
</html>
