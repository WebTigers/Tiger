<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Zend_Db_Adapter</title>
<link rel="stylesheet" type="text/css" href="dbstyle.css">
<meta name="generator" content="DocBook XSL Stylesheets V1.79.2">
<link rel="home" href="index.html" title="Programmer's Reference Guide">
<link rel="up" href="zend.db.html" title="Zend_Db">
<link rel="prev" href="zend.db.html" title="Zend_Db">
<link rel="next" href="zend.db.statement.html" title="Zend_Db_Statement">
</head>
<body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF">
<div class="navheader"><table width="100%" summary="Navigation header">
<tr><th colspan="3" align="center">Zend_Db_Adapter</th></tr>
<tr>
<td width="20%" align="left">
<a accesskey="p" href="zend.db.html">Prev</a> </td>
<th width="60%" align="center">Zend_Db</th>
<td width="20%" align="right"> <a accesskey="n" href="zend.db.statement.html">Next</a>
</td>
</tr>
</table></div>
<div class="sect1">
<div class="titlepage"><div><div><h2 class="title" style="clear: both">
<a name="zend.db.adapter"></a>Zend_Db_Adapter</h2></div></div></div>
    

    <p>
        <code class="classname">Zend_Db</code> and its related classes provide a simple
        <acronym class="acronym">SQL</acronym> database interface for Zend Framework. The
        <code class="classname">Zend_Db_Adapter</code> is the basic class you use to connect your
        <acronym class="acronym">PHP</acronym> application to an <acronym class="acronym">RDBMS</acronym>. There is a different
        Adapter class for each brand of <acronym class="acronym">RDBMS</acronym>.
    </p>

    <p>
        The <code class="classname">Zend_Db</code> adapters create a bridge from the vendor-specific
        <acronym class="acronym">PHP</acronym> extensions to a common interface to help you write
        <acronym class="acronym">PHP</acronym> applications once and deploy with multiple brands of
        <acronym class="acronym">RDBMS</acronym> with very little effort.
    </p>

    <p>
        The interface of the adapter class is similar to the interface of the
        <a class="ulink" href="http://www.php.net/pdo" target="_top">PHP Data Objects</a> extension.
        <code class="classname">Zend_Db</code> provides Adapter classes to <acronym class="acronym">PDO</acronym> drivers
        for the following <acronym class="acronym">RDBMS</acronym> brands:
    </p>

    <div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; ">
<li class="listitem">
            <p>
                <acronym class="acronym">IBM</acronym> <acronym class="acronym">DB2</acronym> and Informix Dynamic Server
                (<acronym class="acronym">IDS</acronym>), using the <a class="ulink" href="http://www.php.net/pdo-ibm" target="_top">pdo_ibm</a> <acronym class="acronym">PHP</acronym>
                extension
            </p>
        </li>
<li class="listitem">
            <p>
                MariaDB, using the <a class="ulink" href="http://www.php.net/pdo-mysql" target="_top">pdo_mysql</a>
                <acronym class="acronym">PHP</acronym> extension
            </p>
        </li>
<li class="listitem">
            <p>
                MySQL, using the <a class="ulink" href="http://www.php.net/pdo-mysql" target="_top">pdo_mysql</a>
                <acronym class="acronym">PHP</acronym> extension
            </p>
        </li>
<li class="listitem">
            <p>
                Microsoft <acronym class="acronym">SQL</acronym> Server, using the <a class="ulink" href="http://www.php.net/pdo-dblib" target="_top">pdo_dblib</a> <acronym class="acronym">PHP</acronym>
                extension
            </p>
        </li>
<li class="listitem">
            <p>
                Oracle, using the <a class="ulink" href="http://www.php.net/pdo-oci" target="_top">pdo_oci</a>
                <acronym class="acronym">PHP</acronym> extension
            </p>
        </li>
<li class="listitem">
            <p>
                PostgreSQL, using the <a class="ulink" href="http://www.php.net/pdo-pgsql" target="_top">pdo_pgsql</a>
                <acronym class="acronym">PHP</acronym> extension
            </p>
        </li>
<li class="listitem">
            <p>
                SQLite, using the <a class="ulink" href="http://www.php.net/pdo-sqlite" target="_top">pdo_sqlite</a>
                <acronym class="acronym">PHP</acronym> extension
            </p>
        </li>
</ul></div>

    <p>
        In addition, <code class="classname">Zend_Db</code> provides Adapter classes that utilize
        <acronym class="acronym">PHP</acronym> database extensions for the following <acronym class="acronym">RDBMS</acronym>
        brands:
    </p>

    <div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; ">
<li class="listitem">
            <p>
                MariaDB, using the <a class="ulink" href="http://www.php.net/mysqli" target="_top">mysqli</a>
                <acronym class="acronym">PHP</acronym> extension
            </p>
        </li>
<li class="listitem">
            <p>
                MySQL, using the <a class="ulink" href="http://www.php.net/mysqli" target="_top">mysqli</a>
                <acronym class="acronym">PHP</acronym> extension
            </p>
        </li>
<li class="listitem">
            <p>
                Oracle, using the <a class="ulink" href="http://www.php.net/oci8" target="_top">oci8</a>
                <acronym class="acronym">PHP</acronym> extension
            </p>
        </li>
<li class="listitem">
            <p>
                <acronym class="acronym">IBM</acronym> <acronym class="acronym">DB2</acronym> and <acronym class="acronym">DB2</acronym> I5, using
                the <a class="ulink" href="http://www.php.net/ibm_db2" target="_top">ibm_db2</a> <acronym class="acronym">PHP</acronym>
                extension
            </p>
        </li>
<li class="listitem">
            <p>
                Firebird (Interbase), using the <a class="ulink" href="http://www.php.net/ibase" target="_top">php_interbase</a> <acronym class="acronym">PHP</acronym>
                extension
            </p>
        </li>
</ul></div>

    <div class="note"><table border="0" summary="Note">
<tr>
<td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="/assets/manual/img/note.png"></td>
<th align="left">Note</th>
</tr>
<tr><td align="left" valign="top">
        <p>
            Each <code class="classname">Zend_Db</code> Adapter uses a <acronym class="acronym">PHP</acronym> extension. You
            must have the respective <acronym class="acronym">PHP</acronym> extension enabled in your
            <acronym class="acronym">PHP</acronym> environment to use a <code class="classname">Zend_Db</code> Adapter. For
            example, if you use any of the <acronym class="acronym">PDO</acronym> <code class="classname">Zend_Db</code>
            Adapters, you need to enable both the <acronym class="acronym">PDO</acronym> extension and the
            <acronym class="acronym">PDO</acronym> driver for the brand of <acronym class="acronym">RDBMS</acronym> you use.
        </p>
    </td></tr>
</table></div>

    <div class="sect2">
<div class="titlepage"><div><div><h3 class="title">
<a name="zend.db.adapter.connecting"></a>Connecting to a Database Using an Adapter</h3></div></div></div>
        

        <p>
            This section describes how to create an instance of a database Adapter.
            This corresponds to making a connection to your <acronym class="acronym">RDBMS</acronym> server from
            your <acronym class="acronym">PHP</acronym> application.
        </p>

        <div class="sect3">
<div class="titlepage"><div><div><h4 class="title">
<a name="zend.db.adapter.connecting.constructor"></a>Using a Zend_Db Adapter Constructor</h4></div></div></div>
            

            <p>
                You can create an instance of an adapter using its constructor.
                An adapter constructor takes one argument, which is an array
                of parameters used to declare the connection.
            </p>

            <div class="example">
<a name="zend.db.adapter.connecting.constructor.example"></a><p class="title"><b>Example 186. Using an Adapter Constructor</b></p>
<div class="example-contents">
                

                <pre class="programlisting">
$db = new Zend_Db_Adapter_Pdo_Mysql(array(
    'host'     =&gt; '127.0.0.1',
    'username' =&gt; 'webuser',
    'password' =&gt; 'xxxxxxxx',
    'dbname'   =&gt; 'test'
));
</pre>
            </div>
</div>
<br class="example-break">
        </div>

        <div class="sect3">
<div class="titlepage"><div><div><h4 class="title">
<a name="zend.db.adapter.connecting.factory"></a>Using the Zend_Db Factory</h4></div></div></div>
            

            <p>
                As an alternative to using an adapter constructor directly, you
                can create an instance of an adapter using the static method
                <code class="methodname">Zend_Db::factory()</code>. This method dynamically loads
                the adapter class file on demand using
                <a class="link" href="zend.loader.load.html#zend.loader.load.class" title="Loading Classes">Zend_Loader::loadClass()</a>.
            </p>

            <p>
                The first argument is a string that names the base name of the
                adapter class. For example the string '<code class="classname">Pdo_Mysql</code>' corresponds
                to the class <code class="classname">Zend_Db_Adapter_Pdo_Mysql</code>. The second argument
                is the same array of parameters you would have given to the
                adapter constructor.
            </p>

            <div class="example">
<a name="zend.db.adapter.connecting.factory.example"></a><p class="title"><b>Example 187. Using the Adapter Factory Method</b></p>
<div class="example-contents">
                

                <pre class="programlisting">
// We don't need the following statement because the
// Zend_Db_Adapter_Pdo_Mysql file will be loaded for us by the Zend_Db
// factory method.

// require_once 'Zend/Db/Adapter/Pdo/Mysql.php';

// Automatically load class Zend_Db_Adapter_Pdo_Mysql
// and create an instance of it.
$db = Zend_Db::factory('Pdo_Mysql', array(
    'host'     =&gt; '127.0.0.1',
    'username' =&gt; 'webuser',
    'password' =&gt; 'xxxxxxxx',
    'dbname'   =&gt; 'test'
));
</pre>
            </div>
</div>
<br class="example-break">

            <p>
                If you create your own class that extends
                <code class="classname">Zend_Db_Adapter_Abstract</code>, but you do not name your
                class with the "<code class="classname">Zend_Db_Adapter</code>" package prefix, you can use
                the <code class="methodname">factory()</code> method to load your adapter if you
                specify the leading portion of the adapter class with the
                'adapterNamespace' key in the parameters array.
            </p>

            <div class="example">
<a name="zend.db.adapter.connecting.factory.example2"></a><p class="title"><b>Example 188. Using the Adapter Factory Method for a Custom Adapter Class</b></p>
<div class="example-contents">
                

                <pre class="programlisting">
// We don't need to load the adapter class file
// because it will be loaded for us by the Zend_Db factory method.

// Automatically load class MyProject_Db_Adapter_Pdo_Mysql and create
// an instance of it.
$db = Zend_Db::factory('Pdo_Mysql', array(
    'host'             =&gt; '127.0.0.1',
    'username'         =&gt; 'webuser',
    'password'         =&gt; 'xxxxxxxx',
    'dbname'           =&gt; 'test',
    'adapterNamespace' =&gt; 'MyProject_Db_Adapter'
));
</pre>
            </div>
</div>
<br class="example-break">
        </div>

        <div class="sect3">
<div class="titlepage"><div><div><h4 class="title">
<a name="zend.db.adapter.connecting.factory-config"></a>Using Zend_Config with the Zend_Db Factory</h4></div></div></div>
            

            <p>
                Optionally, you may specify either argument of the
                <code class="methodname">factory()</code> method as an object of type
                <a class="link" href="zend.config.html" title="Zend_Config">Zend_Config</a>.
            </p>

            <p>
                If the first argument is a config object, it is expected to
                contain a property named <span class="property">adapter</span>, containing the
                string naming the adapter class name base. Optionally, the object
                may contain a property named <span class="property">params</span>, with
                subproperties corresponding to adapter parameter names.
                This is used only if the second argument of the
                <code class="methodname">factory()</code> method is absent.
            </p>

            <div class="example">
<a name="zend.db.adapter.connecting.factory.example1"></a><p class="title"><b>Example 189. Using the Adapter Factory Method with a Zend_Config Object</b></p>
<div class="example-contents">
                

                <p>
                    In the example below, a <code class="classname">Zend_Config</code> object is created
                    from an array. You can also load data from an external file using classes such
                    as <a class="link" href="zend.config.adapters.ini.html" title="Zend_Config_Ini">Zend_Config_Ini</a>
                    and <a class="link" href="zend.config.adapters.xml.html" title="Zend_Config_Xml">Zend_Config_Xml</a>.
                </p>

                <pre class="programlisting">
$config = new Zend_Config(
    array(
        'database' =&gt; array(
            'adapter' =&gt; 'Mysqli',
            'params'  =&gt; array(
                'host'     =&gt; '127.0.0.1',
                'dbname'   =&gt; 'test',
                'username' =&gt; 'webuser',
                'password' =&gt; 'secret',
            )
        )
    )
);

$db = Zend_Db::factory($config-&gt;database);
</pre>
            </div>
</div>
<br class="example-break">

            <p>
                The second argument of the <code class="methodname">factory()</code> method may be
                an associative array containing entries corresponding to
                adapter parameters. This argument is optional. If the first
                argument is of type <code class="classname">Zend_Config</code>, it is assumed to contain all
                parameters, and the second argument is ignored.
            </p>
        </div>

        <div class="sect3">
<div class="titlepage"><div><div><h4 class="title">
<a name="zend.db.adapter.connecting.parameters"></a>Adapter Parameters</h4></div></div></div>
            

            <p>
                The following list explains common parameters recognized by
                <code class="classname">Zend_Db</code> Adapter classes.
            </p>

            <div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; ">
<li class="listitem">
                    <p>
                        <span class="emphasis"><em>host</em></span>:
                        a string containing a hostname or IP address of the
                        database server. If the database is running on the
                        same host as the <acronym class="acronym">PHP</acronym> application, you may use
                        'localhost' or '127.0.0.1'.
                    </p>
                </li>
<li class="listitem">
                    <p>
                        <span class="emphasis"><em>username</em></span>:
                        account identifier for authenticating a connection to the
                        <acronym class="acronym">RDBMS</acronym> server.
                    </p>
                </li>
<li class="listitem">
                    <p>
                        <span class="emphasis"><em>password</em></span>:
                        account password credential for authenticating a
                        connection to the <acronym class="acronym">RDBMS</acronym> server.
                    </p>
                </li>
<li class="listitem">
                    <p>
                        <span class="emphasis"><em>dbname</em></span>:
                        database instance name on the <acronym class="acronym">RDBMS</acronym> server.
                    </p>
                </li>
<li class="listitem">
                    <p>
                        <span class="emphasis"><em>port</em></span>:
                        some <acronym class="acronym">RDBMS</acronym> servers can accept network connections on a
                        administrator-specified port number. The port
                        parameter allow you to specify the port to which your
                        <acronym class="acronym">PHP</acronym> application connects, to match the port configured
                        on the <acronym class="acronym">RDBMS</acronym> server.
                    </p>
                </li>
<li class="listitem">
                    <p>
                        <span class="emphasis"><em>charset</em></span>:
                        specify the charset used for the connection.
                    </p>
                </li>
<li class="listitem">
                    <p>
                        <span class="emphasis"><em>options</em></span>:
                        this parameter is an associative array of options
                        that are generic to all <code class="classname">Zend_Db_Adapter</code> classes.
                    </p>
                </li>
<li class="listitem">
                    <p>
                        <span class="emphasis"><em>driver_options</em></span>:
                        this parameter is an associative array of additional
                        options that are specific to a given database
                        extension. One typical use of this parameter is to
                        set attributes of a <acronym class="acronym">PDO</acronym> driver.
                    </p>
                </li>
<li class="listitem">
                    <p>
                        <span class="emphasis"><em>adapterNamespace</em></span>:
                        names the initial part of the class name for the
                        adapter, instead of '<code class="classname">Zend_Db_Adapter</code>'. Use this if
                        you need to use the <code class="methodname">factory()</code> method to
                        load a non-Zend database adapter class.
                    </p>
                </li>
<li class="listitem">
                    <p>
                        <span class="emphasis"><em>socket</em></span>:
                        allows you to specify the socket or named pipe to use.
                        Currently supported only by mysqli adapter.
                    </p>
                </li>
</ul></div>

            <div class="example">
<a name="zend.db.adapter.connecting.parameters.example1"></a><p class="title"><b>Example 190. Passing the Case-Folding Option to the Factory</b></p>
<div class="example-contents">
                

                <p>
                    You can specify this option by the constant
                    <code class="constant">Zend_Db::CASE_FOLDING</code>.
                    This corresponds to the <code class="constant">ATTR_CASE</code> attribute in
                    <acronym class="acronym">PDO</acronym> and <acronym class="acronym">IBM</acronym> <acronym class="acronym">DB2</acronym>
                    database drivers, adjusting the case of string keys in query result sets. The
                    option takes values <code class="constant">Zend_Db::CASE_NATURAL</code> (the default),
                    <code class="constant">Zend_Db::CASE_UPPER</code>, and
                    <code class="constant">Zend_Db::CASE_LOWER</code>.
                </p>

                <pre class="programlisting">
$options = array(
    Zend_Db::CASE_FOLDING =&gt; Zend_Db::CASE_UPPER
);

$params = array(
    'host'           =&gt; '127.0.0.1',
    'username'       =&gt; 'webuser',
    'password'       =&gt; 'xxxxxxxx',
    'dbname'         =&gt; 'test',
    'options'        =&gt; $options
);

$db = Zend_Db::factory('Db2', $params);
</pre>
            </div>
</div>
<br class="example-break">

            <div class="example">
<a name="zend.db.adapter.connecting.parameters.example2"></a><p class="title"><b>Example 191. Passing the Auto-Quoting Option to the Factory</b></p>
<div class="example-contents">
                

                <p>
                    You can specify this option by the constant
                    <code class="constant">Zend_Db::AUTO_QUOTE_IDENTIFIERS</code>. If the value
                    is <code class="constant">TRUE</code> (the default), identifiers like table
                    names, column names, and even aliases are delimited in all
                    <acronym class="acronym">SQL</acronym> syntax generated by the Adapter object. This makes it
                    simple to use identifiers that contain <acronym class="acronym">SQL</acronym> keywords, or
                    special characters. If the value is <code class="constant">FALSE</code>,
                    identifiers are not delimited automatically. If you need
                    to delimit identifiers, you must do so yourself using the
                    <code class="methodname">quoteIdentifier()</code> method.
                </p>

                <pre class="programlisting">
$options = array(
    Zend_Db::AUTO_QUOTE_IDENTIFIERS =&gt; false
);

$params = array(
    'host'           =&gt; '127.0.0.1',
    'username'       =&gt; 'webuser',
    'password'       =&gt; 'xxxxxxxx',
    'dbname'         =&gt; 'test',
    'options'        =&gt; $options
);

$db = Zend_Db::factory('Pdo_Mysql', $params);
</pre>
            </div>
</div>
<br class="example-break">

            <div class="example">
<a name="zend.db.adapter.connecting.parameters.example3"></a><p class="title"><b>Example 192. Passing PDO Driver Options to the Factory</b></p>
<div class="example-contents">
                

                <pre class="programlisting">
$pdoParams = array(
    PDO::MYSQL_ATTR_USE_BUFFERED_QUERY =&gt; true
);

$params = array(
    'host'           =&gt; '127.0.0.1',
    'username'       =&gt; 'webuser',
    'password'       =&gt; 'xxxxxxxx',
    'dbname'         =&gt; 'test',
    'driver_options' =&gt; $pdoParams
);

$db = Zend_Db::factory('Pdo_Mysql', $params);

echo $db-&gt;getConnection()
        -&gt;getAttribute(PDO::MYSQL_ATTR_USE_BUFFERED_QUERY);
</pre>
            </div>
</div>
<br class="example-break">

            <div class="example">
<a name="zend.db.adapter.connecting.parameters.example4"></a><p class="title"><b>Example 193. Passing Serialization Options to the Factory</b></p>
<div class="example-contents">
                

                <pre class="programlisting">
$options = array(
    Zend_Db::ALLOW_SERIALIZATION =&gt; false
);

$params = array(
    'host'           =&gt; '127.0.0.1',
    'username'       =&gt; 'webuser',
    'password'       =&gt; 'xxxxxxxx',
    'dbname'         =&gt; 'test',
    'options'        =&gt; $options
);

$db = Zend_Db::factory('Pdo_Mysql', $params);
</pre>
            </div>
</div>
<br class="example-break">
        </div>

        <div class="sect3">
<div class="titlepage"><div><div><h4 class="title">
<a name="zend.db.adapter.connecting.getconnection"></a>Managing Lazy Connections</h4></div></div></div>
            

            <p>
                Creating an instance of an Adapter class does not immediately
                connect to the <acronym class="acronym">RDBMS</acronym> server. The Adapter saves the connection
                parameters, and makes the actual connection on demand, the
                first time you need to execute a query. This ensures that
                creating an Adapter object is quick and inexpensive. You can
                create an instance of an Adapter even if you are not certain
                that you need to run any database queries during the current
                request your application is serving.
            </p>

            <p>
                If you need to force the Adapter to connect to the <acronym class="acronym">RDBMS</acronym>, use
                the <code class="methodname">getConnection()</code> method. This method returns
                an object for the connection as represented by the respective
                <acronym class="acronym">PHP</acronym> database extension. For example, if you use any of the
                Adapter classes for <acronym class="acronym">PDO</acronym> drivers, then
                <code class="methodname">getConnection()</code> returns the <acronym class="acronym">PDO</acronym> object,
                after initiating it as a live connection to the specific database.
            </p>

            <p>
                It can be useful to force the connection if you want to catch
                any exceptions it throws as a result of invalid account
                credentials, or other failure to connect to the <acronym class="acronym">RDBMS</acronym> server.
                These exceptions are not thrown until the connection is made,
                so it can help simplify your application code if you handle the
                exceptions in one place, instead of at the time of
                the first query against the database.
            </p>

            <p>
                Additionally, an adapter can get serialized to store it, for example,
                in a session variable. This can be very useful not only for the
                adapter itself, but for other objects that aggregate it, like a
                <code class="classname">Zend_Db_Select</code> object. By default, adapters are allowed
                to be serialized, if you don't want it, you should consider passing the
                <code class="constant">Zend_Db::ALLOW_SERIALIZATION</code> option with
                <code class="constant">FALSE</code>, see the example above. To respect lazy connections
                principle, the adapter won't reconnect itself after being unserialized. You must
                then call <code class="methodname">getConnection()</code> yourself. You can make the
                adapter auto-reconnect by passing the
                <code class="constant">Zend_Db::AUTO_RECONNECT_ON_UNSERIALIZE</code> with
                <code class="constant">TRUE</code> as an adapter option.
            </p>

            <div class="example">
<a name="zend.db.adapter.connecting.getconnection.example"></a><p class="title"><b>Example 194. Handling Connection Exceptions</b></p>
<div class="example-contents">
                

                <pre class="programlisting">
try {
    $db = Zend_Db::factory('Pdo_Mysql', $parameters);
    $db-&gt;getConnection();
} catch (Zend_Db_Adapter_Exception $e) {
    // perhaps a failed login credential, or perhaps the RDBMS is not running
} catch (Zend_Exception $e) {
    // perhaps factory() failed to load the specified Adapter class
}
</pre>
            </div>
</div>
<br class="example-break">
        </div>
    </div>

    <div class="sect2">
<div class="titlepage"><div><div><h3 class="title">
<a name="zend.db.adapter.example-database"></a>Example Database</h3></div></div></div>
        

        <p>
            In the documentation for <code class="classname">Zend_Db</code> classes, we use a set of simple
            tables to illustrate usage of the classes and methods. These
            example tables could store information for tracking bugs in a
            software development project. The database contains four tables:
        </p>

        <div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; ">
<li class="listitem">
                <p>
                    <span class="emphasis"><em>accounts</em></span> stores
                    information about each user of the bug-tracking database.
                </p>
            </li>
<li class="listitem">
                <p>
                    <span class="emphasis"><em>products</em></span> stores
                    information about each product for which a bug can be
                    logged.
                </p>
            </li>
<li class="listitem">
                <p>
                    <span class="emphasis"><em>bugs</em></span> stores information
                    about bugs, including that current state of the bug, the
                    person who reported the bug, the person who is assigned to
                    fix the bug, and the person who is assigned to verify the
                    fix.
                </p>
            </li>
<li class="listitem">
                <p>
                    <span class="emphasis"><em>bugs_products</em></span> stores a
                    relationship between bugs and products. This implements a
                    many-to-many relationship, because a given bug may be
                    relevant to multiple products, and of course a given
                    product can have multiple bugs.
                </p>
            </li>
</ul></div>

        <p>
            The following <acronym class="acronym">SQL</acronym> data definition language pseudocode describes the
            tables in this example database. These example tables are used
            extensively by the automated unit tests for <code class="classname">Zend_Db</code>.
        </p>

        <pre class="programlisting">
CREATE TABLE accounts (
  account_name      VARCHAR(100) NOT NULL PRIMARY KEY
);

CREATE TABLE products (
  product_id        INTEGER NOT NULL PRIMARY KEY,
  product_name      VARCHAR(100)
);

CREATE TABLE bugs (
  bug_id            INTEGER NOT NULL PRIMARY KEY,
  bug_description   VARCHAR(100),
  bug_status        VARCHAR(20),
  reported_by       VARCHAR(100) REFERENCES accounts(account_name),
  assigned_to       VARCHAR(100) REFERENCES accounts(account_name),
  verified_by       VARCHAR(100) REFERENCES accounts(account_name)
);

CREATE TABLE bugs_products (
  bug_id            INTEGER NOT NULL REFERENCES bugs,
  product_id        INTEGER NOT NULL REFERENCES products,
  PRIMARY KEY       (bug_id, product_id)
);
</pre>

        <p>
            Also notice that the 'bugs' table contains multiple
            foreign key references to the 'accounts' table.
            Each of these foreign keys may reference a different row in the
            'accounts' table for a given bug.
        </p>

        <p>
            The diagram below illustrates the physical data model of the
            example database.
        </p>

        <p>
            <img src="/assets/manual/en/figures/zend.db.adapter.example-database.png" align="middle">
        </p>
    </div>

    <div class="sect2">
<div class="titlepage"><div><div><h3 class="title">
<a name="zend.db.adapter.select"></a>Reading Query Results</h3></div></div></div>
        

        <p>
            This section describes methods of the Adapter class with which you
            can run <acronym class="acronym">SELECT</acronym> queries and retrieve the query results.
        </p>

        <div class="sect3">
<div class="titlepage"><div><div><h4 class="title">
<a name="zend.db.adapter.select.fetchall"></a>Fetching a Complete Result Set</h4></div></div></div>
            

            <p>
                You can run a <acronym class="acronym">SQL</acronym> <acronym class="acronym">SELECT</acronym> query and retrieve
                its results in one step using the <code class="methodname">fetchAll()</code> method.
            </p>

            <p>
                The first argument to this method is a string containing a
                <acronym class="acronym">SELECT</acronym> statement. Alternatively, the first argument can be an
                object of class <a class="link" href="zend.db.select.html" title="Zend_Db_Select">Zend_Db_Select</a>.
                The Adapter automatically converts this object to a string
                representation of the <acronym class="acronym">SELECT</acronym> statement.
            </p>

            <p>
                The second argument to <code class="methodname">fetchAll()</code> is an array of
                values to substitute for parameter placeholders in the <acronym class="acronym">SQL</acronym>
                statement.
            </p>

            <div class="example">
<a name="zend.db.adapter.select.fetchall.example"></a><p class="title"><b>Example 195. Using fetchAll()</b></p>
<div class="example-contents">
                

                <pre class="programlisting">
$sql = 'SELECT * FROM bugs WHERE bug_id = ?';

$result = $db-&gt;fetchAll($sql, 2);
</pre>
            </div>
</div>
<br class="example-break">
        </div>

        <div class="sect3">
<div class="titlepage"><div><div><h4 class="title">
<a name="zend.db.adapter.select.fetch-mode"></a>Changing the Fetch Mode</h4></div></div></div>
            

            <p>
                By default, <code class="methodname">fetchAll()</code> returns an array of
                rows, each of which is an associative array. The keys of the
                associative array are the columns or column aliases named in
                the select query.
            </p>

            <p>
                You can specify a different style of fetching results using the
                <code class="methodname">setFetchMode()</code> method. The modes supported are
                identified by constants:
            </p>

            <div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; ">
<li class="listitem">
                    <p>
                        <span class="emphasis"><em><code class="constant">Zend_Db::FETCH_ASSOC</code></em></span>:
                        return data in an array of associative arrays.
                        The array keys are column names, as strings. This is the default fetch mode
                        for <code class="classname">Zend_Db_Adapter</code> classes.
                    </p>

                    <p>
                        Note that if your select-list contains more than one
                        column with the same name, for example if they are from
                        two different tables in a <acronym class="acronym">JOIN</acronym>, there can be only one
                        entry in the associative array for a given name.
                        If you use the <code class="constant">FETCH_ASSOC</code> mode, you should specify
                        column aliases in your <acronym class="acronym">SELECT</acronym> query to ensure that the
                        names result in unique array keys.
                    </p>

                    <p>
                        By default, these strings are returned as they are
                        returned by the database driver. This is typically the
                        spelling of the column in the <acronym class="acronym">RDBMS</acronym> server. You can
                        specify the case for these strings, using the
                        <code class="constant">Zend_Db::CASE_FOLDING</code> option.
                        Specify this when instantiating the Adapter.
                        See <a class="link" href="zend.db.adapter.html#zend.db.adapter.connecting.parameters.example1" title="Example 190. Passing the Case-Folding Option to the Factory">this
                            example</a>
                    </p>
                </li>
<li class="listitem">
                    <p>
                        <span class="emphasis"><em><code class="constant">Zend_Db::FETCH_NUM</code></em></span>:
                        return data in an array of arrays. The arrays are
                        indexed by integers, corresponding to the position of
                        the respective field in the select-list of the query.
                    </p>
                </li>
<li class="listitem">
                    <p>
                        <span class="emphasis"><em><code class="constant">Zend_Db::FETCH_BOTH</code></em></span>:
                        return data in an array of arrays. The array keys are
                        both strings as used in the <code class="constant">FETCH_ASSOC</code> mode, and
                        integers as used in the <code class="constant">FETCH_NUM</code> mode. Note that the
                        number of elements in the array is double that which
                        would be in the array if you used either <code class="constant">FETCH_ASSOC</code>
                        or <code class="constant">FETCH_NUM</code>.
                    </p>
                </li>
<li class="listitem">
                    <p>
                        <span class="emphasis"><em><code class="constant">Zend_Db::FETCH_COLUMN</code></em></span>:
                        return data in an array of values. The value in each array
                        is the value returned by one column of the result set.
                        By default, this is the first column, indexed by 0.
                    </p>
                </li>
<li class="listitem">
                    <p>
                        <span class="emphasis"><em><code class="constant">Zend_Db::FETCH_OBJ</code></em></span>:
                        return data in an array of objects. The default class
                        is the <acronym class="acronym">PHP</acronym> built-in class stdClass. Columns of the
                        result set are available as public properties of the
                        object.
                    </p>
                </li>
</ul></div>

            <div class="example">
<a name="zend.db.adapter.select.fetch-mode.example"></a><p class="title"><b>Example 196. Using setFetchMode()</b></p>
<div class="example-contents">
                

                <pre class="programlisting">
$db-&gt;setFetchMode(Zend_Db::FETCH_OBJ);

$result = $db-&gt;fetchAll('SELECT * FROM bugs WHERE bug_id = ?', 2);

// $result is an array of objects
echo $result[0]-&gt;bug_description;
</pre>
            </div>
</div>
<br class="example-break">
        </div>

        <div class="sect3">
<div class="titlepage"><div><div><h4 class="title">
<a name="zend.db.adapter.select.fetchassoc"></a>Fetching a Result Set as an Associative Array</h4></div></div></div>
            

            <p>
                The <code class="methodname">fetchAssoc()</code> method returns data in an array
                of associative arrays, regardless of what value you have set
                for the fetch mode, using the first column as the array index.
            </p>

            <div class="example">
<a name="zend.db.adapter.select.fetchassoc.example"></a><p class="title"><b>Example 197. Using fetchAssoc()</b></p>
<div class="example-contents">
                

                <pre class="programlisting">
$db-&gt;setFetchMode(Zend_Db::FETCH_OBJ);

$result = $db-&gt;fetchAssoc(
    'SELECT bug_id, bug_description, bug_status FROM bugs'
);

// $result is an array of associative arrays, in spite of the fetch mode
echo $result[2]['bug_description']; // Description of Bug #2
echo $result[1]['bug_description']; // Description of Bug #1
</pre>
            </div>
</div>
<br class="example-break">
        </div>

        <div class="sect3">
<div class="titlepage"><div><div><h4 class="title">
<a name="zend.db.adapter.select.fetchcol"></a>Fetching a Single Column from a Result Set</h4></div></div></div>
            

            <p>
                The <code class="methodname">fetchCol()</code> method returns data in an array
                of values, regardless of the value you have set for the fetch mode.
                This only returns the first column returned by the query.
                Any other columns returned by the query are discarded.
                If you need to return a column other than the first, see
                <a class="link" href="zend.db.statement.html#zend.db.statement.fetching.fetchcolumn" title="Fetching a Single Column from a Result Set">this section</a>.
            </p>

            <div class="example">
<a name="zend.db.adapter.select.fetchcol.example"></a><p class="title"><b>Example 198. Using fetchCol()</b></p>
<div class="example-contents">
                

                <pre class="programlisting">
$db-&gt;setFetchMode(Zend_Db::FETCH_OBJ);

$result = $db-&gt;fetchCol(
    'SELECT bug_description, bug_id FROM bugs WHERE bug_id = ?', 2);

// contains bug_description; bug_id is not returned
echo $result[0];
</pre>
            </div>
</div>
<br class="example-break">
        </div>

        <div class="sect3">
<div class="titlepage"><div><div><h4 class="title">
<a name="zend.db.adapter.select.fetchpairs"></a>Fetching Key-Value Pairs from a Result Set</h4></div></div></div>
            

            <p>
                The <code class="methodname">fetchPairs()</code> method returns data in an array
                of key-value pairs, as an associative array with a single entry
                per row. The key of this associative array is taken from the
                first column returned by the <acronym class="acronym">SELECT</acronym> query. The value is taken
                from the second column returned by the <acronym class="acronym">SELECT</acronym> query. Any other
                columns returned by the query are discarded.
            </p>

            <p>
                You should design the <acronym class="acronym">SELECT</acronym> query so that the first column
                returned has unique values. If there are duplicates values in
                the first column, entries in the associative array will be
                overwritten.
            </p>

            <div class="example">
<a name="zend.db.adapter.select.fetchpairs.example"></a><p class="title"><b>Example 199. Using fetchPairs()</b></p>
<div class="example-contents">
                

                <pre class="programlisting">
$db-&gt;setFetchMode(Zend_Db::FETCH_OBJ);

$result = $db-&gt;fetchPairs('SELECT bug_id, bug_status FROM bugs');

echo $result[2];
</pre>
            </div>
</div>
<br class="example-break">
        </div>

        <div class="sect3">
<div class="titlepage"><div><div><h4 class="title">
<a name="zend.db.adapter.select.fetchrow"></a>Fetching a Single Row from a Result Set</h4></div></div></div>
            

            <p>
                The <code class="methodname">fetchRow()</code> method returns data using the
                current fetch mode, but it returns only the first row
                fetched from the result set.
            </p>

            <div class="example">
<a name="zend.db.adapter.select.fetchrow.example"></a><p class="title"><b>Example 200. Using fetchRow()</b></p>
<div class="example-contents">
                

                <pre class="programlisting">
$db-&gt;setFetchMode(Zend_Db::FETCH_OBJ);

$result = $db-&gt;fetchRow('SELECT * FROM bugs WHERE bug_id = 2');

// note that $result is a single object, not an array of objects
echo $result-&gt;bug_description;
</pre>
            </div>
</div>
<br class="example-break">
        </div>

        <div class="sect3">
<div class="titlepage"><div><div><h4 class="title">
<a name="zend.db.adapter.select.fetchone"></a>Fetching a Single Scalar from a Result Set</h4></div></div></div>
            

            <p>
                The <code class="methodname">fetchOne()</code> method is like a combination
                of <code class="methodname">fetchRow()</code> with <code class="methodname">fetchCol()</code>,
                in that it returns data only for the first row fetched from
                the result set, and it returns only the value of the first
                column in that row. Therefore it returns only a single
                scalar value, not an array or an object.
            </p>

            <div class="example">
<a name="zend.db.adapter.select.fetchone.example"></a><p class="title"><b>Example 201. Using fetchOne()</b></p>
<div class="example-contents">
                

                <pre class="programlisting">
$result = $db-&gt;fetchOne('SELECT bug_status FROM bugs WHERE bug_id = 2');

// this is a single string value
echo $result;
</pre>
            </div>
</div>
<br class="example-break">
        </div>
    </div>

    <div class="sect2">
<div class="titlepage"><div><div><h3 class="title">
<a name="zend.db.adapter.write"></a>Writing Changes to the Database</h3></div></div></div>
        

        <p>
            You can use the Adapter class to write new data or change existing
            data in your database. This section describes methods to do these
            operations.
        </p>

        <div class="sect3">
<div class="titlepage"><div><div><h4 class="title">
<a name="zend.db.adapter.write.insert"></a>Inserting Data</h4></div></div></div>
            

            <p>
                You can add new rows to a table in your database using the
                <code class="methodname">insert()</code> method. The first argument is a string
                that names the table, and the second argument is an associative
                array, mapping column names to data values.
            </p>

            <div class="example">
<a name="zend.db.adapter.write.insert.example"></a><p class="title"><b>Example 202. Inserting in a Table</b></p>
<div class="example-contents">
                

                <pre class="programlisting">
$data = array(
    'created_on'      =&gt; '2007-03-22',
    'bug_description' =&gt; 'Something wrong',
    'bug_status'      =&gt; 'NEW'
);

$db-&gt;insert('bugs', $data);
</pre>
            </div>
</div>
<br class="example-break">

            <p>
                Columns you exclude from the array of data are not specified to
                the database. Therefore, they follow the same rules that an
                <acronym class="acronym">SQL</acronym> <acronym class="acronym">INSERT</acronym> statement follows: if the column
                has a <acronym class="acronym">DEFAULT</acronym> clause, the column takes that value in the row
                created, otherwise the column is left in a <code class="constant">NULL</code> state.
            </p>

            <p>
                By default, the values in your data array are inserted using
                parameters. This reduces risk of some types of security
                issues. You don't need to apply escaping or quoting to values
                in the data array.
            </p>

            <p>
                You might need values in the data array to be treated as <acronym class="acronym">SQL</acronym>
                expressions, in which case they should not be quoted. By
                default, all data values passed as strings are treated as
                string literals. To specify that the value is an <acronym class="acronym">SQL</acronym>
                expression and therefore should not be quoted, pass the value
                in the data array as an object of type <code class="classname">Zend_Db_Expr</code> instead
                of a plain string.
            </p>

            <div class="example">
<a name="zend.db.adapter.write.insert.example2"></a><p class="title"><b>Example 203. Inserting Expressions in a Table</b></p>
<div class="example-contents">
                

                <pre class="programlisting">
$data = array(
    'created_on'      =&gt; new Zend_Db_Expr('CURDATE()'),
    'bug_description' =&gt; 'Something wrong',
    'bug_status'      =&gt; 'NEW'
);

$db-&gt;insert('bugs', $data);
</pre>
            </div>
</div>
<br class="example-break">
        </div>

        <div class="sect3">
<div class="titlepage"><div><div><h4 class="title">
<a name="zend.db.adapter.write.lastinsertid"></a>Retrieving a Generated Value</h4></div></div></div>
            

            <p>
                Some <acronym class="acronym">RDBMS</acronym> brands support auto-incrementing primary keys.
                A table defined this way generates a primary key value
                automatically during an <acronym class="acronym">INSERT</acronym> of a new row. The return value
                of the <code class="methodname">insert()</code> method is <span class="emphasis"><em>not</em></span>
                the last inserted ID, because the table might not have an
                auto-incremented column. Instead, the return value is the
                number of rows affected (usually 1).
            </p>

            <p>
                If your table is defined with an auto-incrementing primary key,
                you can call the <code class="methodname">lastInsertId()</code> method after the
                insert. This method returns the last value generated in the
                scope of the current database connection.
            </p>

            <div class="example">
<a name="zend.db.adapter.write.lastinsertid.example-1"></a><p class="title"><b>Example 204. Using lastInsertId() for an Auto-Increment Key</b></p>
<div class="example-contents">
                

                <pre class="programlisting">
$db-&gt;insert('bugs', $data);

// return the last value generated by an auto-increment column
$id = $db-&gt;lastInsertId();
</pre>
            </div>
</div>
<br class="example-break">

            <p>
                Some <acronym class="acronym">RDBMS</acronym> brands support a sequence object, which generates
                unique values to serve as primary key values. To support
                sequences, the <code class="methodname">lastInsertId()</code> method accepts two
                optional string arguments. These arguments name the table and
                the column, assuming you have followed the convention that a
                sequence is named using the table and column names for which
                the sequence generates values, and a suffix "_seq". This is
                based on the convention used by PostgreSQL when naming
                sequences for <code class="constant">SERIAL</code> columns. For example, a table "bugs" with
                primary key column "bug_id" would use a sequence named
                "bugs_bug_id_seq".
            </p>

            <div class="example">
<a name="zend.db.adapter.write.lastinsertid.example-2"></a><p class="title"><b>Example 205. Using lastInsertId() for a Sequence</b></p>
<div class="example-contents">
                

                <pre class="programlisting">
$db-&gt;insert('bugs', $data);

// return the last value generated by sequence 'bugs_bug_id_seq'.
$id = $db-&gt;lastInsertId('bugs', 'bug_id');

// alternatively, return the last value generated by sequence 'bugs_seq'.
$id = $db-&gt;lastInsertId('bugs');
</pre>
            </div>
</div>
<br class="example-break">

            <p>
                If the name of your sequence object does not follow this naming
                convention, use the <code class="methodname">lastSequenceId()</code> method
                instead. This method takes a single string argument, naming
                the sequence literally.
            </p>

            <div class="example">
<a name="zend.db.adapter.write.lastinsertid.example-3"></a><p class="title"><b>Example 206. Using lastSequenceId()</b></p>
<div class="example-contents">
                

                <pre class="programlisting">
$db-&gt;insert('bugs', $data);

// return the last value generated by sequence 'bugs_id_gen'.
$id = $db-&gt;lastSequenceId('bugs_id_gen');
</pre>
            </div>
</div>
<br class="example-break">

            <p>
                For <acronym class="acronym">RDBMS</acronym> brands that don't support sequences, including MariaDB,
        MySQL, Microsoft <acronym class="acronym">SQL</acronym> Server, and SQLite, the arguments to the
                <code class="methodname">lastInsertId()</code> method are ignored, and the value returned
                is the most recent value generated for any table by <acronym class="acronym">INSERT</acronym>
                operations during the current connection. For these <acronym class="acronym">RDBMS</acronym> brands,
                the <code class="methodname">lastSequenceId()</code> method always returns
                <code class="constant">NULL</code>.
            </p>

            <div class="note"><table border="0" summary='Note: Why Not Use "SELECT MAX(id) FROM table"?'>
<tr>
<td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="/assets/manual/img/note.png"></td>
<th align="left">Why Not Use "SELECT MAX(id) FROM table"?</th>
</tr>
<tr><td align="left" valign="top">
                

                <p>
                    Sometimes this query returns the most recent primary key
                    value inserted into the table. However, this technique
                    is not safe to use in an environment where multiple clients are
                    inserting records to the database. It is possible, and
                    therefore is bound to happen eventually, that another
                    client inserts another row in the instant between the
                    insert performed by your client application and your query
                    for the <code class="methodname">MAX(id)</code> value. Thus the value returned does
                    not identify the row you inserted, it identifies the row
                    inserted by some other client. There is no way to know
                    when this has happened.
                </p>

                <p>
                    Using a strong transaction isolation mode such as
                    "repeatable read" can mitigate this risk, but some <acronym class="acronym">RDBMS</acronym>
                    brands don't support the transaction isolation required for
                    this, or else your application may use a lower transaction
                    isolation mode by design.
                </p>

                <p>
                    Furthermore, using an expression like "<span class="command"><strong>MAX(id)+1</strong></span>" to generate
                    a new value for a primary key is not safe, because two clients
                    could do this query simultaneously, and then both use the same
                    calculated value for their next <acronym class="acronym">INSERT</acronym> operation.
                </p>

                <p>
                    All <acronym class="acronym">RDBMS</acronym> brands provide mechanisms to generate unique
                    values, and to return the last value generated. These
                    mechanisms necessarily work outside of the scope of
                    transaction isolation, so there is no chance of two clients
                    generating the same value, and there is no chance that the
                    value generated by another client could be reported to your
                    client's connection as the last value generated.
                </p>
            </td></tr>
</table></div>
        </div>

        <div class="sect3">
<div class="titlepage"><div><div><h4 class="title">
<a name="zend.db.adapter.write.update"></a>Updating Data</h4></div></div></div>
            

            <p>
                You can update rows in a database table using the
                <code class="methodname">update()</code> method of an Adapter. This method takes
                three arguments: the first is the name of the table; the
                second is an associative array mapping columns to change to new
                values to assign to these columns.
            </p>

            <p>
                The values in the data array are treated as string literals.
                See <a class="link" href="zend.db.adapter.html#zend.db.adapter.write.insert" title="Inserting Data">this section</a>
                for information on using <acronym class="acronym">SQL</acronym> expressions in the data array.
            </p>

            <p>
                The third argument is a string containing an <acronym class="acronym">SQL</acronym> expression
                that is used as criteria for the rows to change. The values
                and identifiers in this argument are not quoted or escaped.
                You are responsible for ensuring that any dynamic content is
                interpolated into this string safely.
                See <a class="link" href="zend.db.adapter.html#zend.db.adapter.quoting" title="Quoting Values and Identifiers">this section</a>
                for methods to help you do this.
            </p>

            <p>
                The return value is the number of rows affected by the update
                operation.
            </p>

            <div class="example">
<a name="zend.db.adapter.write.update.example"></a><p class="title"><b>Example 207. Updating Rows</b></p>
<div class="example-contents">
                

                <pre class="programlisting">
$data = array(
    'updated_on'      =&gt; '2007-03-23',
    'bug_status'      =&gt; 'FIXED'
);

$n = $db-&gt;update('bugs', $data, 'bug_id = 2');
</pre>
            </div>
</div>
<br class="example-break">

            <p>
                If you omit the third argument, then all rows in the database
                table are updated with the values specified in the data array.
            </p>

            <p>
                If you provide an array of strings as the third argument, these
                strings are joined together as terms in an expression separated
                by <code class="constant">AND</code> operators.
            </p>

            <p>
                If you provide an array of arrays as the third argument, the
                values will be automatically quoted into the keys. These
                will then be joined together as terms, separated by
                <code class="constant">AND</code> operators.
            </p>

            <div class="example">
<a name="zend.db.adapter.write.update.example-array"></a><p class="title"><b>Example 208. Updating Rows Using an Array of Expressions</b></p>
<div class="example-contents">
                

                <pre class="programlisting">
$data = array(
    'updated_on'      =&gt; '2007-03-23',
    'bug_status'      =&gt; 'FIXED'
);

$where[] = "reported_by = 'goofy'";
$where[] = "bug_status = 'OPEN'";

$n = $db-&gt;update('bugs', $data, $where);

// Resulting SQL is:
//  UPDATE "bugs" SET "update_on" = '2007-03-23', "bug_status" = 'FIXED'
//  WHERE ("reported_by" = 'goofy') AND ("bug_status" = 'OPEN')
</pre>
            </div>
</div>
<br class="example-break">

            <div class="example">
<a name="zend.db.adapter.write.update.example-arrayofarrays"></a><p class="title"><b>Example 209. Updating Rows Using an Array of Arrays</b></p>
<div class="example-contents">
                

                <pre class="programlisting">
$data = array(
    'updated_on'      =&gt; '2007-03-23',
    'bug_status'      =&gt; 'FIXED'
);

$where['reported_by = ?'] = 'goofy';
$where['bug_status = ?']  = 'OPEN';

$n = $db-&gt;update('bugs', $data, $where);

// Resulting SQL is:
//  UPDATE "bugs" SET "update_on" = '2007-03-23', "bug_status" = 'FIXED'
//  WHERE ("reported_by" = 'goofy') AND ("bug_status" = 'OPEN')
</pre>
            </div>
</div>
<br class="example-break">
        </div>

        <div class="sect3">
<div class="titlepage"><div><div><h4 class="title">
<a name="zend.db.adapter.write.delete"></a>Deleting Data</h4></div></div></div>
            

            <p>
                You can delete rows from a database table using the
                <code class="methodname">delete()</code> method. This method takes two arguments:
                the first is a string naming the table.
            </p>

            <p>
                The second argument is a string containing an <acronym class="acronym">SQL</acronym> expression
                that is used as criteria for the rows to delete. The values
                and identifiers in this argument are not quoted or escaped.
                You are responsible for ensuring that any dynamic content is
                interpolated into this string safely.
                See <a class="link" href="zend.db.adapter.html#zend.db.adapter.quoting" title="Quoting Values and Identifiers"> this section</a>
                for methods to help you do this.
            </p>

            <p>
                The return value is the number of rows affected by the delete
                operation.
            </p>

            <div class="example">
<a name="zend.db.adapter.write.delete.example"></a><p class="title"><b>Example 210. Deleting Rows</b></p>
<div class="example-contents">
                

                <pre class="programlisting">
$n = $db-&gt;delete('bugs', 'bug_id = 3');
</pre>
            </div>
</div>
<br class="example-break">

            <p>
                If you omit the second argument, the result is that all rows in
                the database table are deleted.
            </p>

            <p>
                If you provide an array of strings as the second argument, these
                strings are joined together as terms in an expression separated
                by <code class="constant">AND</code> operators.
            </p>

            <p>
                If you provide an array of arrays as the second argument, the
                values will be automatically quoted into the keys. These
                will then be joined together as terms, separated by
                <code class="constant">AND</code> operators.
            </p>
        </div>
    </div>

    <div class="sect2">
<div class="titlepage"><div><div><h3 class="title">
<a name="zend.db.adapter.quoting"></a>Quoting Values and Identifiers</h3></div></div></div>
        

        <p>
            When you form <acronym class="acronym">SQL</acronym> queries, often it is the case that you need to
            include the values of <acronym class="acronym">PHP</acronym> variables in <acronym class="acronym">SQL</acronym>
            expressions. This is risky, because if the value in a <acronym class="acronym">PHP</acronym> string
            contains certain symbols, such as the quote symbol, it could result in invalid
            <acronym class="acronym">SQL</acronym>. For example, notice the imbalanced quote characters in the
            following query:
        </p>

        <pre class="programlisting">
$name = "O'Reilly";
$sql = "SELECT * FROM bugs WHERE reported_by = '$name'";

echo $sql;
// SELECT * FROM bugs WHERE reported_by = 'O'Reilly'
</pre>

        <p>
            Even worse is the risk that such code mistakes might be exploited
            deliberately by a person who is trying to manipulate the function
            of your web application. If they can specify the value of a <acronym class="acronym">PHP</acronym>
            variable through the use of an <acronym class="acronym">HTTP</acronym> parameter or other mechanism,
            they might be able to make your <acronym class="acronym">SQL</acronym> queries do things that you
            didn't intend them to do, such as return data to which the person
            should not have privilege to read. This is a serious and widespread
            technique for violating application security, known as "SQL Injection" (see <a class="ulink" href="http://en.wikipedia.org/wiki/SQL_Injection" target="_top">http://en.wikipedia.org/wiki/SQL_Injection</a>).
        </p>

        <p>
            The <code class="classname">Zend_Db</code> Adapter class provides convenient functions to help
            you reduce vulnerabilities to <acronym class="acronym">SQL</acronym> Injection attacks in your
            <acronym class="acronym">PHP</acronym> code. The solution is to escape special characters such as quotes
            in <acronym class="acronym">PHP</acronym> values before they are interpolated into your
            <acronym class="acronym">SQL</acronym> strings. This protects against both accidental and deliberate
            manipulation of <acronym class="acronym">SQL</acronym> strings by <acronym class="acronym">PHP</acronym> variables that
            contain special characters.
        </p>

        <div class="sect3">
<div class="titlepage"><div><div><h4 class="title">
<a name="zend.db.adapter.quoting.quote"></a>Using quote()</h4></div></div></div>
            

            <p>
                The <code class="methodname">quote()</code> method accepts a single argument, a
                scalar string value. It returns the value with special
                characters escaped in a manner appropriate for the <acronym class="acronym">RDBMS</acronym> you
                are using, and surrounded by string value delimiters. The
                standard <acronym class="acronym">SQL</acronym> string value delimiter is the single-quote
                (').
            </p>

            <div class="example">
<a name="zend.db.adapter.quoting.quote.example"></a><p class="title"><b>Example 211. Using quote()</b></p>
<div class="example-contents">
                

                <pre class="programlisting">
$name = $db-&gt;quote("O'Reilly");
echo $name;
// 'O\'Reilly'

$sql = "SELECT * FROM bugs WHERE reported_by = $name";

echo $sql;
// SELECT * FROM bugs WHERE reported_by = 'O\'Reilly'
</pre>
            </div>
</div>
<br class="example-break">

            <p>
                Note that the return value of <code class="methodname">quote()</code> includes the
                quote delimiters around the string. This is different from
                some functions that escape special characters but do not add
                the quote delimiters, for example <a class="ulink" href="http://www.php.net/mysqli_real_escape_string" target="_top">mysql_real_escape_string()</a>.
            </p>

            <p>
                Values may need to be quoted or not quoted according to the <acronym class="acronym">SQL</acronym>
                datatype context in which they are used. For instance, in some
                <acronym class="acronym">RDBMS</acronym> brands, an integer value must not be quoted as a string
                if it is compared to an integer-type column or expression.
                In other words, the following is an error in some <acronym class="acronym">SQL</acronym>
                implementations, assuming <span class="property">intColumn</span> has a
                <acronym class="acronym">SQL</acronym> datatype of <code class="constant">INTEGER</code>
            </p>

            <pre class="programlisting">
SELECT * FROM atable WHERE intColumn = '123'
</pre>

            <p>
                You can use the optional second argument to the
                <code class="methodname">quote()</code> method to apply quoting selectively for
                the <acronym class="acronym">SQL</acronym> datatype you specify.
            </p>

            <div class="example">
<a name="zend.db.adapter.quoting.quote.example-2"></a><p class="title"><b>Example 212. Using quote() with a SQL Type</b></p>
<div class="example-contents">
                

                <pre class="programlisting">
$value = '1234';
$sql = 'SELECT * FROM atable WHERE intColumn = '
     . $db-&gt;quote($value, 'INTEGER');
</pre>
            </div>
</div>
<br class="example-break">

            <p>
                Each <code class="classname">Zend_Db_Adapter</code> class has encoded the names of numeric
                <acronym class="acronym">SQL</acronym> datatypes for the respective brand of
                <acronym class="acronym">RDBMS</acronym>. You can also use the constants
                <code class="constant">Zend_Db::INT_TYPE</code>, <code class="constant">Zend_Db::BIGINT_TYPE</code>,
                and <code class="constant">Zend_Db::FLOAT_TYPE</code> to write code in a more
                <acronym class="acronym">RDBMS</acronym>-independent way.
            </p>

            <p>
                <code class="classname">Zend_Db_Table</code> specifies <acronym class="acronym">SQL</acronym> types to
                <code class="methodname">quote()</code> automatically when generating
                <acronym class="acronym">SQL</acronym> queries that reference a table's key columns.
            </p>
        </div>

        <div class="sect3">
<div class="titlepage"><div><div><h4 class="title">
<a name="zend.db.adapter.quoting.quote-into"></a>Using quoteInto()</h4></div></div></div>
            

            <p>
                The most typical usage of quoting is to interpolate a <acronym class="acronym">PHP</acronym>
                variable into a <acronym class="acronym">SQL</acronym> expression or statement. You can use the
                <code class="methodname">quoteInto()</code> method to do this in one step. This
                method takes two arguments: the first argument is a string
                containing a placeholder symbol (?), and the
                second argument is a value or <acronym class="acronym">PHP</acronym> variable that should be
                substituted for that placeholder.
            </p>

            <p>
                The placeholder symbol is the same symbol used by many <acronym class="acronym">RDBMS</acronym>
                brands for positional parameters, but the
                <code class="methodname">quoteInto()</code> method only emulates query parameters.
                The method simply interpolates the value into the string,
                escapes special characters, and applies quotes around it.
                True query parameters maintain the separation between the <acronym class="acronym">SQL</acronym>
                string and the parameters as the statement is parsed in the
                <acronym class="acronym">RDBMS</acronym> server.
            </p>

            <div class="example">
<a name="zend.db.adapter.quoting.quote-into.example"></a><p class="title"><b>Example 213. Using quoteInto()</b></p>
<div class="example-contents">
                

                <pre class="programlisting">
$sql = $db-&gt;quoteInto("SELECT * FROM bugs WHERE reported_by = ?", "O'Reilly");

echo $sql;
// SELECT * FROM bugs WHERE reported_by = 'O\'Reilly'
</pre>
            </div>
</div>
<br class="example-break">

            <p>
                You can use the optional third parameter of
                <code class="methodname">quoteInto()</code> to specify the <acronym class="acronym">SQL</acronym> datatype.
                Numeric datatypes are not quoted, and other types are quoted.
            </p>

            <div class="example">
<a name="zend.db.adapter.quoting.quote-into.example-2"></a><p class="title"><b>Example 214. Using quoteInto() with a SQL Type</b></p>
<div class="example-contents">
                

                <pre class="programlisting">
$sql = $db
    -&gt;quoteInto("SELECT * FROM bugs WHERE bug_id = ?", '1234', 'INTEGER');

echo $sql;
// SELECT * FROM bugs WHERE reported_by = 1234
</pre>
            </div>
</div>
<br class="example-break">
        </div>

        <div class="sect3">
<div class="titlepage"><div><div><h4 class="title">
<a name="zend.db.adapter.quoting.quote-identifier"></a>Using quoteIdentifier()</h4></div></div></div>
            

            <p>
                Values are not the only part of <acronym class="acronym">SQL</acronym> syntax that might need to
                be variable. If you use <acronym class="acronym">PHP</acronym> variables to name tables, columns,
                or other identifiers in your <acronym class="acronym">SQL</acronym> statements, you might need to
                quote these strings too. By default, <acronym class="acronym">SQL</acronym> identifiers have
                syntax rules like <acronym class="acronym">PHP</acronym> and most other programming languages.
                For example, identifiers should not contain spaces, certain
                punctuation or special characters, or international characters.
                Also certain words are reserved for <acronym class="acronym">SQL</acronym> syntax, and should not
                be used as identifiers.
            </p>

            <p>
                However, <acronym class="acronym">SQL</acronym> has a feature called
                <span class="emphasis"><em>delimited identifiers</em></span>, which allows broader choices for the
                spelling of identifiers. If you enclose a <acronym class="acronym">SQL</acronym> identifier in the
                proper types of quotes, you can use identifiers with spellings that would be invalid
                without the quotes. Delimited identifiers can contain spaces,
                punctuation, or international characters. You can also use <acronym class="acronym">SQL</acronym>
                reserved words if you enclose them in identifier delimiters.
            </p>

            <p>
                The <code class="methodname">quoteIdentifier()</code> method works like
                <code class="methodname">quote()</code>, but it applies the identifier delimiter
                characters to the string according to the type of Adapter you
                use. For example, standard <acronym class="acronym">SQL</acronym> uses double-quotes
                (") for identifier delimiters, and most <acronym class="acronym">RDBMS</acronym>
                brands use that symbol. MySQL uses back-quotes (`) by default. The
                <code class="methodname">quoteIdentifier()</code> method also escapes special
                characters within the string argument.
            </p>

            <div class="example">
<a name="zend.db.adapter.quoting.quote-identifier.example"></a><p class="title"><b>Example 215. Using quoteIdentifier()</b></p>
<div class="example-contents">
                

                <pre class="programlisting">
// we might have a table name that is an SQL reserved word
$tableName = $db-&gt;quoteIdentifier("order");

$sql = "SELECT * FROM $tableName";

echo $sql
// SELECT * FROM "order"
</pre>
            </div>
</div>
<br class="example-break">

            <p>
                <acronym class="acronym">SQL</acronym> delimited identifiers are case-sensitive, unlike unquoted
                identifiers. Therefore, if you use delimited identifiers, you
                must use the spelling of the identifier exactly as it is stored
                in your schema, including the case of the letters.
            </p>

            <p>
                In most cases where <acronym class="acronym">SQL</acronym> is generated within
                <code class="classname">Zend_Db</code> classes, the default is that all identifiers are
                delimited automatically. You can change this behavior with the option
                <code class="constant">Zend_Db::AUTO_QUOTE_IDENTIFIERS</code>. Specify this
                when instantiating the Adapter.
                See <a class="link" href="zend.db.adapter.html#zend.db.adapter.connecting.parameters.example2" title="Example 191. Passing the Auto-Quoting Option to the Factory">this
                    example</a>.
            </p>
        </div>
    </div>

    <div class="sect2">
<div class="titlepage"><div><div><h3 class="title">
<a name="zend.db.adapter.transactions"></a>Controlling Database Transactions</h3></div></div></div>
        

        <p>
            Databases define transactions as logical units of work that can be
            committed or rolled back as a single change, even if they operate
            on multiple tables. All queries to a database are executed within
            the context of a transaction, even if the database driver manages
            them implicitly. This is called <span class="emphasis"><em>auto-commit</em></span>
            mode, in which the database driver creates a transaction for every
            statement you execute, and commits that transaction after your
            <acronym class="acronym">SQL</acronym> statement has been executed. By default, all
            <code class="classname">Zend_Db</code> Adapter classes operate in auto-commit mode.
        </p>

        <p>
            Alternatively, you can specify the beginning and resolution of a
            transaction, and thus control how many <acronym class="acronym">SQL</acronym> queries are included in
            a single group that is committed (or rolled back) as a single
            operation. Use the <code class="methodname">beginTransaction()</code> method to
            initiate a transaction. Subsequent <acronym class="acronym">SQL</acronym> statements are executed in
            the context of the same transaction until you resolve it
            explicitly.
        </p>

        <p>
            To resolve the transaction, use either the <code class="methodname">commit()</code> or
            <code class="methodname">rollBack()</code> methods. The <code class="methodname">commit()</code>
            method marks changes made during your transaction as committed, which
            means the effects of these changes are shown in queries run in
            other transactions.
        </p>

        <p>
            The <code class="methodname">rollBack()</code> method does the opposite: it discards
            the changes made during your transaction. The changes are
            effectively undone, and the state of the data returns to how it was
            before you began your transaction. However, rolling back your
            transaction has no effect on changes made by other transactions
            running concurrently.
        </p>

        <p>
            After you resolve this transaction, <code class="classname">Zend_Db_Adapter</code>
            returns to auto-commit mode until you call
            <code class="methodname">beginTransaction()</code> again.
        </p>

        <div class="example">
<a name="zend.db.adapter.transactions.example"></a><p class="title"><b>Example 216. Managing a Transaction to Ensure Consistency</b></p>
<div class="example-contents">
            

            <pre class="programlisting">
// Start a transaction explicitly.
$db-&gt;beginTransaction();

try {
    // Attempt to execute one or more queries:
    $db-&gt;query(...);
    $db-&gt;query(...);
    $db-&gt;query(...);

    // If all succeed, commit the transaction and all changes
    // are committed at once.
    $db-&gt;commit();

} catch (Exception $e) {
    // If any of the queries failed and threw an exception,
    // we want to roll back the whole transaction, reversing
    // changes made in the transaction, even those that succeeded.
    // Thus all changes are committed together, or none are.
    $db-&gt;rollBack();
    echo $e-&gt;getMessage();
}
</pre>
        </div>
</div>
<br class="example-break">
    </div>

    <div class="sect2">
<div class="titlepage"><div><div><h3 class="title">
<a name="zend.db.adapter.list-describe"></a>Listing and Describing Tables</h3></div></div></div>
        

        <p>
            The <code class="methodname">listTables()</code> method returns an array of strings,
            naming all tables in the current database.
        </p>

        <p>
            The <code class="methodname">describeTable()</code> method returns an associative
            array of metadata about a table. Specify the name of the table
            as a string in the first argument to this method. The second
            argument is optional, and names the schema in which the table
            exists.
        </p>

        <p>
            The keys of the associative array returned are the column names of
            the table. The value corresponding to each column is also an
            associative array, with the following keys and values:
        </p>

        <div class="table">
<a name="zend.db.adapter.list-describe.metadata"></a><p class="title"><b>Table 63. Metadata Fields Returned by describeTable()</b></p>
<div class="table-contents">
            

            <table class="table" summary="Metadata Fields Returned by describeTable()" border="1">
<colgroup>
<col>
<col>
<col>
</colgroup>
<thead><tr>
<th align="left">Key</th>
<th align="left">Type</th>
<th align="left">Description</th>
</tr></thead>
<tbody>
<tr>
<td align="left"><code class="constant">SCHEMA_NAME</code></td>
<td align="left">(string)</td>
<td align="left">Name of the database schema in which this table exists.</td>
</tr>
<tr>
<td align="left"><code class="constant">TABLE_NAME</code></td>
<td align="left">(string)</td>
<td align="left">Name of the table to which this column belongs.</td>
</tr>
<tr>
<td align="left"><code class="constant">COLUMN_NAME</code></td>
<td align="left">(string)</td>
<td align="left">Name of the column.</td>
</tr>
<tr>
<td align="left"><code class="constant">COLUMN_POSITION</code></td>
<td align="left">(integer)</td>
<td align="left">Ordinal position of the column in the table.</td>
</tr>
<tr>
<td align="left"><code class="constant">DATA_TYPE</code></td>
<td align="left">(string)</td>
<td align="left">
<acronym class="acronym">RDBMS</acronym> name of the datatype of the column.</td>
</tr>
<tr>
<td align="left"><code class="constant">DEFAULT</code></td>
<td align="left">(string)</td>
<td align="left">Default value for the column, if any.</td>
</tr>
<tr>
<td align="left"><code class="constant">NULLABLE</code></td>
<td align="left">(boolean)</td>
<td align="left">
                            <code class="constant">TRUE</code> if the column accepts <acronym class="acronym">SQL</acronym>
                            <code class="constant">NULL</code>'s, <code class="constant">FALSE</code> if the
                            column has a <code class="constant">NOT</code> <code class="constant">NULL</code>
                            constraint.
                        </td>
</tr>
<tr>
<td align="left"><code class="constant">LENGTH</code></td>
<td align="left">(integer)</td>
<td align="left">
                            Length or size of the column as reported by the
                            <acronym class="acronym">RDBMS</acronym>.
                        </td>
</tr>
<tr>
<td align="left"><code class="constant">SCALE</code></td>
<td align="left">(integer)</td>
<td align="left">
                            Scale of <acronym class="acronym">SQL</acronym> <code class="constant">NUMERIC</code> or
                            <code class="constant">DECIMAL</code> type.
                        </td>
</tr>
<tr>
<td align="left"><code class="constant">PRECISION</code></td>
<td align="left">(integer)</td>
<td align="left">
                            Precision of <acronym class="acronym">SQL</acronym> <code class="constant">NUMERIC</code> or
                            <code class="constant">DECIMAL</code> type.
                        </td>
</tr>
<tr>
<td align="left"><code class="constant">UNSIGNED</code></td>
<td align="left">(boolean)</td>
<td align="left">
                            <code class="constant">TRUE</code> if an integer-based type is reported as
                            <code class="constant">UNSIGNED</code>.
                        </td>
</tr>
<tr>
<td align="left"><code class="constant">PRIMARY</code></td>
<td align="left">(boolean)</td>
<td align="left">
                            <code class="constant">TRUE</code> if the column is part of the primary key of
                            this table.
                        </td>
</tr>
<tr>
<td align="left"><code class="constant">PRIMARY_POSITION</code></td>
<td align="left">(integer)</td>
<td align="left">Ordinal position (1-based) of the column in the primary key.</td>
</tr>
<tr>
<td align="left"><code class="constant">IDENTITY</code></td>
<td align="left">(boolean)</td>
<td align="left">
                            <code class="constant">TRUE</code> if the column uses an auto-generated value.
                        </td>
</tr>
</tbody>
</table>
        </div>
</div>
<br class="table-break">

        <div class="note"><table border="0" summary="Note: How the IDENTITY Metadata Field Relates to Specific RDBMSs">
<tr>
<td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="/assets/manual/img/note.png"></td>
<th align="left">How the IDENTITY Metadata Field Relates to Specific RDBMSs</th>
</tr>
<tr><td align="left" valign="top">
            

            <p>
                The <code class="constant">IDENTITY</code> metadata field was chosen as an 'idiomatic' term
                to represent a relation to surrogate keys. This field can be
                commonly known by the following values:-
            </p>

            <div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; ">
<li class="listitem">
                    <p>
                        <code class="constant">IDENTITY</code> - <acronym class="acronym">DB2</acronym>,
                        <acronym class="acronym">MSSQL</acronym>
                    </p>
                </li>
<li class="listitem">
                    <p>
                        <code class="constant">AUTO_INCREMENT</code> - MySQL/MariaDB
                    </p>
                </li>
<li class="listitem">
                    <p>
                        <code class="constant">SERIAL</code> - PostgreSQL
                    </p>
                </li>
<li class="listitem">
                    <p>
                        <code class="constant">SEQUENCE</code> - Oracle
                    </p>
                </li>
</ul></div>
        </td></tr>
</table></div>

        <p>
            If no table exists matching the table name and optional schema name
            specified, then <code class="methodname">describeTable()</code> returns an empty array.
        </p>
    </div>

    <div class="sect2">
<div class="titlepage"><div><div><h3 class="title">
<a name="zend.db.adapter.closing"></a>Closing a Connection</h3></div></div></div>
        

        <p>
            Normally it is not necessary to close a database connection. <acronym class="acronym">PHP</acronym>
            automatically cleans up all resources and the end of a request.
            Database extensions are designed to close the connection as the
            reference to the resource object is cleaned up.
        </p>

        <p>
            However, if you have a long-duration <acronym class="acronym">PHP</acronym> script that initiates many
            database connections, you might need to close the connection, to avoid
            exhausting the capacity of your <acronym class="acronym">RDBMS</acronym> server. You can use the
            Adapter's <code class="methodname">closeConnection()</code> method to explicitly close
            the underlying database connection.
        </p>

        <p>
            Since release 1.7.2, you could check you are currently connected to the
            <acronym class="acronym">RDBMS</acronym> server with the method <code class="methodname">isConnected()</code>.
            This means that a connection resource has been initiated and wasn't closed. This
            function is not currently able to test for example a server side closing of the
            connection. This is internally use to close the connection. It allow you to close the
            connection multiple times without errors. It was already the case before 1.7.2 for
            <acronym class="acronym">PDO</acronym> adapters but not for the others.
        </p>

        <div class="example">
<a name="zend.db.adapter.closing.example"></a><p class="title"><b>Example 217. Closing a Database Connection</b></p>
<div class="example-contents">
            

            <pre class="programlisting">
$db-&gt;closeConnection();
</pre>
        </div>
</div>
<br class="example-break">

        <div class="note"><table border="0" summary="Note: Does Zend_Db Support Persistent Connections?">
<tr>
<td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="/assets/manual/img/note.png"></td>
<th align="left">Does Zend_Db Support Persistent Connections?</th>
</tr>
<tr><td align="left" valign="top">
            

            <p>
                Yes, persistence is supported through the addition of
                the <span class="property">persistent</span> flag set to <code class="constant">TRUE</code> in the
                configuration (not driver_configuration) of an adapter
                in <code class="classname">Zend_Db</code>.
            </p>

            <div class="example">
<a name="zend.db.adapter.connecting.persistence.example"></a><p class="title"><b>Example 218. Using the Persitence Flag with the Oracle Adapter</b></p>
<div class="example-contents">
                

                <pre class="programlisting">
$db = Zend_Db::factory('Oracle', array(
    'host'       =&gt; '127.0.0.1',
    'username'   =&gt; 'webuser',
    'password'   =&gt; 'xxxxxxxx',
    'dbname'     =&gt; 'test',
    'persistent' =&gt; true
));
</pre>
            </div>
</div>
<br class="example-break">

            <p>
                Please note that using persistent connections can cause an
                excess of idle connections on the <acronym class="acronym">RDBMS</acronym> server, which causes
                more problems than any performance gain you might achieve by
                reducing the overhead of making connections.
            </p>

            <p>
                Database connections have state. That is, some objects in the
                <acronym class="acronym">RDBMS</acronym> server exist in session scope. Examples are locks, user
                variables, temporary tables, and information about the most
                recently executed query, such as rows affected, and last
                generated id value. If you use persistent connections, your
                application could access invalid or privileged data that were
                created in a previous <acronym class="acronym">PHP</acronym> request.
            </p>

            <p>
                Currently, only Oracle, <acronym class="acronym">DB2</acronym>, and the <acronym class="acronym">PDO</acronym>
                adapters (where specified by <acronym class="acronym">PHP</acronym>) support persistence in
                <code class="classname">Zend_Db</code>.
            </p>
        </td></tr>
</table></div>
    </div>

    <div class="sect2">
<div class="titlepage"><div><div><h3 class="title">
<a name="zend.db.adapter.other-statements"></a>Running Other Database Statements</h3></div></div></div>
        

        <p>
            There might be cases in which you need to access the connection
            object directly, as provided by the <acronym class="acronym">PHP</acronym> database extension. Some
            of these extensions may offer features that are not surfaced by
            methods of <code class="classname">Zend_Db_Adapter_Abstract</code>.
        </p>

        <p>
            For example, all <acronym class="acronym">SQL</acronym> statements run by <code class="classname">Zend_Db</code>
            are prepared, then executed. However, some database features are incompatible with
            prepared statements. <code class="constant">DDL</code> statements like
            <code class="constant">CREATE</code> and <code class="constant">ALTER</code> cannot be prepared in MySQL.
            Also, <acronym class="acronym">SQL</acronym> statements don't benefit from the <a class="ulink" href="http://dev.mysql.com/doc/refman/5.1/en/query-cache-how.html" target="_top">MySQL Query
                Cache</a>, prior to MySQL 5.1.17.
        </p>

        <p>
            Most <acronym class="acronym">PHP</acronym> database extensions provide a method to execute
            <acronym class="acronym">SQL</acronym> statements without preparing them. For example, in
            <acronym class="acronym">PDO</acronym>, this method is <code class="methodname">exec()</code>. You can access
            the connection object in the <acronym class="acronym">PHP</acronym> extension directly using
            <code class="methodname">getConnection()</code>.
        </p>

        <div class="example">
<a name="zend.db.adapter.other-statements.example"></a><p class="title"><b>Example 219. Running a Non-Prepared Statement in a PDO Adapter</b></p>
<div class="example-contents">
            

            <pre class="programlisting">
$result = $db-&gt;getConnection()-&gt;exec('DROP TABLE bugs');
</pre>
        </div>
</div>
<br class="example-break">

        <p>
            Similarly, you can access other methods or properties that are
            specific to <acronym class="acronym">PHP</acronym> database extensions. Be aware, though, that by
            doing this you might constrain your application to the interface
            provided by the extension for a specific brand of <acronym class="acronym">RDBMS</acronym>.
        </p>

        <p>
            In future versions of <code class="classname">Zend_Db</code>, there will be opportunities to
            add method entry points for functionality that is common to
            the supported <acronym class="acronym">PHP</acronym> database extensions. This will not affect
            backward compatibility.
        </p>
    </div>

    <div class="sect2">
<div class="titlepage"><div><div><h3 class="title">
<a name="zend.db.adapter.server-version"></a>Retrieving Server Version</h3></div></div></div>
        

        <p>
            Since release 1.7.2, you could retrieve the server version in <acronym class="acronym">PHP</acronym>
            syntax style to be able to use <code class="methodname">version_compare()</code>. If the
            information isn't available, you will receive <code class="constant">NULL</code>.
        </p>

        <div class="example">
<a name="zend.db.adapter.server-version.example"></a><p class="title"><b>Example 220. Verifying server version before running a query</b></p>
<div class="example-contents">
            

            <pre class="programlisting">
$version = $db-&gt;getServerVersion();
if (!is_null($version)) {
    if (version_compare($version, '5.0.0', '&gt;=')) {
        // do something
    } else {
        // do something else
    }
} else {
    // impossible to read server version
}
</pre>
        </div>
</div>
<br class="example-break">
    </div>

    <div class="sect2">
<div class="titlepage"><div><div><h3 class="title">
<a name="zend.db.adapter.adapter-notes"></a>Notes on Specific Adapters</h3></div></div></div>
        

        <p>
            This section lists differences between the Adapter classes of which
            you should be aware.
        </p>

        <div class="sect3">
<div class="titlepage"><div><div><h4 class="title">
<a name="zend.db.adapter.adapter-notes.ibm-db2"></a>IBM DB2</h4></div></div></div>
            

            <div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; ">
<li class="listitem">
                    <p>
                        Specify this Adapter to the <code class="methodname">factory()</code> method with
                        the name 'Db2'.
                    </p>
                </li>
<li class="listitem">
                    <p>
                        This Adapter uses the <acronym class="acronym">PHP</acronym> extension
                        <code class="constant">IBM_DB2</code>.
                    </p>
                </li>
<li class="listitem">
                    <p>
                        <acronym class="acronym">IBM</acronym> <acronym class="acronym">DB2</acronym> supports both sequences and
                        auto-incrementing keys. Therefore the arguments to
                        <code class="methodname">lastInsertId()</code> are optional. If you give
                        no arguments, the Adapter returns the last value
                        generated for an auto-increment key. If you give
                        arguments, the Adapter returns the last value generated
                        by the sequence named according to the convention
                        '<span class="emphasis"><em>table</em></span>_<span class="emphasis"><em>column</em></span>_seq'.
                    </p>
                </li>
</ul></div>
        </div>

        <div class="sect3">
<div class="titlepage"><div><div><h4 class="title">
<a name="zend.db.adapter.adapter-notes.mysqli"></a>MySQLi</h4></div></div></div>
            

            <div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; ">
<li class="listitem">
                    <p>
                        Specify this Adapter to the <code class="methodname">factory()</code>
                        method with the name 'Mysqli'.
                    </p>
                </li>
<li class="listitem">
                    <p>
                        This Adapter utilizes the <acronym class="acronym">PHP</acronym> extension mysqli.
                    </p>
                </li>
<li class="listitem">
                    <p>
                        MySQL and MariaDB do not support sequences, so
                        <code class="methodname">lastInsertId()</code> ignores its arguments and
                        always returns the last value generated for an
                        auto-increment key. The <code class="methodname">lastSequenceId()</code>
                        method returns <code class="constant">NULL</code>.
                    </p>
                </li>
</ul></div>
        </div>

        <div class="sect3">
<div class="titlepage"><div><div><h4 class="title">
<a name="zend.db.adapter.adapter-notes.oracle"></a>Oracle</h4></div></div></div>
            

            <div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; ">
<li class="listitem">
                    <p>
                        Specify this Adapter to the <code class="methodname">factory()</code>
                        method with the name 'Oracle'.
                    </p>
                </li>
<li class="listitem">
                    <p>
                        This Adapter uses the <acronym class="acronym">PHP</acronym> extension oci8.
                    </p>
                </li>
<li class="listitem">
                    <p>
                        Oracle does not support auto-incrementing keys, so you
                        should specify the name of a sequence to
                        <code class="methodname">lastInsertId()</code> or
                        <code class="methodname">lastSequenceId()</code>.
                    </p>
                </li>
<li class="listitem">
                    <p>
                        The Oracle extension does not support positional
                        parameters. You must use named parameters.
                    </p>
                </li>
<li class="listitem">
                    <p>
                        Currently the <code class="constant">Zend_Db::CASE_FOLDING</code> option
                        is not supported by the Oracle adapter. To use this
                        option with Oracle, you must use the <acronym class="acronym">PDO</acronym>
                        <acronym class="acronym">OCI</acronym> adapter.
                    </p>
                </li>
<li class="listitem">
                    <p>
                        By default, <acronym class="acronym">LOB</acronym> fields are returned as
                        <acronym class="acronym">OCI</acronym>-Lob objects. You could retrieve them as string for
                        all requests by using driver options '<span class="property">lob_as_string</span>' or
                        for particular request by using
                        <code class="methodname">setLobAsString(boolean)</code> on adapter or on statement.
                    </p>
                </li>
</ul></div>
        </div>

        <div class="sect3">
<div class="titlepage"><div><div><h4 class="title">
<a name="zend.db.adapter.adapter-notes.sqlsrv"></a>Microsoft SQL Server</h4></div></div></div>
            

            <div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; ">
<li class="listitem">
                    <p>
                        Specify this Adapter to the <code class="methodname">factory()</code> method with
                        the name 'Sqlsrv'.
                    </p>
                </li>
<li class="listitem">
                    <p>
                        This Adapter uses the <acronym class="acronym">PHP</acronym> extension sqlsrv
                    </p>
                </li>
<li class="listitem">
                    <p>
                        Only Microsoft <acronym class="acronym">SQL</acronym> Server 2005 or greater is supported.
                    </p>
                </li>
<li class="listitem">
                    <p>
                        Microsoft <acronym class="acronym">SQL</acronym> Server does not support sequences, so
                        <code class="methodname">lastInsertId()</code> ignores primary key argument and
                        returns the last value generated for an auto-increment key if a table name
                        is specified or a last insert query returned id. The
                        <code class="methodname">lastSequenceId()</code> method returns
                        <code class="constant">NULL</code>.
                    </p>
                </li>
<li class="listitem">
                    <p>
                        <code class="classname">Zend_Db_Adapter_Sqlsrv</code> sets
                        <code class="constant">QUOTED_IDENTIFIER</code> ON immediately
                        after connecting to a <acronym class="acronym">SQL</acronym> Server database. This makes the
                        driver use the standard <acronym class="acronym">SQL</acronym> identifier delimiter symbol
                        (<span class="emphasis"><em>"</em></span>) instead of the proprietary square-brackets
                        syntax <acronym class="acronym">SQL</acronym> Server uses for delimiting identifiers.
                    </p>
                </li>
<li class="listitem">
                    <p>
                        You can specify <span class="property">driver_options</span> as a key in the options
                        array. The value can be a anything from here <a class="ulink" href="http://msdn.microsoft.com/en-us/library/cc296161(SQL.90).aspx" target="_top">http://msdn.microsoft.com/en-us/library/cc296161(SQL.90).aspx</a>.
                    </p>
                </li>
<li class="listitem">
                    <p>
                        You can use <code class="methodname">setTransactionIsolationLevel()</code> to set
                        isolation level for current connection. The value can be
                        <code class="constant">SQLSRV_TXN_READ_UNCOMMITTED</code>,
                        <code class="constant">SQLSRV_TXN_READ_COMMITTED</code>,
                        <code class="constant">SQLSRV_TXN_REPEATABLE_READ</code>,
                        <code class="constant">SQLSRV_TXN_SNAPSHOT</code> or
                        <code class="constant">SQLSRV_TXN_SERIALIZABLE</code>.
                    </p>
                </li>
<li class="listitem">
                    <p>
                        As of Zend Framework 1.9, the minimal supported build of the
                        <acronym class="acronym">PHP</acronym> <acronym class="acronym">SQL</acronym> Server extension from
                        Microsoft is 1.0.1924.0. and the <acronym class="acronym">MSSQL</acronym> Server Native
                        Client version 9.00.3042.00.
                    </p>
                </li>
</ul></div>
        </div>

        <div class="sect3">
<div class="titlepage"><div><div><h4 class="title">
<a name="zend.db.adapter.adapter-notes.pdo-ibm"></a>PDO for IBM DB2 and Informix Dynamic Server (IDS)</h4></div></div></div>
            

            <div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; ">
<li class="listitem">
                    <p>
                        Specify this Adapter to the <code class="methodname">factory()</code>
                        method with the name '<code class="classname">Pdo_Ibm</code>'.
                    </p>
                </li>
<li class="listitem">
                    <p>
                        This Adapter uses the <acronym class="acronym">PHP</acronym> extensions
                        <acronym class="acronym">PDO</acronym> and <code class="constant">PDO_IBM</code>.
                    </p>
                </li>
<li class="listitem">
                    <p>
                        You must use at least <code class="constant">PDO_IBM</code> extension version 1.2.2.
                        If you have an earlier version of this extension, you
                        must upgrade the <code class="constant">PDO_IBM</code> extension from
                        <acronym class="acronym">PECL</acronym>.
                    </p>
                </li>
</ul></div>
        </div>

        <div class="sect3">
<div class="titlepage"><div><div><h4 class="title">
<a name="zend.db.adapter.adapter-notes.pdo-mssql"></a>PDO Microsoft SQL Server</h4></div></div></div>
            

            <div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; ">
<li class="listitem">
                    <p>
                        Specify this Adapter to the <code class="methodname">factory()</code>
                        method with the name '<code class="classname">Pdo_Mssql</code>'.
                    </p>
                </li>
<li class="listitem">
                    <p>
                        This Adapter uses the <acronym class="acronym">PHP</acronym> extensions pdo and pdo_dblib.
                    </p>
                </li>
<li class="listitem">
                    <p>
                        Microsoft <acronym class="acronym">SQL</acronym> Server does not support sequences, so
                        <code class="methodname">lastInsertId()</code> ignores its arguments and
                        always returns the last value generated for an
                        auto-increment key. The <code class="methodname">lastSequenceId()</code>
                        method returns <code class="constant">NULL</code>.
                    </p>
                </li>
<li class="listitem">
                    <p>
                        If you are working with unicode strings in an encoding other than
                        <acronym class="acronym">UCS</acronym>-2 (such as <acronym class="acronym">UTF</acronym>-8), you may have to
                        perform a conversion in your application code or store the data in a binary
                        column. Please refer to <a class="ulink" href="http://support.microsoft.com/kb/232580" target="_top">Microsoft's Knowledge
                            Base</a> for more information.
                    </p>
                </li>
<li class="listitem">
                    <p>
                        <code class="classname">Zend_Db_Adapter_Pdo_Mssql</code> sets
                        <code class="constant">QUOTED_IDENTIFIER</code> ON immediately
                        after connecting to a <acronym class="acronym">SQL</acronym> Server database. This makes the
                        driver use the standard <acronym class="acronym">SQL</acronym> identifier delimiter symbol
                        (") instead of the proprietary square-brackets syntax <acronym class="acronym">SQL</acronym>
                        Server uses for delimiting identifiers.
                    </p>
                </li>
<li class="listitem">
                    <p>
                        You can specify <span class="property">pdoType</span> as a key in the
                        options array. The value can be "mssql" (the default),
                        "dblib", "freetds", or "sybase". This option affects
                        the <acronym class="acronym">DSN</acronym> prefix the adapter uses when constructing the
                        <acronym class="acronym">DSN</acronym> string. Both "freetds" and "sybase" imply a prefix
                        of "sybase:", which is used for the
                        <a class="ulink" href="http://www.freetds.org/" target="_top">FreeTDS</a> set
                        of libraries.
                        See also
                        <a class="ulink" href="http://www.php.net/manual/en/ref.pdo-dblib.connection.php" target="_top">
                        http://www.php.net/manual/en/ref.pdo-dblib.connection.php</a>
                        for more information on the <acronym class="acronym">DSN</acronym> prefixes used in this
                        driver.
                    </p>
                </li>
</ul></div>
        </div>

        <div class="sect3">
<div class="titlepage"><div><div><h4 class="title">
<a name="zend.db.adapter.adapter-notes.pdo-mysql"></a>PDO MySQL</h4></div></div></div>
            

            <div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; ">
<li class="listitem">
                    <p>
                        Specify this Adapter to the <code class="methodname">factory()</code>
                        method with the name '<code class="classname">Pdo_Mysql</code>'.
                    </p>
                </li>
<li class="listitem">
                    <p>
                        This Adapter uses the <acronym class="acronym">PHP</acronym> extensions pdo and pdo_mysql.
                    </p>
                </li>
<li class="listitem">
                    <p>
                        MySQL and MariaDB do not support sequences, so
                        <code class="methodname">lastInsertId()</code> ignores its arguments and
                        always returns the last value generated for an
                        auto-increment key. The <code class="methodname">lastSequenceId()</code>
                        method returns <code class="constant">NULL</code>.
                    </p>
                </li>
</ul></div>
        </div>

        <div class="sect3">
<div class="titlepage"><div><div><h4 class="title">
<a name="zend.db.adapter.adapter-notes.pdo-oci"></a>PDO Oracle</h4></div></div></div>
            

            <div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; ">
<li class="listitem">
                    <p>
                        Specify this Adapter to the <code class="methodname">factory()</code>
                        method with the name '<code class="classname">Pdo_Oci</code>'.
                    </p>
                </li>
<li class="listitem">
                    <p>
                        This Adapter uses the <acronym class="acronym">PHP</acronym> extensions pdo and pdo_oci.
                    </p>
                </li>
<li class="listitem">
                    <p>
                        Oracle does not support auto-incrementing keys, so you
                        should specify the name of a sequence to
                        <code class="methodname">lastInsertId()</code> or
                        <code class="methodname">lastSequenceId()</code>.
                    </p>
                </li>
</ul></div>
        </div>

        <div class="sect3">
<div class="titlepage"><div><div><h4 class="title">
<a name="zend.db.adapter.adapter-notes.pdo-pgsql"></a>PDO PostgreSQL</h4></div></div></div>
            

            <div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; ">
<li class="listitem">
                    <p>
                        Specify this Adapter to the <code class="methodname">factory()</code>
                        method with the name '<code class="classname">Pdo_Pgsql</code>'.
                    </p>
                </li>
<li class="listitem">
                    <p>
                        This Adapter uses the <acronym class="acronym">PHP</acronym> extensions pdo and pdo_pgsql.
                    </p>
                </li>
<li class="listitem">
                    <p>
                        PostgreSQL supports both sequences and auto-incrementing
                        keys. Therefore the arguments to
                        <code class="methodname">lastInsertId()</code> are optional. If you give
                        no arguments, the Adapter returns the last value
                        generated for an auto-increment key. If you give
                        arguments, the Adapter returns the last value generated
                        by the sequence named according to the convention
                        '<span class="emphasis"><em>table</em></span>_<span class="emphasis"><em>column</em></span>_seq'.
                    </p>
                </li>
</ul></div>
        </div>

        <div class="sect3">
<div class="titlepage"><div><div><h4 class="title">
<a name="zend.db.adapter.adapter-notes.pdo-sqlite"></a>PDO SQLite</h4></div></div></div>
            

            <div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; ">
<li class="listitem">
                    <p>
                        Specify this Adapter to the <code class="methodname">factory()</code>
                        method with the name '<code class="classname">Pdo_Sqlite</code>'.
                    </p>
                </li>
<li class="listitem">
                    <p>
                        This Adapter uses the <acronym class="acronym">PHP</acronym> extensions pdo and pdo_sqlite.
                    </p>
                </li>
<li class="listitem">
                    <p>
                        SQLite does not support sequences, so
                        <code class="methodname">lastInsertId()</code> ignores its arguments and
                        always returns the last value generated for an
                        auto-increment key. The <code class="methodname">lastSequenceId()</code>
                        method returns <code class="constant">NULL</code>.
                    </p>
                </li>
<li class="listitem">
                    <p>
                        To connect to an SQLite2 database, specify
                        <span class="command"><strong>'sqlite2' =&gt; true</strong></span> in the array of
                        parameters when creating an instance of the
                        <code class="classname">Pdo_Sqlite</code> Adapter.
                    </p>
                </li>
<li class="listitem">
                    <p>
                        To connect to an in-memory SQLite database,
                        specify <span class="command"><strong>'dbname' =&gt; ':memory:'</strong></span> in the
                        array of parameters when creating an instance of
                        the <code class="classname">Pdo_Sqlite</code> Adapter.
                    </p>
                </li>
<li class="listitem">
                    <p>
                        Older versions of the SQLite driver for <acronym class="acronym">PHP</acronym> do not seem
                        to support the <acronym class="acronym">PRAGMA</acronym> commands necessary to ensure that
                        short column names are used in result sets. If you
                        have problems that your result sets are returned with
                        keys of the form "tablename.columnname" when you do a
                        join query, then you should upgrade to the current
                        version of <acronym class="acronym">PHP</acronym>.
                    </p>
                </li>
</ul></div>
        </div>

        <div class="sect3">
<div class="titlepage"><div><div><h4 class="title">
<a name="zend.db.adapter.adapter-notes.firebird"></a>Firebird (Interbase)</h4></div></div></div>
            

            <div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; ">
<li class="listitem">
                    <p>
                        This Adapter uses the <acronym class="acronym">PHP</acronym> extension php_interbase.
                    </p>
                </li>
<li class="listitem">
                    <p>
                        Firebird (Interbase) does not support auto-incrementing
                        keys, so you should specify the name of a sequence to
                        <code class="methodname">lastInsertId()</code> or
                        <code class="methodname">lastSequenceId()</code>.
                    </p>
                </li>
<li class="listitem">
                    <p>
                        Currently the <code class="constant">Zend_Db::CASE_FOLDING</code> option
                        is not supported by the Firebird (Interbase) adapter.
                        Unquoted identifiers are automatically returned in
                        upper case.
                    </p>
                </li>
<li class="listitem">
                    <p>Adapter name is <code class="classname">ZendX_Db_Adapter_Firebird</code>.</p>

                    <p>
                        Remember to use the param adapterNamespace with value
                        <code class="classname">ZendX_Db_Adapter</code>.
                    </p>

                    <p>
                        We recommend to update the <code class="filename">gds32.dll</code> (or linux
                        equivalent) bundled with <acronym class="acronym">PHP</acronym>, to the same version of the
                        server. For Firebird the equivalent <code class="filename">gds32.dll</code> is
                        <code class="filename">fbclient.dll</code>.
                    </p>

                    <p>
                        By default all identifiers (tables names, fields) are returned in upper
                        case.
                    </p>
                </li>
</ul></div>
        </div>
    </div>
</div>
<div class="navfooter"><table width="100%" summary="Navigation footer">
<tr>
<td width="40%" align="left">
<a accesskey="p" href="zend.db.html">Prev</a> </td>
<td width="20%" align="center"><a accesskey="u" href="zend.db.html">Up</a></td>
<td width="40%" align="right"> <a accesskey="n" href="zend.db.statement.html">Next</a>
</td>
</tr>
<tr>
<td width="40%" align="left" valign="top">Zend_Db </td>
<td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td>
<td width="40%" align="right" valign="top"> Zend_Db_Statement</td>
</tr>
</table></div>
<div class="revinfo"></div>
</body>
</html>
